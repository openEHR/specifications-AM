<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.21">
<meta name="description" content="openEHR Archetype Definition Language 2 (ADL2)">
<meta name="keywords" content="EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr">
<title>Archetype Definition Language 2 (ADL2)</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_archetype_definition_language_2_adl2">Archetype Definition Language 2 (ADL2)</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
<li><a href="#_supporters">Supporters</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_nomenclature">1.3. Nomenclature</a></li>
<li><a href="#_status">1.4. Status</a></li>
<li><a href="#_feedback">1.5. Feedback</a></li>
<li><a href="#_conformance">1.6. Conformance</a></li>
<li><a href="#_tools">1.7. Tools</a></li>
<li><a href="#_changes_from_previous_versions">1.8. Changes from Previous Versions</a>
<ul class="sectlevel3">
<li><a href="#_dadl_odin">1.8.1. dADL (ODIN)</a></li>
<li><a href="#_adl_2_4">1.8.2. ADL 2.4</a>
<ul class="sectlevel4">
<li><a href="#_changes">1.8.2.1. Changes</a></li>
<li><a href="#_backward_compatibility">1.8.2.2. Backward Compatibility</a></li>
</ul>
</li>
<li><a href="#_adl_2_0">1.8.3. ADL 2.0</a>
<ul class="sectlevel4">
<li><a href="#_changes_2">1.8.3.1. Changes</a></li>
<li><a href="#_backward_compatibility_2">1.8.3.2. Backward Compatibility</a></li>
</ul>
</li>
<li><a href="#_adl_1_5">1.8.4. ADL 1.5</a>
<ul class="sectlevel4">
<li><a href="#_changes_3">1.8.4.1. Changes</a></li>
</ul>
</li>
<li><a href="#_adl_1_4">1.8.5. ADL 1.4</a>
<ul class="sectlevel4">
<li><a href="#_iso_8601_datetime_conformance">1.8.5.1. ISO 8601 Date/Time Conformance</a></li>
<li><a href="#_non_inclusive_two_sided_intervals">1.8.5.2. Non-inclusive Two-sided Intervals</a></li>
<li><a href="#_occurrences_for_use_node_references">1.8.5.3. Occurrences for 'use_node' References</a></li>
<li><a href="#_quoting_rules">1.8.5.4. Quoting Rules</a></li>
</ul>
</li>
<li><a href="#_adl_1_3">1.8.6. ADL 1.3</a>
<ul class="sectlevel4">
<li><a href="#_query_syntax_replaced_by_uri_data_type">1.8.6.1. Query syntax replaced by URI data type</a></li>
<li><a href="#_top_level_invariant_section">1.8.6.2. Top-level Invariant Section</a></li>
</ul>
</li>
<li><a href="#_adl_1_2">1.8.7. ADL 1.2</a>
<ul class="sectlevel4">
<li><a href="#_adl_version">1.8.7.1. ADL Version</a></li>
<li><a href="#_dadl_odin_syntax_changes">1.8.7.2. dADL (ODIN) Syntax Changes</a></li>
<li><a href="#_revision_history_section">1.8.7.3. Revision History Section</a></li>
<li><a href="#_primary_language_and_languages_available_sections">1.8.7.4. Primary_language and Languages_available Sections</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_an_example">2.1. An Example</a></li>
</ul>
</li>
<li><a href="#_file_encoding_and_character_quoting">3. File Encoding and Character Quoting</a>
<ul class="sectlevel2">
<li><a href="#_file_encoding">3.1. File Encoding</a></li>
<li><a href="#_special_character_sequences">3.2. Special Character Sequences</a></li>
</ul>
</li>
<li><a href="#_cadl_constraint_adl">4. cADL - Constraint ADL</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
<li><a href="#_basics">4.2. Basics</a>
<ul class="sectlevel3">
<li><a href="#_keywords">4.2.1. Keywords</a></li>
<li><a href="#_block_node_structure">4.2.2. Block / Node Structure</a></li>
<li><a href="#_comments">4.2.3. Comments</a></li>
<li><a href="#_the_underlying_information_model">4.2.4. The Underlying Information Model</a>
<ul class="sectlevel4">
<li><a href="#_information_model_identifiers">4.2.4.1. Information Model Identifiers</a></li>
</ul>
</li>
<li><a href="#_node_identifiers">4.2.5. Node Identifiers</a></li>
<li><a href="#_the_matches_operator">4.2.6. The matches Operator</a></li>
<li><a href="#_natural_language">4.2.7. Natural Language</a></li>
</ul>
</li>
<li><a href="#_constraints_on_complex_types">4.3. Constraints on Complex types</a>
<ul class="sectlevel3">
<li><a href="#_attribute_constraints">4.3.1. Attribute Constraints</a>
<ul class="sectlevel4">
<li><a href="#_existence">4.3.1.1. Existence</a></li>
</ul>
</li>
<li><a href="#_single_valued_attributes">4.3.2. Single-valued Attributes</a></li>
<li><a href="#_container_attributes">4.3.3. Container Attributes</a>
<ul class="sectlevel4">
<li><a href="#_cardinality">4.3.3.1. Cardinality</a></li>
</ul>
</li>
<li><a href="#_object_constraints">4.3.4. Object Constraints</a>
<ul class="sectlevel4">
<li><a href="#_node_identifiers_2">4.3.4.1. Node Identifiers</a></li>
<li><a href="#_occurrences">4.3.4.2. Occurrences</a></li>
</ul>
</li>
<li><a href="#_any_constraints">4.3.5. "Any" Constraints</a></li>
<li><a href="#_reference_model_type_matching">4.3.6. Reference Model Type Matching</a>
<ul class="sectlevel4">
<li><a href="#_narrowed_subtype_constraints">4.3.6.1. Narrowed Subtype Constraints</a></li>
<li><a href="#_remove_specified_subtypes">4.3.6.2. Remove Specified Subtypes</a></li>
</ul>
</li>
<li><a href="#_paths">4.3.7. Paths</a>
<ul class="sectlevel4">
<li><a href="#_archetype_path_formation">4.3.7.1. Archetype Path Formation</a></li>
<li><a href="#_external_use_of_paths">4.3.7.2. External Use of Paths</a></li>
<li><a href="#_runtime_paths">4.3.7.3. Runtime Paths</a></li>
</ul>
</li>
<li><a href="#_internal_references_proxy_constraint_objects">4.3.8. Internal References (Proxy Constraint Objects)</a>
<ul class="sectlevel4">
<li><a href="#_paths_and_proxy_objects">4.3.8.1. Paths and Proxy Objects</a></li>
</ul>
</li>
<li><a href="#_external_references">4.3.9. External References</a>
<ul class="sectlevel4">
<li><a href="#_paths_2">4.3.9.1. Paths</a></li>
</ul>
</li>
<li><a href="#_archetype_slots">4.3.10. Archetype Slots</a>
<ul class="sectlevel4">
<li><a href="#_formal_semantics_of_include_and_exclude_constraints">4.3.10.1. Formal Semantics of include and exclude Constraints</a></li>
<li><a href="#_slots_based_on_lexical_archetype_identifiers">4.3.10.2. Slots based on Lexical Archetype Identifiers</a></li>
<li><a href="#_slots_based_on_other_constraints">4.3.10.3. Slots based on other Constraints</a></li>
<li><a href="#_slot_filling">4.3.10.4. Slot-filling</a></li>
</ul>
</li>
<li><a href="#_mixed_structures">4.3.11. Mixed Structures</a></li>
</ul>
</li>
<li><a href="#_second_order_constraints">4.4. Second-order Constraints</a>
<ul class="sectlevel3">
<li><a href="#_tuple_constraints">4.4.1. Tuple Constraints</a>
<ul class="sectlevel4">
<li><a href="#_paths_in_tuple_structures">4.4.1.1. Paths in Tuple structures</a></li>
</ul>
</li>
<li><a href="#_group_constraints">4.4.2. Group Constraints</a>
<ul class="sectlevel4">
<li><a href="#_slots_and_grouping">4.4.2.1. Slots and Grouping</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#cADL_Constraints_Primitive_Types">4.5. Constraints on Primitive Types</a>
<ul class="sectlevel3">
<li><a href="#_general_structure">4.5.1. General Structure</a></li>
<li><a href="#_assumed_values">4.5.2. Assumed Values</a></li>
<li><a href="#_constraints_on_boolean">4.5.3. Constraints on Boolean</a></li>
<li><a href="#_constraints_on_character">4.5.4. Constraints on Character</a>
<ul class="sectlevel4">
<li><a href="#_list_of_characters">4.5.4.1. List of Characters</a></li>
<li><a href="#_regular_expression">4.5.4.2. Regular Expression</a></li>
</ul>
</li>
<li><a href="#_constraints_on_string">4.5.5. Constraints on String</a>
<ul class="sectlevel4">
<li><a href="#_list_of_strings">4.5.5.1. List of Strings</a></li>
<li><a href="#_regular_expression_2">4.5.5.2. Regular Expression</a></li>
</ul>
</li>
<li><a href="#_constraints_on_ordered_types">4.5.6. Constraints on Ordered Types</a></li>
<li><a href="#_constraints_on_integer">4.5.7. Constraints on Integer</a>
<ul class="sectlevel4">
<li><a href="#_list_of_integers">4.5.7.1. List of Integers</a></li>
<li><a href="#_interval_of_integer">4.5.7.2. Interval of Integer</a></li>
<li><a href="#_more_complex_integer_constraints">4.5.7.3. More Complex Integer Constraints</a></li>
</ul>
</li>
<li><a href="#_constraints_on_real">4.5.8. Constraints on Real</a></li>
<li><a href="#_constraints_on_dates_times_and_durations">4.5.9. Constraints on Dates, Times and Durations</a>
<ul class="sectlevel4">
<li><a href="#_date_time_and_datetime">4.5.9.1. Date, Time and Date/Time</a></li>
<li><a href="#_duration_constraints">4.5.9.2. Duration Constraints</a></li>
</ul>
</li>
<li><a href="#cADL_Terminology_Constraints">4.5.10. Terminology Constraints</a>
<ul class="sectlevel4">
<li><a href="#_formal_terminology_constraint">4.5.10.1. Formal Terminology Constraint</a></li>
<li><a href="#_soft_terminology_constraint">4.5.10.2. Soft Terminology Constraint</a></li>
<li><a href="#_operational_binding_constraints">4.5.10.3. Operational Binding Constraints</a></li>
</ul>
</li>
<li><a href="#_constraints_on_lists_of_primitive_types">4.5.11. Constraints on Lists of Primitive Types</a></li>
<li><a href="#_constraints_on_intervals_of_ordered_primitive_types">4.5.12. Constraints on Intervals of Ordered Primitive Types</a></li>
<li><a href="#_constraints_on_enumerated_types">4.5.13. Constraints on Enumerated Types</a></li>
</ul>
</li>
<li><a href="#_syntax_validity_rules">4.6. Syntax Validity Rules</a></li>
</ul>
</li>
<li><a href="#_adl_paths">5. ADL Paths</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">5.1. Overview</a>
<ul class="sectlevel3">
<li><a href="#_relationship_with_w3c_xpath">5.1.1. Relationship with W3C Xpath</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_default_values">6. Default Values</a>
<ul class="sectlevel2">
<li><a href="#_syntax">6.1. Syntax</a></li>
<li><a href="#_examples">6.2. Examples</a></li>
</ul>
</li>
<li><a href="#_adl_archetype_definition_language">7. ADL - Archetype Definition Language</a>
<ul class="sectlevel2">
<li><a href="#_introduction">7.1. Introduction</a></li>
<li><a href="#_file_naming_convention">7.2. File-naming Convention</a></li>
<li><a href="#_artefact_content">7.3. Artefact Content</a></li>
<li><a href="#_basics_2">7.4. Basics</a>
<ul class="sectlevel3">
<li><a href="#_keywords_2">7.4.1. Keywords</a></li>
<li><a href="#_artefact_declaration">7.4.2. Artefact declaration</a></li>
<li><a href="#_node_identifier_codes">7.4.3. Node Identifier Codes</a></li>
<li><a href="#_local_term_codes">7.4.4. Local Term Codes</a></li>
<li><a href="#_local_value_set_codes">7.4.5. Local Value Set Codes</a></li>
</ul>
</li>
<li><a href="#_archetype_identification_section">7.5. Archetype Identification Section</a>
<ul class="sectlevel3">
<li><a href="#_adl_version_indicator">7.5.1. ADL Version Indicator</a></li>
<li><a href="#_rm_release_indicator">7.5.2. RM Release Indicator</a></li>
<li><a href="#_machine_identifiers">7.5.3. Machine Identifiers</a></li>
<li><a href="#_namespaces">7.5.4. Namespaces</a></li>
<li><a href="#_human_readable_archetype_identifier">7.5.5. Human Readable Archetype Identifier</a></li>
<li><a href="#_specialised_archetype_identification">7.5.6. Specialised Archetype Identification</a></li>
<li><a href="#_version_identifiers">7.5.7. Version Identifiers</a></li>
<li><a href="#_validity">7.5.8. Validity</a></li>
<li><a href="#_generated_indicator">7.5.9. Generated Indicator</a></li>
<li><a href="#_controlled_indicator">7.5.10. Controlled Indicator</a></li>
</ul>
</li>
<li><a href="#_specialise_section">7.6. Specialise Section</a></li>
<li><a href="#_language_section">7.7. Language Section</a></li>
<li><a href="#_description_section">7.8. Description Section</a></li>
<li><a href="#_deprecated_sections">7.9. Deprecated Sections</a>
<ul class="sectlevel3">
<li><a href="#_concept_section">7.9.1. Concept Section</a></li>
</ul>
</li>
<li><a href="#_definition_section">7.10. Definition Section</a>
<ul class="sectlevel3">
<li><a href="#_design_time_and_run_time_paths">7.10.1. Design-time and Run-time paths</a></li>
</ul>
</li>
<li><a href="#_rules_section">7.11. Rules Section</a>
<ul class="sectlevel3">
<li><a href="#_assertions">7.11.1. Assertions</a>
<ul class="sectlevel4">
<li><a href="#_arithmetic_identities">7.11.1.1. Arithmetic Identities</a></li>
<li><a href="#_mathematical_formulae">7.11.1.2. Mathematical Formulae</a></li>
<li><a href="#_value_dependent_existence">7.11.1.3. Value-dependent Existence</a></li>
</ul>
</li>
<li><a href="#_computational_statements">7.11.2. Computational Statements</a></li>
</ul>
</li>
<li><a href="#_rm_overlay_section">7.12. RM Overlay Section</a>
<ul class="sectlevel3">
<li><a href="#_rm_visibility">7.12.1. RM Visibility</a></li>
</ul>
</li>
<li><a href="#_terminology_section">7.13. Terminology Section</a>
<ul class="sectlevel3">
<li><a href="#_overview_4">7.13.1. Overview</a></li>
<li><a href="#_term_definitions_sub_section">7.13.2. Term_definitions Sub-section</a></li>
<li><a href="#_value_sets_sub_section">7.13.3. Value_sets Sub-section</a></li>
<li><a href="#_term_bindings_sub_section">7.13.4. Term_bindings Sub-section</a></li>
<li><a href="#_deprecated_terminology_section_features">7.13.5. Deprecated Terminology Section Features</a>
<ul class="sectlevel4">
<li><a href="#_at_codes_as_identifiers">7.13.5.1. At-codes as identifiers</a></li>
<li><a href="#_terminologies_available_sub_section">7.13.5.2. Terminologies_available sub-section</a></li>
<li><a href="#_separated_definitions_and_bindings_sub_sections">7.13.5.3. Separated definitions and bindings sub-sections</a></li>
<li><a href="#_term_definitions_structure">7.13.5.4. Term_definitions Structure</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_annotations_section">7.14. Annotations Section</a></li>
</ul>
</li>
<li><a href="#_terminology_integration">8. Terminology Integration</a>
<ul class="sectlevel2">
<li><a href="#_requirements">8.1. Requirements</a></li>
<li><a href="#_term_constraint_basics">8.2. Term Constraint Basics</a></li>
<li><a href="#_from_constraints_to_concrete_codes_in_data">8.3. From Constraints to Concrete Codes in Data</a></li>
</ul>
</li>
<li><a href="#_specialisation">9. Specialisation</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">9.1. Overview</a></li>
<li><a href="#_specialisation_concepts">9.2. Specialisation Concepts</a>
<ul class="sectlevel3">
<li><a href="#_differential_and_flat_forms">9.2.1. Differential and Flat Forms</a></li>
<li><a href="#_specialisation_levels">9.2.2. Specialisation Levels</a></li>
<li><a href="#_specialisation_paths">9.2.3. Specialisation Paths</a></li>
<li><a href="#_path_congruence">9.2.4. Path Congruence</a></li>
<li><a href="#_redefinition_concepts">9.2.5. Redefinition Concepts</a></li>
</ul>
</li>
<li><a href="#_examples_2">9.3. Examples</a>
<ul class="sectlevel3">
<li><a href="#_redefinition_for_refinement">9.3.1. Redefinition for Refinement</a></li>
<li><a href="#redefinition_for_specialisation">9.3.2. Redefinition for Specialisation</a>
<ul class="sectlevel4">
<li><a href="#_specialisation_with_cloning">9.3.2.1. Specialisation with Cloning</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_attribute_redefinition">9.4. Attribute Redefinition</a>
<ul class="sectlevel3">
<li><a href="#_existence_redefinition_mandation_and_exclusion">9.4.1. Existence Redefinition: Mandation and Exclusion</a></li>
<li><a href="#_multiply_valued_container_attributes">9.4.2. Multiply-valued (Container) Attributes</a>
<ul class="sectlevel4">
<li><a href="#_cardinality_2">9.4.2.1. Cardinality</a></li>
<li><a href="#_ordering_of_sibling_nodes">9.4.2.2. Ordering of Sibling Nodes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_object_redefinition">9.5. Object Redefinition</a>
<ul class="sectlevel3">
<li><a href="#_node_identifiers_3">9.5.1. Node Identifiers</a>
<ul class="sectlevel4">
<li><a href="#_adding_nodes">9.5.1.1. Adding Nodes</a></li>
</ul>
</li>
<li><a href="#_occurrences_redefinition">9.5.2. Occurrences Redefinition</a>
<ul class="sectlevel4">
<li><a href="#_mandation">9.5.2.1. Mandation</a></li>
<li><a href="#_exclusion">9.5.2.2. Exclusion</a></li>
</ul>
</li>
<li><a href="#_single_and_multiple_specialisation_when_does_cloning_occur">9.5.3. Single and Multiple Specialisation - When does Cloning Occur?</a></li>
<li><a href="#_exhaustive_and_non_exhaustive_redefinition">9.5.4. Exhaustive and Non-Exhaustive Redefinition</a></li>
<li><a href="#_reference_model_type_refinement">9.5.5. Reference Model Type Refinement</a></li>
<li><a href="#_internal_reference_proxy_object_redefinition">9.5.6. Internal Reference (Proxy Object) Redefinition</a></li>
<li><a href="#_external_reference_redefinition">9.5.7. External Reference Redefinition</a></li>
<li><a href="#_slot_filling_and_redefinition">9.5.8. Slot Filling and Redefinition</a></li>
<li><a href="#_unconstrained_attributes">9.5.9. Unconstrained Attributes</a></li>
</ul>
</li>
<li><a href="#_primitive_object_redefinition">9.6. Primitive Object Redefinition</a>
<ul class="sectlevel3">
<li><a href="#_numeric_primitive_redefinition">9.6.1. Numeric Primitive Redefinition</a></li>
<li><a href="#_terminology_constraint_redefinition">9.6.2. Terminology Constraint Redefinition</a>
<ul class="sectlevel4">
<li><a href="#_constrain_previously_unconstrained_node">9.6.2.1. Constrain Previously Unconstrained Node</a></li>
<li><a href="#_terminology_internal_value_set_redefinition">9.6.2.2. Terminology Internal Value Set Redefinition</a></li>
<li><a href="#_terminology_external_subset_redefinition">9.6.2.3. Terminology External Subset Redefinition</a></li>
<li><a href="#_constraint_strength_redefinition">9.6.2.4. Constraint Strength Redefinition</a></li>
</ul>
</li>
<li><a href="#_tuple_redefinition">9.6.3. Tuple Redefinition</a></li>
</ul>
</li>
<li><a href="#_rules">9.7. Rules</a></li>
<li><a href="#_languages">9.8. Languages</a></li>
<li><a href="#_description_section_2">9.9. Description Section</a></li>
<li><a href="#_terminology_section_2">9.10. Terminology Section</a></li>
<li><a href="#_bindings">9.11. Bindings</a></li>
</ul>
</li>
<li><a href="#_templates">10. Templates</a>
<ul class="sectlevel2">
<li><a href="#_overview_6">10.1. Overview</a></li>
<li><a href="#_example">10.2. Example</a></li>
</ul>
</li>
<li><a href="#_relationship_of_adl_to_other_formalisms">Appendix A: Relationship of ADL to Other Formalisms</a>
<ul class="sectlevel2">
<li><a href="#_overview_7">A.1. Overview</a></li>
<li><a href="#_constraint_syntaxes">A.2. Constraint Syntaxes</a>
<ul class="sectlevel3">
<li><a href="#_omg_ocl_object_constraint_language">A.2.1. OMG OCL (Object Constraint Language)</a></li>
</ul>
</li>
<li><a href="#_ontology_formalisms">A.3. Ontology Formalisms</a>
<ul class="sectlevel3">
<li><a href="#_owl_web_ontology_language">A.3.1. OWL (Web Ontology Language)</a></li>
<li><a href="#_kif_knowledge_interchange_format">A.3.2. KIF (Knowledge Interchange Format)</a></li>
</ul>
</li>
<li><a href="#_xml_based_formalisms">A.4. XML-based Formalisms</a>
<ul class="sectlevel3">
<li><a href="#_xml_schema">A.4.1. XML-schema</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_syntax_specification">Appendix B: Syntax Specification</a>
<ul class="sectlevel2">
<li><a href="#_adl_outer_syntax">B.1. ADL Outer Syntax</a></li>
<li><a href="#_cadl_syntax">B.2. cADL Syntax</a></li>
<li><a href="#_cadl_primitives_syntax">B.3. cADL Primitives Syntax</a></li>
<li><a href="#_rules_syntax">B.4. Rules Syntax</a></li>
<li><a href="#_value_types">B.5. Value types</a></li>
<li><a href="#_base_lexer">B.6. Base Lexer</a></li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_archetype_definition_language_2_adl2" class="sect0"><a class="anchor" href="#_archetype_definition_language_2_adl2"></a>Archetype Definition Language 2 (ADL2)</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: AM latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: STABLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2003 - 2024 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/AM/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.4.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>2.4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/???" target="_blank" rel="noopener">???</a>.  Add at-code codesystem in addition to id-code codesystem.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>14 Mar 2024</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.3.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-75" target="_blank" rel="noopener">SPECAM-75</a>. Improve specification of constraint patterns (addresses problem <a href="https://specifications.openehr.org/tickets/SPECPR-374" target="_blank" rel="noopener">SPECPR-374</a>). Modified <a href="#date_time_constraint_patterns">Section 4.5.9.1.1</a> to include timezone constraints.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 Dec 2022</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-76" target="_blank" rel="noopener">SPECAM-76</a>. Correct VSONCO rule for redefinition of nodes with multiple occurrences; improve text in <a href="#_redefinition_concepts">Section 9.2.5</a> and <a href="#_occurrences_redefinition">Section 9.5.2</a> (addresses problem <a href="https://specifications.openehr.org/tickets/SPECPR-374" target="_blank" rel="noopener">SPECPR-374</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos,<br>
S Garde,<br>
I McNicoll,<br>
P Pazos,<br>
J Holslag,<br>
T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">05 Aug 2022</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-74" target="_blank" rel="noopener">SPECAM-74</a>. Replace reference to VCOC with reference to VACMCU, VACMCO validity rules.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Aug 2021</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-69" target="_blank" rel="noopener">SPECAM-69</a>. Support negative durations (see also <a href="https://specifications.openehr.org/tickets/SPECRM-96" target="_blank" rel="noopener">SPECRM-96</a>); add examples in <a href="#_duration_constraints">Section 4.5.9.2</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos,<br>
 S Garde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-68" target="_blank" rel="noopener">SPECAM-68</a>. Add flexible <code><em>constraint_status</em></code> indicator to <code>C_TERMINOLOGY_CODE</code>; add related keywords to terminology constraints; see sections <a href="#_soft_terminology_constraint">Section 4.5.10.2</a> and <a href="#_terminology_constraint_redefinition">Section 9.6.2</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Fabjan,<br>
 I McNicoll,<br>
 S Garde,<br>
 P Bos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Sep 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-66" target="_blank" rel="noopener">SPECAM-66</a>: Improve specification of default values, including support for other syntaxes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 May 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECPUB-7" target="_blank" rel="noopener">SPECPUB-7</a>: Convert citations to bibtex form.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Dec 2019</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.2.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-63" target="_blank" rel="noopener">SPECAM-63</a>. Add <code>rm_overlay</code> top-level section with <code>rm_visibility</code> sub-section to state hide/show and RM attribute aliasing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I McNicoll,<br>
 S L Bakke,<br>
 B Fabjan,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 Apr 2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-61" target="_blank" rel="noopener">SPECAM-61</a>. Remove <code>revision_history</code> from ADL2 specification.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D Bosca,<br>
 P Bos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">04 Apr 2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-60" target="_blank" rel="noopener">SPECAM-60</a>. Improve documentation for constraints on lists and intervals.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Fabjan,<br>
 M Pipan,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21 Jan 2019</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-58" target="_blank" rel="noopener">SPECAM-58</a>. Correct errors and improve examples - S Garde review Nov 2018.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Garde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Nov 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update link for <code>ARCHETYPE_ID</code> syntax from ADL2 spec to link directly to BASE. (Fixes <a href="https://specifications.openehr.org/tickets/SPECPR-267" target="_blank" rel="noopener">SPECPR-267</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Garde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">03 Nov 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correct node identifier typos in section 9.5.1.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M Kramer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 Oct 2018</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.1.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-56" target="_blank" rel="noopener">SPECAM-56</a>. Correct ordering in flattening example in section 9.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 Aug 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-53" target="_blank" rel="noopener">SPECAM-53</a>. Remove statement requiring node-id redefinition in case of occurrences redefinition (corrects <a href="https://specifications.openehr.org/tickets/SPECPR-269" target="_blank" rel="noopener">SPECPR-269</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 May 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-50" target="_blank" rel="noopener">SPECAM-50</a>. Improve documentation of ADL2 templates (section 10).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 Jan 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-47" target="_blank" rel="noopener">SPECAM-47</a>. Allow regularly structured primitive objects.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">J Coyle,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Jan 2018</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-45" target="_blank" rel="noopener">SPECAM-45</a>. Correct specification details to do with <code><em>sibling_order</em></code> anchor node id. (Corrects <a href="https://specifications.openehr.org/tickets/SPECPR-245" target="_blank" rel="noopener">SPECPR-245</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21 Nov 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fix types in identifiers in redefinition example (section 9.5.5). (<a href="https://specifications.openehr.org/tickets/SPECPR-238" target="_blank" rel="noopener">SPECPR-238</a>);<br>
 Minor inconsistencies in ADL2 spec specialisation section (section 9.2.5, 9.3.1, 9.3.2)(<a href="https://specifications.openehr.org/tickets/SPECPR-239" target="_blank" rel="noopener">SPECPR-239</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">04 Oct 2017</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.0.6</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correct ambiguity between ADL and AOM specs concerning duration fractional seconds - add comment in 'Duration Constraints' section to cover fractional seconds. (<a href="https://specifications.openehr.org/tickets/SPECPR-188" target="_blank" rel="noopener">SPECPR-188</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Verhees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 Jun 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fix typos in ADL grammar: <code>meta_data_tag_is_controlled</code> value corrected to <code>'controlled'</code> and <code>meta_data_tag_is_generated</code> corrected to <code>'generated'</code>; adjust <code>meta_data_item</code> rule slightly for clarity.<br>
 Add reference in section `Reference Model Type Matching' to more precise specification of type matching in AOM2 spec.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C Nanjo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">08 Jun 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rename <code>archetype</code> rule in grammar to <code>authored_archetype</code> to match AOM2 class (<a href="https://specifications.openehr.org/tickets/SPECPR-190" target="_blank" rel="noopener">SPECPR-190</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Verhees</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 May 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change Rules section to document re-use of new openEHR Expression Language.<br>
 Re-order sub-sections under 9.5 to be more logical;<br>
 Add a new sub-section in the Specialisation section 'Single and Multiple Specialisation - When does Cloning Occur?';<br>
 Improve explanation of cloning.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 May 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Re-order Specialisation section subsections 10.2 and 10.3 (examples and concepts);<br>
 Correct <code>C_TEMPORAL.<em>pattern_constraint</em></code> to optional. (<a href="https://specifications.openehr.org/tickets/SPECPR-175" target="_blank" rel="noopener">SPECPR-175</a>);<br>
 Correct multiplicity on <code><em>constraint</em></code> to <code>0..*</code> except for <code>C_INTEGER</code> and <code>C_REAL</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21 Mar 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rewrite Terminology Integration section. Add template section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 Jan 2016</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upgrade specification to ADL 2.x level. Reduce overview text.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">openEHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12 Nov 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change <code>use_archetype</code> syntax to include id-code.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 P Langford</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 July 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Corrections on semantics of node id redefinition in Specialisation section; correct further typos.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Solbrig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25 June 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add support for constraints on enumeration types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 CIMI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 June 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Move terminology value set constraints to <code>terminology</code> section;<br>
 <a href="https://specifications.openehr.org/tickets/SPECAM-28" target="_blank" rel="noopener">SPECAM-28</a>. Add IHTSDO standard terminology URIs to ADL and AOM.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 H Solbrig</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 May 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">New format term codes &amp; mandatory node ids.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 Jan 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convert 'placeholder' (ac-code) constraint to primitive terminology type constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H Solbrig</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add archetype id namespacing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 I McNicoll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 Nov 2014</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add tuple construct.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 Aug 2013</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove dADL syntax description to new ODIN specification.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 Apr 2013</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-20" target="_blank" rel="noopener">SPECAM-20</a>: Allow <code>cardinality</code> keyword on its own to indicate container attributes, even if no other constraints required.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D Moner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">21 Mar 2012</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-8" target="_blank" rel="noopener">SPECAM-8</a>: Add specialisation semantics to ADL and AOM.<br>
 Improve explanation of node identifiers.<br>
 Correct typographical errors.<br>
 Make concept optional.<br>
 Refine slot include/exclude rules.<br>
 Review of text &amp; validity rules.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard<br>
 O Pishev<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deprecate <code>terminologies_available</code> statement in <code>terminology</code> section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add fractional seconds to dADL grammar.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Arikan</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-7" target="_blank" rel="noopener">SPECAM-7</a>. Make <code>existence</code>, <code>occurrences</code> and <code>cardinality</code> optional in AOM.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Garde<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-5" target="_blank" rel="noopener">SPECAM-5</a>. Archetype slot regular expressions should cover whole identifier. Added <code>C_STRING</code>.<em>is_pattern</em>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Flinton</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.2</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-268" target="_blank" rel="noopener">SPEC-268</a>: Correct missing parentheses in dADL type identifiers. dADL grammar and cADL scanner rules updated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R Chen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12 Dec 2008</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-284" target="_blank" rel="noopener">SPEC-284</a>: Correct inconsistencies in naming of <code>term_definitions</code>, <code>constraint_definitions</code>, <code>term_bindings</code>, <code>constraint_bindings</code> attributes in XML-schema and specifications.<br>
 Improved explanatory text for composite identifiers, including statement on case-sensitivity. Warning on <code>.v1draft</code> non-conformance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Torrisi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-260" target="_blank" rel="noopener">SPEC-260</a>: Correct the regex published for the ARCHETYPE_ID type. Update ADL grammar <code>ARCHEYTPE_ID</code> definition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Gummer,<br>
 J Arnett,<br>
 E Browne</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.1</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-203" target="_blank" rel="noopener">SPEC-203</a>: Release 1.0 explanatory text improvements. Improve Archetype slot explanation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13 Mar 2007</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-208" target="_blank" rel="noopener">SPEC-208</a>: Improve ADL grammar for assertion expressions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-160" target="_blank" rel="noopener">SPEC-160</a>: Duration constraints. Added ISO 8601 patterns for duration in cADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-213" target="_blank" rel="noopener">SPEC-213</a>: Correct ADL grammar for date/times to be properly ISO 8601-compliant. Include 'T' in cADL patterns and dADL and cADL Date/time, Time and Duration values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-216" target="_blank" rel="noopener">SPEC-216</a>: Allow mixture of W, D etc in ISO 8601 Duration (deviation from standard).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-200" target="_blank" rel="noopener">SPEC-200</a>: Correct Release 1.0 typographical errors.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Patterson<br>
 R Chen<br>
 S Garde<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-225" target="_blank" rel="noopener">SPEC-225</a>: Allow generic type names in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M Forss</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-226" target="_blank" rel="noopener">SPEC-226</a>: Rename <code>C_CODED_TEXT</code> to <code>C_CODE_PHRASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-233" target="_blank" rel="noopener">SPEC-233</a>: Define semantics for <code>occurrences</code> on <code>ARCHETYPE_INTERNAL_REF</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K Atalag</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-241" target="_blank" rel="noopener">SPEC-241</a>: Correct cADL grammar for archeype slot match expressions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-223" target="_blank" rel="noopener">SPEC-223</a>: Clarify quoting rules in ADL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Patterson</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-242" target="_blank" rel="noopener">SPEC-242</a>: Allow non-inclusive two-sided ranges in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-245" target="_blank" rel="noopener">SPEC-245</a>: Allow term bindings to paths in archetypes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-136" target="_blank" rel="noopener">SPEC-136</a>. Add validity rules to ADL document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Jan 2006</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-171" target="_blank" rel="noopener">SPEC-171</a>. Add validity check for cardinality &amp; occurrences</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Maldondo</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-141" target="_blank" rel="noopener">SPEC-141</a>. Allow point intervals in ADL. Updated atomic types part of cADL section and dADL grammar section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Jun 2005</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-142" target="_blank" rel="noopener">SPEC-142</a>. Update dADL grammar to support assumed values.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-143" target="_blank" rel="noopener">SPEC-143</a>. Add partial date/time values to dADL syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-149" target="_blank" rel="noopener">SPEC-149</a>. Add URIs to dADL and remove query() syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-153" target="_blank" rel="noopener">SPEC-153</a>. Synchronise ADL and AOM for language attributes<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-156" target="_blank" rel="noopener">SPEC-156</a>. Update documentation of container types.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-138" target="_blank" rel="noopener">SPEC-138</a>. Archetype-level assertions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 0.95</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-125" target="_blank" rel="noopener">SPEC-125</a>. <code>C_QUANTITY</code> example in ADL manual uses old dADL syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-115" target="_blank" rel="noopener">SPEC-115</a>. Correct "/[xxx]" path grammar error in ADL.<br>
 Create new section describing ADL path syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-127" target="_blank" rel="noopener">SPEC-127</a>. Restructure archetype specifications. Remove clinical constraint types section of document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 Feb 2005</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-110" target="_blank" rel="noopener">SPEC-110</a>. Update ADL document and create AOM document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Nov 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added explanatory material; added domain type support; rewrote of most dADL sections. Added section on assumed values, "controlled" flag, nested container structures. Change language handling.<br>
 Rewrote OWL section based on input from: University of Manchester, UK; University Seville, Spain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Rector<br>
 R Qamar<br>
 I Romn Martnez</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Various changes to assertions due to input from the DSTC.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Goodchild<br>
 Z Z Tun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed review from Clinical Information Project, Australia.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E Browne</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Remove UML models to "Archetype Object Model" document.</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed review from CHIME, UCL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Austin</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-103" target="_blank" rel="noopener">SPEC-103</a>. Redevelop archetype UML model, add new keywords: <code>allow_archetype</code>, <code>include</code>, <code>exclude</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-104" target="_blank" rel="noopener">SPEC-104</a>. Fix ordering bug when <code>use_node</code> used. Required parser rules for identifiers to make class and attribute identifiers distinct.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K Atalag</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added grammars for all parts of ADL, as well as new UML diagrams.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 0.9</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-79" target="_blank" rel="noopener">SPEC-79</a>. Change interval syntax in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 Jan 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-77" target="_blank" rel="noopener">SPEC-77</a>. Add cADL date/time pattern constraints.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-78" target="_blank" rel="noopener">SPEC-78</a>. Add predefined clinical types.
 Better explanation of cardinality, occurrences and existence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14 Jan 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-73" target="_blank" rel="noopener">SPEC-73</a>. Allow lists of Reals and Integers in cADL.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-75" target="_blank" rel="noopener">SPEC-75</a>. Add predefined clinical types library to ADL.<br>
 Added cADL and dADL object models.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 Dec 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-70" target="_blank" rel="noopener">SPEC-70</a>. Create Archetype System Description.
 Moved Archetype Identification Section to new Archetype System document.  Copyright Assgined by Ocean Informatics P/L Australia to The openEHR Foundation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">29 Nov 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added simple value list continuation (",&#8230;&#8203;"). Changed path syntax so that trailing '/' required for object paths.<br>
 Remove ranges with excluded limits.<br>
 Added terms and term lists to dADL leaf types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 Nov 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additions during HL7 WGM Memphis Sept 2003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added comparison to other formalisms. Renamed CDL to cADL and dDL to dADL. Changed path syntax to conform (nearly) to Xpath. Numerous small changes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">03 Sep 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rewritten with sections on cADL and dDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 July 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added basic type constraints, re-arranged sections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 July 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial Writing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 July 2003</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica, UK; openEHR International Board.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors"><a class="anchor" href="#_contributors"></a>Contributors</h3>
<div class="paragraph">
<p>This specification and its sibling Archetype Definition Language specification have benefited from formal and informal input from the openEHR and wider health informatics community. The openEHR Foundation would like to recognise the following people for their contributions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Seref Arikan, MEcon, Ocean Informatics UK, Centre for Health Informatics and Multi-professional Education (CHIME), UCL, UK</p>
</li>
<li>
<p>John Arnett, NHS Connecting for Health, UK</p>
</li>
<li>
<p>Koray Atalag PhD, University of Auckland, NZ</p>
</li>
<li>
<p>Tony Austin PhD, Centre for Health Informatics and Multi-professional Education (CHIME), UCL, UK</p>
</li>
<li>
<p>Silje Ljosland Bakke, RN, Nasjonal IKT HF, Norway</p>
</li>
<li>
<p>Pieter Bos, Software Engineer, Nedap, Netherlands</p>
</li>
<li>
<p>Eric Browne PhD, HealthBase Australia</p>
</li>
<li>
<p>Rong Chen MD, PhD, Cambio Heath Systems, Sweden</p>
</li>
<li>
<p>Joey Coyle MD, PhD, Intermountain Healthcare, New York</p>
</li>
<li>
<p>Borut Fabjan, Program Manager, Better d.o.o., Slovenia</p>
</li>
<li>
<p>Adam Flinton, NHS Connecting for Health, UK</p>
</li>
<li>
<p>Matias Forss MSc, Institute of Technology, Linkping University, Sweden</p>
</li>
<li>
<p>Sebastian Garde, PhD, Ocean Informatics, Germany</p>
</li>
<li>
<p>Andrew Goodchild PhD, Distributed Systems Technology Centre, Australia</p>
</li>
<li>
<p>Peter Gummer MSc, Ocean Informatics</p>
</li>
<li>
<p>Sam Heard MD, Ocean Informatics</p>
</li>
<li>
<p>Mark Kramer, Division Chief Engineer, Health Technology Center, The Mitre Corporation, USA</p>
</li>
<li>
<p>Patrick Langford, NeuronSong LLC</p>
</li>
<li>
<p>Jose Alberto Maldondo PhD, Universitat Politcnica de Valncia, Spain</p>
</li>
<li>
<p>David Moner PhD, Universitat Politcnica de Valncia, Spain</p>
</li>
<li>
<p>Isabel Romn Martnez PhD, Universitat de Sevilla, Spain</p>
</li>
<li>
<p>Ian McNicoll MD, MSc, Ocean Informatics UK</p>
</li>
<li>
<p>Claude Nanjo MA African Studies, M Public Health, Cognitive Medical Systems Inc., California</p>
</li>
<li>
<p>Andrew Patterson PhD, LLM, Federation Health Software, Australia</p>
</li>
<li>
<p>Ognian Pishev PhD, Australia, Ocean Informatics</p>
</li>
<li>
<p>Rahil Qamar Siddiqui PhD, NHS Health &amp; Social Care Information Centre, UK</p>
</li>
<li>
<p>Prof Alan Rector MD, PhD, University of Manchester, UK</p>
</li>
<li>
<p>Harold Solbrig MSc, Mayo Clinic, Rochester, USA</p>
</li>
<li>
<p>Alessandro Torrisi, Code24, Netherlands</p>
</li>
<li>
<p>Zar Zar Tun, Distributed Systems Technology Centre, Australia</p>
</li>
<li>
<p>Bert Verhees, ROSA Software, The Netherlands.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Thanks to Sebastian Garde, Central Qld University, Australia, for German translations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'Microsoft' and '.Net' are registered trademarks of the Microsoft Corporation.</p>
</li>
<li>
<p>'Java' is a registered trademark of Oracle Corporation</p>
</li>
<li>
<p>'Linux' is a registered trademark of Linus Torvalds.</p>
</li>
<li>
<p>'openEHR' is a registered trademark of The openEHR Foundation</p>
</li>
<li>
<p>'SNOMED CT' is a registered trademark of IHTSDO</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporters"><a class="anchor" href="#_supporters"></a>Supporters</h3>
<div class="paragraph">
<p>The work reported in this paper has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="https://www.openehr.org/community/industry_partners/" target="_blank" rel="noopener">openEHR Industry Partners</a>;</p>
</li>
<li>
<p>Ars Semantica, UK;</p>
</li>
<li>
<p>UCL (University College London) - Centre for Health Informatics and Multiprofessional Education (CHIME);</p>
</li>
<li>
<p>Ocean Informatics, Australia.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Special thanks to Prof David Ingram, founding Director of CHIME, UCL, who provided a vision and collegial working environment ever since the days of GEHR (1992).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the design basis and syntax of the Archetype Definition Language (ADL) 2.x, a new major version of ADL, containing structural changes with respect to the ADL 1.x versions.</p>
</div>
<div class="paragraph">
<p>It is intended for software developers, technically-oriented domain specialists and subject matter experts (SMEs). ADL is designed as an abstract human-readable and computer-processable syntax. ADL archetypes can be hand-edited using a normal text editor.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Research groups using openEHR, <a href="https://www.iso.org/standard/40784.html" target="_blank" rel="noopener">ISO 13606</a>, and other EHR or EHR exchange architectures;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>EHR solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/Overview.html" target="_blank" rel="noopener">openEHR Archetype Technical Overview</a>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html" target="_blank" rel="noopener">openEHR Archetype Object Model (AOM2)</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/OPT2.html" target="_blank" rel="noopener">openEHR Operational Template Specification</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_nomenclature"><a class="anchor" href="#_nomenclature"></a>1.3. Nomenclature</h3>
<div class="paragraph">
<p>In this document, the term 'attribute' denotes any stored property of a type defined in an object model, including primitive attributes and any kind of relationship such as an association or aggregation. XML 'attributes' are always referred to explicitly as 'XML attributes'.</p>
</div>
<div class="paragraph">
<p>We also use the word 'archetype' in a broad sense to designate what are commonly understood to be 'archetypes' (specifications of clinical data groups / data constraints) and 'templates' (data sets based on archetypes, since at a technical level, an ADL/AOM 2 template is in fact just an archetype. Accordingly, statements about 'archetypes' in this specification can be always understood to also apply to templates, unless otherwise indicated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.4. Status</h3>
<div class="paragraph">
<p>This specification is in the STABLE state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/AM/latest/ADL2.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/AM/latest/ADL2.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.5. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/adl" target="_blank" rel="noopener">openEHR ADL forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/AM/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/AM/history" target="_blank" rel="noopener">AM component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.6. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as an IDL interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tools"><a class="anchor" href="#_tools"></a>1.7. Tools</h3>
<div class="paragraph">
<p>Various tools exist for creating and processing archetypes. The <a href="https://www.openehr.org/downloads/ADLworkbench" target="_blank" rel="noopener">ADL Workbench</a> is a reference compiler, visualiser and editor. The openEHR ADL/AOM tools can be <a href="https://www.openehr.org/downloads/modellingtools" target="_blank" rel="noopener">downloaded from the website</a> .
Source projects can be found at the <a href="https://github.com/openEHR" target="_blank" rel="noopener">openEHR Github project</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_from_previous_versions"><a class="anchor" href="#_changes_from_previous_versions"></a>1.8. Changes from Previous Versions</h3>
<div class="paragraph">
<p>For existing users of ADL or archetype development tools, the following provides a guide to the changes in the syntax.</p>
</div>
<div class="sect3">
<h4 id="_dadl_odin"><a class="anchor" href="#_dadl_odin"></a>1.8.1. dADL (ODIN)</h4>
<div class="paragraph">
<p>The object syntax used to represent the description, terminology and annotations sections of an ADL archetype has been historically known as 'dADL' (i.e. 'data ADL'). Since this syntax is completely generic and has no specific dependency on either ADL or openEHR, it has been separated out into its own specification known as Object Data Instance Notation (ODIN).</p>
</div>
</div>
<div class="sect3">
<h4 id="_adl_2_4"><a class="anchor" href="#_adl_2_4"></a>1.8.2. ADL 2.4</h4>
<div class="sect4">
<h5 id="_changes"><a class="anchor" href="#_changes"></a>1.8.2.1. Changes</h5>
<div class="paragraph">
<p>The primary change in version 2.4 is introduction of alternative code systems.
ADL2 was initially released with code system using id-codes, at-codes and ac-codes.
As this proved to hinder its widespread use in the openEHR community (due to its impact on existing openEHR RM data) a code system matching the one used in ADL 1.4 was introduced (using just at-codes and ac-codes) as openEHR primary code system.
The new coding system also carries original ADL 2 id-codes in its archetypes as alternative codes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
ADL tools conformant to ADL/AOM 2.3 or earlier will not conform to the at-coded ADL2 archetypes described in ADL 2.4 without additional engineering.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_backward_compatibility"><a class="anchor" href="#_backward_compatibility"></a>1.8.2.2. Backward Compatibility</h5>
<div class="paragraph">
<p>When using at-code codesystem this release is fully backward compatible with openEHR data created based on ADL 1.4 archetypes but breaks compatibility with openEHR data created based on ADL 2.0 - ADL 2.3 archetypes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adl_2_0"><a class="anchor" href="#_adl_2_0"></a>1.8.3. ADL 2.0</h4>
<div class="sect4">
<h5 id="_changes_2"><a class="anchor" href="#_changes_2"></a>1.8.3.1. Changes</h5>
<div class="paragraph">
<p>The changes in version 2.0 are designed to make archetypes more computable with respect to terminology. The changes with respect to 1.x versions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the internal node identification system has been changed so that at-codes are no longer used to identify nodes; instead, 'id-codes' are used for that purpose;</p>
</li>
<li>
<p>all nodes now require an id-code;</p>
</li>
<li>
<p>rules for the construction of node identifier codes in specialised archetypes;</p>
</li>
<li>
<p>the <code>ontology</code> section has been renamed <code>terminology</code>;</p>
</li>
<li>
<p>value sets are now declared in their own subsection of the terminology section rather than inline in the definition section;</p>
</li>
<li>
<p>the <code>revision_history</code> section is removed, since the AOM2 uses the openEHR <a href="https://specifications.openehr.org/releases/BASE/latest/resource.html" target="_blank" rel="noopener">Base Types version of the Resource package</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_backward_compatibility_2"><a class="anchor" href="#_backward_compatibility_2"></a>1.8.3.2. Backward Compatibility</h5>
<div class="paragraph">
<p>In its current form, the changes to the internal coding system and value set representation in ADL 2.x and the AOM with respect to ADL/AOM 1.5 constitute syntactically breaking changes, and therefore require conversion of ADL 1.4 archetypes to ADL 2 form. The changes have been carefully designed to allow this conversion to be implementable, and are implemented in the ADL Workbench tool. ADL 1.4 style paths are generatable from ADL 2 archetypes, so that AQL queries can be built for use with ADL 1.4 based data.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adl_1_5"><a class="anchor" href="#_adl_1_5"></a>1.8.4. ADL 1.5</h4>
<div class="sect4">
<h5 id="_changes_3"><a class="anchor" href="#_changes_3"></a>1.8.4.1. Changes</h5>
<div class="paragraph">
<p>The changes in version 1.5 are made to better facilitate the representation of specialised archetypes. The key semantic capability for specialised archetypes is to be able to support a differential representation, i.e. to express a specialised archetype only in terms of the changed or new elements in its definition, rather than including a copy of unchanged elements. Doing the latter is clearly unsustainable in terms of change management. ADL 1.4 already supported differential representation, but somewhat inconveniently.</p>
</div>
<div class="paragraph">
<p>The changes for ADL 1.5 include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>optional <code>generated</code> marker in the archetype first line;</p>
</li>
<li>
<p>the semantics of reference model subtype matching are now described;</p>
</li>
<li>
<p>a differential expression form allows specialised archetypes to be expressed efficiently and ensures they are maintainable;</p>
</li>
<li>
<p>new keywords for defining the order of specialised object nodes within container attributes;</p>
</li>
<li>
<p>an explanation of how to use the negated match operator (<code>~matches</code>, or <code></code>) to define value set exclusions in specialised archetypes;</p>
</li>
<li>
<p>a description of the semantics of 'inheritance-flattened' archetypes;</p>
</li>
<li>
<p>optional <code>annotations</code> section added to archetypes;</p>
</li>
<li>
<p><code>declarations</code> and <code>invariants</code> sections merged into <code>rules</code> section;</p>
</li>
<li>
<p>In the ADL grammar, the language section is now mandatory;</p>
</li>
<li>
<p><code>.adls</code> files are introduced as the standard file extension for differential ADL files (<code>.adl</code> files are retained for standalone, inheritance-flattened, or 'flat', archetype).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nearly all the changes occur in <a href="#_cadl_constraint_adl">Section 4</a> or <a href="#_specialisation">Section 9</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adl_1_4"><a class="anchor" href="#_adl_1_4"></a>1.8.5. ADL 1.4</h4>
<div class="paragraph">
<p>A number of small changes were made in this version, along with significant tightening up of the explanatory text and examples.</p>
</div>
<div class="sect4">
<h5 id="_iso_8601_datetime_conformance"><a class="anchor" href="#_iso_8601_datetime_conformance"></a>1.8.5.1. ISO 8601 Date/Time Conformance</h5>
<div class="paragraph">
<p>All ISO 8601 date, time, date/time and duration values in dADL are now conformant (previously the usage of the 'T' separator was not correct). Constraint patterns in cADL for dates, times and date/times are also corrected, with a new constraint pattern for ISO 8601 durations being added. The latter allows a deviation from the standard to include the 'W' specifier, since durations with a mixture of weeks, days etc is often used in medicine.</p>
</div>
</div>
<div class="sect4">
<h5 id="_non_inclusive_two_sided_intervals"><a class="anchor" href="#_non_inclusive_two_sided_intervals"></a>1.8.5.2. Non-inclusive Two-sided Intervals</h5>
<div class="paragraph">
<p>It is now possible to define an interval of any ordered amount (integer, real, date, time, date/time, duration) where one or both of the limits is not included, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    |0..&lt;1000|    -- 0 &gt;= x &lt; 1000
    |&gt;0.5..4.0|   -- 0.5 &gt; x &lt;= 4.0
    |&gt;P2d..&lt;P10d| -- 2 days &gt; x &lt; 10 days</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_occurrences_for_use_node_references"><a class="anchor" href="#_occurrences_for_use_node_references"></a>1.8.5.3. Occurrences for 'use_node' References</h5>
<div class="paragraph">
<p>Occurrences can now be stated for <code>use_node</code> references, overriding the occurrences of the target node.  If no occurrences is stated, the target node occurrences value is used.</p>
</div>
</div>
<div class="sect4">
<h5 id="_quoting_rules"><a class="anchor" href="#_quoting_rules"></a>1.8.5.4. Quoting Rules</h5>
<div class="paragraph">
<p>The old quoting rules based on XML/ISO mnemonic patterns (<code>&ohmgr;</code> etc) are replaced by specifying ADL to be UTF-8 based, and any exceptions to this requiring ASCII encoding should use the <code>\Uhhhh</code> style of quoting unicode used in various programming languages.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adl_1_3"><a class="anchor" href="#_adl_1_3"></a>1.8.6. ADL 1.3</h4>
<div class="paragraph">
<p>The specific changes made in version 1.3 of ADL are as follows.</p>
</div>
<div class="sect4">
<h5 id="_query_syntax_replaced_by_uri_data_type"><a class="anchor" href="#_query_syntax_replaced_by_uri_data_type"></a>1.8.6.1. Query syntax replaced by URI data type</h5>
<div class="paragraph">
<p>In version 1.2 of ADL, it was possible to include an external query, using syntax of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    attr_name = &lt;query(&quot;some_service&quot;, &quot;some_query_string&quot;)&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is now replaced by the use of URIs, which can express queries, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    attr_name = &lt;http://some.service.org?some%20query%20etc&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>No assumption is made about the URI; it need not be in the form of a query - it may be any kind of URI.</p>
</div>
</div>
<div class="sect4">
<h5 id="_top_level_invariant_section"><a class="anchor" href="#_top_level_invariant_section"></a>1.8.6.2. Top-level Invariant Section</h5>
<div class="paragraph">
<p>In this version, invariants can only be defined in a top level block, in a way similar to object-oriented class definitions, rather than on every block in the definition section, as is the case in version 1.2 of ADL. This simplifies ADL and the Archetype Object Model, and makes an archetype more comprehensible as a <code>type</code> definition.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adl_1_2"><a class="anchor" href="#_adl_1_2"></a>1.8.7. ADL 1.2</h4>
<div class="sect4">
<h5 id="_adl_version"><a class="anchor" href="#_adl_version"></a>1.8.7.1. ADL Version</h5>
<div class="paragraph">
<p>The ADL version is now optionally (for the moment) included in the first line of the archetype, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    archetype (adl_version=1.2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is strongly recommended that all tool implementors include this information when archetypes are saved, enabling archetypes to gradually become imprinted with their correct version, for more reliable later processing. The adl_version indicator is likely to become mandatory in future versions of ADL.</p>
</div>
</div>
<div class="sect4">
<h5 id="_dadl_odin_syntax_changes"><a class="anchor" href="#_dadl_odin_syntax_changes"></a>1.8.7.2. dADL (ODIN) Syntax Changes</h5>
<div class="paragraph">
<p>The dADL (now ODIN) syntax for container attributes has been altered to allow paths and typing to be expressed more clearly, as part of enabling the use of Xpath-style paths. ADL 1.1 dADL had the following appearance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = &lt;
		locations(1) = &lt;...&gt;
		locations(2) = &lt;...&gt;
		locations(3) = &lt;...&gt;
		subjects(&quot;philosophy:plato&quot;) = &lt;...&gt;
		subjects(&quot;philosophy:kant&quot;) = &lt;...&gt;
		subjects(&quot;art&quot;) = &lt;...&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This has been changed to look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = &lt;
		locations = &lt;
			[1] = &lt;...&gt;
			[2] = &lt;...&gt;
			[3] = &lt;...&gt;
		&gt;
		subjects = &lt;
			[&quot;philosophy:plato&quot;] = &lt;...&gt;
			[&quot;philosophy:kant&quot;] = &lt;...&gt;
			[&quot;art&quot;] = &lt;...&gt;
		&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new appearance both corresponds more directly to the actual object structure of container types,
and has the property that paths can be constructed by directly reading identifiers down the backbone
of any subtree in the structure. It also allows the optional addition of typing information anywhere in
the structure, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = SCHEDULE &lt;
		locations = LOCATION &lt;
			[1] = &lt;...&gt;
			[2] = &lt;...&gt;
			[3] = ARTS_PAVILLION &lt;...&gt;
		&gt;
		subjects = &lt;
			[&quot;philosophy:plato&quot;] = ELECTIVE_SUBJECT &lt;...&gt;
			[&quot;philosophy:kant&quot;] = ELECTIVE_SUBJECT &lt;...&gt;
			[&quot;art&quot;] = MANDATORY_SUBJECT &lt;...&gt;
		&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These changes will affect the parsing of container structures and keys in the description and terminology parts of the archetype.</p>
</div>
</div>
<div class="sect4">
<h5 id="_revision_history_section"><a class="anchor" href="#_revision_history_section"></a>1.8.7.3. Revision History Section</h5>
<div class="paragraph">
<p>Revision history is now recorded in a separate section of the archetype, both to logically separate it from the archetype descriptive details, and to facilitate automatic processing by version control systems in which archetypes may be stored. This section is included at the end of the archetype because it is in general a monotonically growing section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_primary_language_and_languages_available_sections"><a class="anchor" href="#_primary_language_and_languages_available_sections"></a>1.8.7.4. Primary_language and Languages_available Sections</h5>
<div class="paragraph">
<p>An attribute previously called <code><em>primary_language</em></code> was required in the ontology section of an ADL 1.1 archetype. This is renamed to <code><em>original_language</em></code> and is now moved to a new top level section in the archetype called <code>language</code>. Its value is still expressed as a dADL String attribute. The <code><em>languages_available</em></code> attribute previously required in the <code>ontology</code> section of the archetype is renamed to <code><em>translations</em></code>, no longer includes the original languages, and is also moved to this new top level section.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ADL uses three syntaxes, cADL (constraint form of ADL), ODIN (Object Data Instance Notation), and openEHR Expression Language (EL), to express constraints on data which are instances of an underlying information model, which may be expressed in UML, relational form, or in a programming language. ADL itself is a very simple 'glue' syntax, which uses two other syntaxes for expressing structured constraints and data, respectively. The cADL syntax is used to express the archetype <code>definition</code> section, while the ODIN syntax is used to express data which appears in the <code>language</code>, <code>description</code>, and <code>terminology</code> sections of an ADL archetype. The top-level structure of an ADL archetype is shown in the figure below.</p>
</div>
<div class="paragraph">
<p>This main part of this document describes cADL and ADL path syntax, before going on to describe the combined ADL syntax, archetypes, specialisation, terminology integration and templates.</p>
</div>
<div id="archetype_structure" class="imageblock text-center text-center">
<div class="content">
<img src="ADL2/diagrams/adl_text_overview.svg" alt="adl text overview" width="50%">
</div>
<div class="title">Figure 1. ADL Archetype Structure</div>
</div>
<div class="sect2">
<h3 id="_an_example"><a class="anchor" href="#_an_example"></a>2.1. An Example</h3>
<div class="paragraph">
<p>The following is an example of a very simple archetype, giving a feel for the syntax. The main point to glean from the following is that the notion of 'guitar' is defined in terms of <em>constraints</em> on a <em>generic</em> model of the concept "INSTRUMENT". The names mentioned down the left-hand side of the definition section (<code>INSTRUMENT</code>, <code>size</code> etc) are alternately class and attribute names from an object model.  Each block of braces encloses a specification for some particular set of instances that conform to a specific concept, such as 'guitar' or 'neck', defined in terms of constraints on types from a generic class model. The leaf pairs of braces enclose constraints on primitive types such as <code>Integer</code>, <code>String</code>, <code>Boolean</code> and so on.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.1.5</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">adl-test-instrument.guitar.v1.0.4</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">INSTRUMENT</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">size</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">60</span><span class="tok-p">..</span><span class="tok-mi">120</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- size in cm</span>
<span class="tok-w">        </span><span class="tok-nc">date_of_manufacture</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-ld">yyyy-mm-??</span><span class="tok-p">}</span><span class="tok-w">    </span><span class="tok-c">-- year &amp; month ok</span>
<span class="tok-w">        </span><span class="tok-nc">parts</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                  </span><span class="tok-c">-- neck</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">            </span><span class="tok-c">-- timber or nickel alloy</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                  </span><span class="tok-c">-- body</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at3</span><span class="tok-p">]}</span><span class="tok-w">            </span><span class="tok-c">-- timber</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;guitar&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;stringed instrument&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;timber&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;straight, seasoned timber&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nickel alloy&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;frets&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.1.5</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">adl-test-instrument.guitar.v1.0.4</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">INSTRUMENT</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">size</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">60</span><span class="tok-p">..</span><span class="tok-mi">120</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- size in cm</span>
<span class="tok-w">        </span><span class="tok-nc">date_of_manufacture</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-ld">yyyy-mm-??</span><span class="tok-p">}</span><span class="tok-w">    </span><span class="tok-c">-- year &amp; month ok</span>
<span class="tok-w">        </span><span class="tok-nc">parts</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                     </span><span class="tok-c">-- neck</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">            </span><span class="tok-c">-- timber or nickel alloy</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                     </span><span class="tok-c">-- body</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at3</span><span class="tok-p">]}</span><span class="tok-w">            </span><span class="tok-c">-- timber</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;guitar&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;stringed instrument&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;timber&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;straight, seasoned timber&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at4&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nickel alloy&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;frets&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at4&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_encoding_and_character_quoting"><a class="anchor" href="#_file_encoding_and_character_quoting"></a>3. File Encoding and Character Quoting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_file_encoding"><a class="anchor" href="#_file_encoding"></a>3.1. File Encoding</h3>
<div class="paragraph">
<p>Because ADL files are inherently likely to contain multiple languages due to internationalised authoring and translation, they must be capable of accommodating characters from any language. ADL files do not explicitly indicate an encoding because they are assumed to be in UTF-8 encoding of unicode.  For ideographic and script-oriented languages, this is a necessity.</p>
</div>
<div class="paragraph">
<p>There are three places in ADL files where non-ASCII characters can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in string values, demarcated by double quotes, e.g. "xxxx";</p>
</li>
<li>
<p>in regular expression patterns, demarcated by either <code>//</code> or <code>^^</code>;</p>
</li>
<li>
<p>in character values, demarcated by single quotes, e.g. 'x'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>URIs (a data type in ODIN) are assumed to be 'percent-encoded' according to <a href="https://tools.ietf.org/html/rfc3986">IETF RFC 39861</a> URI syntax, which applies to all characters outside the 'unreserved set'. The unreserved set is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>unreserved = ALPHA / DIGIT / &quot;-&quot; / &quot;.&quot; / &quot;_&quot; / &quot;~&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In actual fact, ADL files encoded in latin 1 (ISO-8859-1) or another variant of ISO-8859 - both containing accented characters with unicode codes outside the ASCII 0-127 range - may work perfectly well, for various reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they contain nothing but ASCII, i.e. unicode code-points 0 - 127; this will be the case in English- language authored archetypes containing no foreign words;</p>
</li>
<li>
<p>some layer of the operating system is smart enough to do an on-the-fly conversion of characters above 127 into UTF-8, even if the archetype tool being used is designed for pure UTF-8 only;</p>
</li>
<li>
<p>the archetype tool (or the string-processing libraries it uses) might support UTF-8 and ISO- 8859 variants.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For situations where binary UTF-8 (and presumably other UTF-* encodings) cannot be supported, ASCII encoding of unicode characters above code-point 127 should only be done using the system supported by many programming languages today, namely <code>\u</code> escaped UTF-16. In this system, unicode codepoints are mapped to either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>\uHHHH</code> - 4 hex digits which will be the same (possibly 0-filled on the left) as the unicode code-point number expressed in hexadecimal; this applies to unicode codepoints in the range <code>U+0000</code> - <code>U+FFFF</code> (the 'base multi-lingual plane', BMP);</p>
</li>
<li>
<p><code>\uHHHHHHHH</code> - 8 hex digits to encode unicode code-points in the range <code>U+10000</code> through <code>U+10FFFF</code> (non-BMP planes); the algorithm is described in <a href="https://tools.ietf.org/html/rfc2781">IETF RFC 2781</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is not expected that the above approach will be commonly needed, and it may not be needed at all; it is preferable to find ways to ensure that native UTF-8 can be supported, since this reduces the burden for ADL parser and tool implementers. The above guidance is therefore provided only to ensure a standard approach is used for ASCII-encoded unicode, if it becomes unavoidable.</p>
</div>
<div class="paragraph">
<p>Thus, while <strong>the only officially designated encoding for ADL and its constituent syntaxes is UTF-8</strong>, real software systems may be more tolerant. This document therefore specifies that any tool designed to process ADL files need only support UTF-8; supporting other encodings is an optional extra. This could change in the future, if required by the ADL or openEHR user community.</p>
</div>
</div>
<div class="sect2">
<h3 id="_special_character_sequences"><a class="anchor" href="#_special_character_sequences"></a>3.2. Special Character Sequences</h3>
<div class="paragraph">
<p>In strings and characters, characters not in the lower ASCII (0-127) range should be UTF-8 encoded, with the exception of quoted single and double quotes, and some non-printing characters, for which the following customary quoted forms are allowed (but not required):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>\r</code> - carriage return</p>
</li>
<li>
<p><code>\n</code> - linefeed</p>
</li>
<li>
<p><code>\t</code> - tab</p>
</li>
<li>
<p><code>\\</code> - backslash</p>
</li>
<li>
<p><code>\"</code> - literal double quote</p>
</li>
<li>
<p><code>\'</code> - literal single quote</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any other character combination starting with a backslash is illiegal; to get the effect of a literal backslash, the <code>\\</code> sequence should always be used.</p>
</div>
<div class="paragraph">
<p>Typically, in a normal string, including multi-line paragraphs as used in ODIN, only <code>\\</code> and <code>\"</code> are likely to be necessary, since all of the others can be accommodated in their literal forms; the same goes for single characters - only <code>\\</code> and <code>\'</code> are likely to commonly occur. However, some authors may prefer to use <code>\n</code> and <code>\t</code> to make intended formatting clearer, or to allow for text editors that do not react properly to such characters. Parsers should therefore support the above list.</p>
</div>
<div class="paragraph">
<p>In regular expressions (only used in cADL string constraints), there will typically be backslash-escaped characters from the above list as well as other patterns like <code>\s</code> (whitespace) and <code>\d</code> (decimal digit), according to the <a href="https://perldoc.perl.org/perlre.html">PERL regular expression specification</a>. These should not be treated as anything other than literal strings, since they are processed by a regular expression parser.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cadl_constraint_adl"><a class="anchor" href="#_cadl_constraint_adl"></a>4. cADL - Constraint ADL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>cADL is a block-structured syntax which enables constraints on data defined by object-oriented information models to be expressed in archetypes or other knowledge definition formalisms. It is most useful for defining the specific allowable configurations of data whose instances conform to very general object models. The general appearance of cADL is illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                                </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span><span class="tok-w">                     </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                                </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span><span class="tok-w">                     </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some of the textual keywords in this example can be more efficiently rendered using common mathematical logic symbols. In the following example, the <code>matches</code> keyword have been replaced by an equivalent symbol:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/..*/</span><span class="tok-p">}</span><span class="tok-w">                </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">     </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/..*/</span><span class="tok-p">}</span><span class="tok-w">                </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">     </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The full set of equivalences appears below. Raw cADL is persisted in the text-based form, to remove any difficulties when authoring cADL text in normal text editors, and to aid reading in English. However, the symbolic form might be more widely used for display purposes and in more sophisticated tools, as it is more succinct and less language-dependent. The use of symbols or text is completely a matter of taste, and no meaning whatsoever is lost by completely ignoring one or other format according to one&#8217;s personal preference. This document uses both conventions.</p>
</div>
<div class="paragraph">
<p>In the standard cADL documented in this section, literal leaf values (such as the regular expression <code>/.+/</code> in the above example) are always constraints on a set of 'standard' widely-accepted primitive types, as described in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">openEHR ODIN syntax specification</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basics"><a class="anchor" href="#_basics"></a>4.2. Basics</h3>
<div class="sect3">
<h4 id="_keywords"><a class="anchor" href="#_keywords"></a>4.2.1. Keywords</h4>
<div class="paragraph">
<p>The following keywords are recognised in cADL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>matches</code>, <code>~matches</code>, <code>is_in</code>, <code>~is_in</code></p>
</li>
<li>
<p><code>occurrences</code>, <code>existence</code>, <code>cardinality</code></p>
</li>
<li>
<p><code>ordered</code>, <code>unordered</code>, <code>unique</code></p>
</li>
<li>
<p><code>use_node, allow_archetype</code></p>
</li>
<li>
<p><code>include</code>, <code>exclude</code></p>
</li>
<li>
<p><code>before</code> , <code>after</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Symbol equivalents for some of the above are given in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Textual<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Symbolic<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">matches</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set membership, "p is in P"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not, ~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Negation, "not p"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Infinity, 'any number of&#8230;&#8203;'</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_block_node_structure"><a class="anchor" href="#_block_node_structure"></a>4.2.2. Block / Node Structure</h4>
<div class="paragraph">
<p>cADL constraints are written in a block-structured style, similar to block-structured programming languages like C. A typical block resembles the following (the recurring pattern <code>/.+/</code> is a regular expression matching a non-empty string):</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON_NAME</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">forenames</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">family_name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;Dr&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Miss&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mrs&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mr&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">LOCATION_ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">street_number</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">street_name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">locality</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">post_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">state</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">country</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON_NAME</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">forenames</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">family_name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;Dr&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Miss&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mrs&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mr&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">LOCATION_ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">street_number</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">street_name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">locality</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">post_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">state</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">country</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, each block is introduced by an identifier (shown in blue) from an information model. The identifiers alternate between type-names (upper case in this example, or 'camel' case) and type attribute names (lower case). Here, 'type-name' indicates the name of a type, which may be a class name, or may be a derived generic type name. An 'attribute name' is the name of an attribute in the inheritance-flattened form of a type, i.e. may be be defined in an ancestor class of the class to which the type-name most directly corresponds.</p>
</div>
<div class="paragraph">
<p>Blocks introduced by a type name are known as <em>object blocks</em> or <em>object nodes</em>, while those introduced by an attribute name are <em>attribute blocks</em> or <em>attribute nodes</em>.</p>
</div>
<div class="paragraph">
<p>The block identifier is followed by the  operator (equivalent text keyword: <code>matches</code> or <code>is_in</code> ) followed by an open brace, is the start of a 'block', which continues until the closing matching brace (normally visually indented to match the line at the beginning of the block).</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                     </span><span class="tok-c">-- OBJECT block 1 ------------+</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- attribute block A ---+ |</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON_NAME</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- OBJECT block 2   + |</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w">                                   </span><span class="tok-c">-------------------------+ |</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">                                   </span><span class="tok-c">-------------------------------+</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                     </span><span class="tok-c">-- OBJECT block 1 ------------+</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- attribute block A ---+ |</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON_NAME</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- OBJECT block 2   + |</span>
<span class="tok-w">        </span><span class="tok-p">}</span><span class="tok-w">                                   </span><span class="tok-c">-------------------------+ |</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">                                   </span><span class="tok-c">-------------------------------+</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An object block or node can be thought of as a constraint matching a set of instances conforming to the type which introduces the block.</p>
</div>
<div class="paragraph">
<p>The example above expresses a constraint on an instance of the type <code>PERSON</code> ; the constraint is expressed by everything inside the <code>PERSON</code> block. The two blocks at the next level define constraints on properties of <code>PERSON</code> , in this case <code><em>name</em></code> and <code><em>addresses</em></code>. Each of these constraints is expressed in turn by the next level containing constraints on further types, and so on. The general structure is therefore a recursive nesting of constraints on types, followed by constraints on attributes (of that type), followed by types (being the types of the attribute under which it appears) until leaf nodes are reached.</p>
</div>
<div class="paragraph principle">
<p>A cADL text is a structure of alternating object and attribute blocks each introduced respectively by type names and attribute names from an underlying information model.</p>
</div>
</div>
<div class="sect3">
<h4 id="_comments"><a class="anchor" href="#_comments"></a>4.2.3. Comments</h4>
<div class="paragraph">
<p>In a cADL text, comments are defined as follows:</p>
</div>
<div class="paragraph principle">
<p>Comments are indicated by the leader characters '--'. Multi-line comments are achieved using the '--' leader on each line where the comment continues.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_underlying_information_model"><a class="anchor" href="#_the_underlying_information_model"></a>4.2.4. The Underlying Information Model</h4>
<div class="paragraph">
<p>Identifiers in cADL texts correspond to entities - types and attributes - in an information model. The latter is typically an object-oriented model, but may just as easily be an entity-relationship model or any other typed model of information. A UML model compatible with the example above is shown in <a href="#uml_model_of_person">Figure 2</a>. Note that there can be more than one model compatible with a given fragment of cADL syntax, and in particular, there are usually more properties and classes in the reference model than are mentioned in the cADL constraints. In other words, a cADL text includes constraints <em>only for those parts of a model that are useful or meaningful to constrain</em>.</p>
</div>
<div id="uml_model_of_person" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/AM-example-demographics.svg" alt="AM example demographics">
</div>
<div class="title">Figure 2. UML Model of Person</div>
</div>
<div class="paragraph">
<p>Constraints expressed in cADL cannot invalidate those from the information model. For example, the <code>PERSON.<em>family_name</em></code> attribute is mandatory in the model in the above <code>PERSON</code> model, so it is not valid to express a constraint allowing the attribute to be optional. In general, a cADL archetype can only further constrain an existing information model. However, it must be remembered that for very generic models consisting of only a few classes and a lot of optionality, this rule is not so much a limitation as a way of adding meaning to information. Thus, for a demographic information model which has only the types <code>PARTY</code> and <code>PERSON</code>, one can write cADL which defines the concepts of entities such as <code>COMPANY</code> , <code>EMPLOYEE</code> , <code>PROFESSIONAL</code> , and so on, in terms of constraints on the types available in the information model.</p>
</div>
<div class="paragraph">
<p>This general approach can be used to express constraints for instances of any information model. The following example shows how to express a constraint on the <code><em>value</em></code> property of an <code>ELEMENT</code> class to be a <code>DV_QUANTITY</code> with a suitable range for expressing blood pressure.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- diastolic blood pressure</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9071</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;pressure&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- diastolic blood pressure</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;pressure&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this specification, the terms underlying information model and <em>reference model</em> are equivalent and refer to the information model on which a cADL text is based.</p>
</div>
<div class="sect4">
<h5 id="_information_model_identifiers"><a class="anchor" href="#_information_model_identifiers"></a>4.2.4.1. Information Model Identifiers</h5>
<div class="paragraph">
<p>Identifiers from the underlying information model are used to introduce all cADL nodes. Identifiers obey the same rules as in ODIN: type names commence with an upper case letter, while attribute and function names commence with a lower case letter. In cADL, names of types and the name of any property (i.e. attribute or parameterless function) can be used.</p>
</div>
<div class="paragraph principle">
<p>A <strong>type name</strong> is any identifier with an initial upper case letter, followed by any combination of letters, digits and underscores. A <strong>generic type name</strong> (including nested forms) additionally may include commas, angle brackets and spaces, and must be syntactically correct as per the OMG UML 2.x specification or higher. An <strong>attribute name</strong> is any identifier with an initial lower case letter, followed by any combination of letters, digits and underscores. Any convention that obeys this rule is allowed.</p>
</div>
<div class="paragraph">
<p>Type identifiers are shown in this document in all uppercase, e.g. <code>PERSON</code> , while attribute identifiers are shown in all lowercase, e.g. <code>home_address</code> . In both cases, underscores are used to represent word breaks. This convention is used to improve the readability of this document, and other conventions may be used, such as the common programmer&#8217;s mixed-case convention exemplified by <code>Person</code> and <code>homeAddress</code>. The convention chosen for any particular cADL document should be based on that used in the underlying information model.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_node_identifiers"><a class="anchor" href="#_node_identifiers"></a>4.2.5. Node Identifiers</h4>
<div class="paragraph">
<p>Node identifier codes appear after all type identifiers in a cADL text. For at-coded archetypes they take the form of an 'at-code' in brackets, e.g. <code>[at0002]</code>. The at-code of a root object in a structure is always <code>at0000</code>, or for specialised archetypes, <code>at0000.1</code>, <code>at0000.1.1</code> etc. The rules and use of node identifiers is described in more detail below. For id-coded archetypes they take the form of an 'id-code' in brackets, e.g. <code>[id3]</code>. The id-code of a root object in a structure is always <code>id1</code>, or for specialised archetypes, <code>id1.1</code>, <code>id1.1.1</code> etc. The rules and use of node identifiers is described in more detail below.</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_matches_operator"><a class="anchor" href="#_the_matches_operator"></a>4.2.6. The matches Operator</h4>
<div class="paragraph">
<p>The <code>matches</code> or <code>is_in</code> operator deserves special mention, since it is the key operator in cADL. This operator can be understood mathematically as set membership. When it occurs between an identifier and a block delimited by braces, the meaning is: the set of values allowed for the entity referred to by the name (either an object, or parts of an object - attributes) is specified between the braces. What appears between any matching pair of braces can be thought of as a <em>specification for a set of values</em>. Since blocks can be nested, this approach to specifying values can be understood in terms of nested sets, or in terms of a value space for instances of a type. Thus, in the following example, the <code>matches</code> operator links the name of an entity to a linear value space (i.e. a list), consisting of all words ending in 'ion'.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/\w*ion[\s\n\t ]/</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- the set of words ending in &#39;ion&#39; </span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example links the name of a type <code>XXX</code> with a hierarchical value space.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">XXX</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">xxx_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">YYY</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">yyy_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..3</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">xxx_attr2</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ZZZ</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">zzz_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&gt;</span><span class="tok-ld">1992-12-01</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">XXX</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">xxx_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">YYY</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">yyy_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..3</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">xxx_attr2</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ZZZ</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">zzz_attr1</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&gt;</span><span class="tok-ld">1992-12-01</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of the syntax above is: data matching the constraints consists of an instance of type <code>XXX</code> , or any subtype allowed by the underlying information model, for which the value of attribute <code><em>aaa</em></code> is of type <code>YYY</code> , or any subtype allowed by the underlying information model, and so on, recursively until leaf level constraints are reached.</p>
</div>
<div class="paragraph">
<p>Occasionally the <code>matches</code> operator needs to be used in the negative, usually at a leaf block. Any of the following can be used to constrain the value space of the attribute <code>aaa</code> to any number except 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">~matches </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">~is_in </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The choice of whether to use <code>matches</code> or <code>is_in</code> is a matter of taste and background; those with a mathematical background will probably prefer <code>is_in</code> , while those with a data processing background may prefer <code>matches</code> .</p>
</div>
</div>
<div class="sect3">
<h4 id="_natural_language"><a class="anchor" href="#_natural_language"></a>4.2.7. Natural Language</h4>
<div class="paragraph">
<p>cADL is completely independent of all natural languages. The only potential exception is where constraints include literal values from some language, and this is easily and routinely avoided by the use of separate language and terminology definitions, as used in ADL archetypes. However, for the purposes of readability, comments in English have been included in this document to aid the reader. In real cADL documents, comments are generated from the archetype terminology in the language of the locale.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constraints_on_complex_types"><a class="anchor" href="#_constraints_on_complex_types"></a>4.3. Constraints on Complex types</h3>
<div class="paragraph">
<p>This section describes the semantics for constraining objects of complex, i.e. non-primitive types. The semantics apply recursively through a constraint structure until leaf nodes constraining primitive types are reached.</p>
</div>
<div class="sect3">
<h4 id="_attribute_constraints"><a class="anchor" href="#_attribute_constraints"></a>4.3.1. Attribute Constraints</h4>
<div class="paragraph">
<p>In any information model, attributes are either single-valued or multiply-valued, i.e. of a generic container type such as <code>List&lt;Contact&gt;</code> . Both have <code><em>existence</em></code> , while multiply-valued attributes also have <code><em>cardinality</em></code>.</p>
</div>
<div class="sect4">
<h5 id="_existence"><a class="anchor" href="#_existence"></a>4.3.1.1. Existence</h5>
<div class="paragraph">
<p>The existence constraint may be used with any attribute to further constrain the existence defined by the underlying reference model. An existence constraint indicates whether an attribute value is mandatory or optional, and is indicated by "0..1" or "1" markers at line ends in UML diagrams (and often mistakenly referred to as a "cardinality of 1..1"). Attributes defined in the reference model have an effective existence constraint, defined by the invariants (or lack thereof) of the relevant class. For example, the <code><em>protocol</em></code> attribute in the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html" target="_blank" rel="noopener">openEHR EHR IM</a> <code>OBSERVATION</code> class is defined in the reference model as being optional, i.e. <code>0..1</code>. An archetype may redefine this to <code>{1..1}</code>, making the attribute mandatory. Existence constraints are expressed in cADL as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">protocol</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- details</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">protocol</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- details</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of an existence constraint is to indicate whether a value - i.e. an object - is mandatory or optional (i.e. obligatory or not) in runtime data for the attribute in question. The same logic applies whether the attribute is of single or multiple cardinality, i.e. whether it is a container type or not. For container attributes, the existence constraint indicates whether the whole container (usually a list or set) is mandatory or not; a further cardinality constraint (described below) indicates how many members in the container are allowed.</p>
</div>
<div class="paragraph principle">
<p>An <strong>existence constraint</strong> may be used directly after any attribute identifier, and indicates whether the object to which the attribute refers is mandatory or optional in the data.</p>
</div>
<div class="paragraph">
<p>Existence is shown using the same constraint language as the rest of the archetype definition. Existence constraints can take the values <code>{0}</code> , <code>{0..0}</code> , <code>{0..1}</code> , <code>{1}</code> , or <code>{1..1}</code> . The first two of these constraints may not seem initially obvious, but can be used to indicate that an attribute must not be present in the particular situation modelled by the archetype. This may be reasonable in some cases.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_single_valued_attributes"><a class="anchor" href="#_single_valued_attributes"></a>4.3.2. Single-valued Attributes</h4>
<div class="paragraph">
<p>A single-valued attribute is an attribute whose type as declared in the underlying class model is of a single object type rather than a container type such as a list or set. Single-valued attributes can be constrained with a single object constraint as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple alternative object constraints can also be defined, using a number of sibling blocks, as shown in the following example. Each block defines an alternative constraint, only one of which needs to be matched by the data.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- miles per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- km per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;km/h&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- miles per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id23</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- km per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;km/h&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the occurrences of both <code>DV_QUANTITY</code> constraints is not stated, leading to the result that only one <code>DV_QUANTITY</code> instance can appear in runtime data, matching either one of the constraints.</p>
</div>
<div class="paragraph principle">
<p>Two or more object constraints introduced by type names appearing after a single-valued attribute (i.e. one for which there is no cardinality constraint) are understood as alternative constraints, only one of which is matched by the data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_attributes"><a class="anchor" href="#_container_attributes"></a>4.3.3. Container Attributes</h4>
<div class="sect4">
<h5 id="_cardinality"><a class="anchor" href="#_cardinality"></a>4.3.3.1. Cardinality</h5>
<div class="paragraph">
<p>The cardinality of container attributes may be constrained in cADL with the <code><em>cardinality</em></code> constraint. Cardinality indicates limits on the number of instance members of a container types such as lists and sets. Consider the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>cardinality</code> keyword implies firstly that the property events must be of a container type, such as <code>List&lt;T&gt;</code> , <code>Set&lt;T&gt;</code> , <code>Bag&lt;T&gt;</code> . The integer range indicates the valid membership of the container; a single '*' means the range '0..*', i.e. '0 to many'. The type of the container is not explicitly indicated, since it is usually defined by the information model. However, the semantics of a logical set (unique membership, ordering not significant), a logical list (ordered, non-unique membership) or a bag (unordered, non-unique membership) can be constrained using the additional keywords <code>ordered</code> , <code>unordered</code> , <code>unique</code> and <code>non-unique</code> within the cardinality constraint, as per the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- logical list</span>
<span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; unordered; unique</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- logical set</span>
<span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                 </span><span class="tok-c">-- logical bag</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If no numeric or ordering constraint on the cardinality of a container attribute is required, the keyword is used on its own, and simply indicates that the attribute is a container, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- indicates &#39;events&#39; is a container</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although this is not strictly ncessary for the purpose of expressing valid archetypes if the Reference Model can usually be referred to, it enables early stage parsing to generate the correct type of attributes without referring to a Reference Model schema, which in any case may not always be available. This in turn enables more faithful visualisation at an earlier point in the archetype compilation process.</p>
</div>
<div class="paragraph">
<p>In theory, no cardinality constraint can be stronger than the semantics of the corresponding container in the relevant part of the reference model. However, in practice, developers often use lists to facilitate data integration, when the actual semantics are intended to be of a set; in such cases, they typically ensure set-like semantics in their own code rather than by using an <code>Set&lt;T&gt;</code> type. How such constraints are evaluated in practice may depend somewhat on knowledge of the software system.</p>
</div>
<div class="paragraph principle">
<p>A <strong>cardinality constraint</strong> must be used after any Reference Model container attribute name (or after its existence constraint, if there is one) in order to designate it as a container attribute. Additionally, it may constrain the number of member items it may have in the data, and whether it has "list", "set", or "bag" semantics, via the use of the keywords 'ordered', 'unordered', 'unique' and 'non-unique'.</p>
</div>
<div class="paragraph">
<p>The numeric part of the cardinality contraint can take the values <code>{0}</code>, <code>{0..0}</code>, <code>{0..n}</code>, <code>{m..n}</code>, <code>{0..*}</code>, or <code>{*}</code>, or a syntactic equivalent. The first two of these constraints are unlikely to be useful, but there is no reason to prevent them. There is no default cardinality, since if none is shown, the relevant attribute is assumed to be single-valued (in the interests of uniformity in archetypes, this holds even for smarter parsers that can access the reference model and determine that the attribute is in fact a container).</p>
</div>
<div class="paragraph">
<p>Cardinality and existence constraints can co-occur, in order to indicate various combinations on a container type property, e.g. that it is optional, but if present, is a container that may be empty, as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-c">-- etc --}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_object_constraints"><a class="anchor" href="#_object_constraints"></a>4.3.4. Object Constraints</h4>
<div class="sect4">
<h5 id="_node_identifiers_2"><a class="anchor" href="#_node_identifiers_2"></a>4.3.4.1. Node Identifiers</h5>
<div class="paragraph">
<p>In cADL, an entity in brackets of the form <code>[atNNNN]</code> for at-coded archetypes or <code>[idN]</code> for id-coded archetypes following a type name is used to identify an object node, i.e. a node constraint delimiting a set of instances of the type as defined by the reference model. Object nodes always commence with a type name. Although any node identifier format could be supported, the current version of ADL assumes that node identifiers are of the form of an archetype term identifier, i.e. <code>[atNNNN]</code> for at-coded archetypes (e.g. <code>[at0041]</code>) or <code>[idN]</code> for id-coded archetypes (e.g. <code>[id42]</code>) . Node identifiers are shown in magenta in this document.</p>
</div>
<div class="paragraph">
<p>The structural function of node identifiers is to allow the formation of paths:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>enable cADL nodes in an archetype definition to be unambiguously referred to within the same archetype;</p>
</li>
<li>
<p>enable data created using a given archetype to be matched at runtime;</p>
</li>
<li>
<p>to enable cADL nodes in a parent archetype to be unambiguously referred to from a specialised child archetype;</p>
</li>
<li>
<p>to enable unique paths to be formed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All object nodes require a node identifier, guaranteeing the ability to generate unique paths, and to process specialised archetypes with respect to inheritance parents.</p>
</div>
<div class="paragraph principle">
<p>A <strong>Node identifier</strong> is required for every object node in an archetype.</p>
</div>
<div class="paragraph">
<p>The node identifier can also perform a semantic function, that of giving a design-time meaning to the node, by equating the node identifier to some description. The use of node identifiers in archetypes is the main source of their expressive power. Each node identifier acts as a 'semantic marker' or 'override' on the node. Thus, in the example shown in <a href="#_the_underlying_information_model">Section 4.2.4</a>, the <code>ELEMENT</code> node is identified by the code <code>[at0009]</code> (<code>[id10]</code>) , which can be designated elsewhere in an archetype as meaning "diastolic blood pressure". In this way rich meaning is given to data constructed from a limited number of object types.</p>
</div>
<div class="paragraph">
<p><strong>Not every object node identifier needs to be defined in the archetype terminology</strong>: it is only mandatory for the identifiers of nodes defined under container attributes, and multiple alternative nodes under single-valued attributes. The identifiers of single object nodes defined under single-valued attributes may have terminology definitions, but don&#8217;t typically need them, since the meaning is obvious from the attribute.</p>
</div>
</div>
<div class="sect4">
<h5 id="_occurrences"><a class="anchor" href="#_occurrences"></a>4.3.4.2. Occurrences</h5>
<div class="paragraph">
<p>A constraint on occurrences is used only with cADL object nodes, to indicate how many times in data an instance conforming to the constraint can occur. It is usually only defined on objects that are children of a container attribute, since by definition, the occurrences of an object that is the value of a single-valued attribute can only be <code>0..1</code> or <code>1..1</code>, and this is already defined by the attribute&#8217;s <code>existence</code>. However, it may be used in specialised archetypes to exclude a possibility defined in a parent archetype (see <a href="#_attribute_redefinition">Section 9.4</a>).</p>
</div>
<div class="paragraph">
<p>In the example below, three <code>EVENT</code> constraints are shown; the first one ("1 minute sample") is shown as mandatory, while the other two are optional.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 1 minute sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 2 minute sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 3 minute sample</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 1 minute sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 2 minute sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 3 minute sample</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example expresses a constraint on instances of <code>GROUP</code> such that for <code>GROUPs</code> representing tribes, clubs and families, there can only be one "head", but there may be many members.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">GROUP</span><span class="tok-p">[</span><span class="tok-nd">at0102</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">kind</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/tribe|family|club/</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0103</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">GROUP</span><span class="tok-p">[</span><span class="tok-nd">id103</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">kind</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/tribe|family|club/</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id105</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first <code>occurrences</code> constraint indicates that a <code>PERSON</code> with the title <code>"head"</code> is mandatory in the <code>GROUP</code> , while the second indicates that at runtime, instances of <code>PERSON</code> with the title <code>"member"</code> can number from none to many. Occurrences may take the value of any range including <code>{0..*}</code>, meaning that any number of instances of the given type may appear in data, each conforming to the one constraint block in the archetype. A single positive integer, or the infinity indicator, may also be used on its own, thus: <code>{2}</code> , <code>{*}</code> . A range of <code>{0..0}</code> or <code>{0}</code> indicates that no occurrences of this object are allowed in this archetype. If no occurrences constraint is stated, the occurrences of the object is define by the underlying reference model.</p>
</div>
<div class="paragraph principle">
<p>An <strong>occurrences constraint</strong> may appear directly after the type name of any object constraint within a container attribute, in order to indicate how many times data objects conforming to the block may occur in the data.</p>
</div>
<div class="paragraph">
<p>Where cardinality constraints are used (remembering that occurrences is always there by default, if not explicitly specified), cardinality and occurrences must always be compatible. The rules for this are formally stated in the Archetype Object Model specification. The key elements of these rules are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>where a cardinality constraint is stated with a finite upper bound:</p>
<div class="ulist">
<ul>
<li>
<p>any child object with either stated occurrences with an open upper bound (typically <code>0..*</code> or <code>1..*</code>) or else inferred occurrences (<code>0..*</code>) is legal, since the occurrences open upper bound is interpreted to mean the maximum value allowed by the cardinality upper bound.</p>
</li>
<li>
<p>the sum of all child object occurrences lower bounds must be less than the cardinality upper bound;</p>
</li>
</ul>
</div>
</li>
<li>
<p>no 'orphans': at least one instance of an optional child object (occurrences lower bound = 0), and one instance of every mandatory child object (occurrences lower bound &gt; 0) must be includable within the cardinality range.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_any_constraints"><a class="anchor" href="#_any_constraints"></a>4.3.5. "Any" Constraints</h4>
<div class="paragraph">
<p>There are two cases where it is useful to state a completely open, or 'any', constraint. The first is when it is desired to override the existence or cardinality of a property, such as in the following:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-c">-- etc --</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-c">-- etc --</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, no further <code>matches {}</code> part is required in the statement, since no more constraints are to be stated.</p>
</div>
<div class="paragraph">
<p>The second use of "any" as a constraint value is for types, such as in the following:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w">  </span><span class="tok-c">-- type was &#39;DATA_VALUE&#39; in RM</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w">  </span><span class="tok-c">-- type was &#39;DATA_VALUE&#39; in RM</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of this constraint is that in the data at runtime, the <code><em>value</em></code> property of <code>ELEMENT</code> must be of type <code>DV_QUANTITY</code> , but can have any value internally. This is most useful for constraining objects to be of a certain type, without further constraining value, and is especially useful where the information model contains subtyping, and there is a need to restrict data to be of certain subtypes in certain contexts.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4, 'any' constraints were represented with an additional <code>matches {*}</code> at the end of the statement. This is deprecated. It is recommended that parsers silently accept this form, but output the modern ADL 2 form.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reference_model_type_matching"><a class="anchor" href="#_reference_model_type_matching"></a>4.3.6. Reference Model Type Matching</h4>
<div class="paragraph">
<p>All cADL object constraints state a type name from an underlying reference model. Lexically speaking, this may be an abstract class name, a concrete class name or a generic type name, if the RM in question supports generic (template) types. In the latter case, the type name is constructed from RM class names, according to the standard generic type name syntax used in UML and mainstream languages such as C++, Java, C# and so on, i.e. using the characters <code>&lt;&gt;</code>, <code>,</code> and space(s). Additionally, matching of type names is case-insensitive, and whitespace is ignored. Thus, <code>"SECTION"</code> in the archetype is assumed to match a data instance whose type is <code>SECTION</code> or <code>Section</code>; <code>"Interval&lt;Quantity&gt;"</code> in the archetype is assumed to match a data instance whose RM type is <code>INTERVAL &lt;QUANTITY&gt;</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
direct matching of so-called CamelCase by Snake_case or SCREAMING_SNAKE_CASE and vice-versa is not assumed, but could be enabled by a switch in tools.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In semantic terms, the data item conforming to the archetype constraint can be of any concrete type from the reference model (i.e. class name or derived generic type as above) that <em>conforms</em> to the type mentioned in the constraint, i.e. the same type if it is concrete, or any subtype. Correctly evaluating data/archetype conformance is up to tools to implement, and requires access to a formal description of the reference model.</p>
</div>
<div class="paragraph">
<p>The precise specification of RM type matching is given in the section <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_rm_type_name_and_reference_model_type_matching" target="_blank" rel="noopener">Rm_type_name and reference model type matching</a> of the AOM2 specification.</p>
</div>
<div class="sect4">
<h5 id="_narrowed_subtype_constraints"><a class="anchor" href="#_narrowed_subtype_constraints"></a>4.3.6.1. Narrowed Subtype Constraints</h5>
<div class="paragraph">
<p>One of the consequences of subtype-based type matching is that semantics are needed for when more than one reference model subtype is declared under the same attribute node in cADL. Consider the reference model inheritance structure shown below, in which the abstract <code>PARTY</code> class has abstract and concrete descendants including <code>ACTOR</code>, <code>ROLE</code>, and so on.</p>
</div>
<div id="ADL-demographics-parties" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/AM-example-demographics-parties.svg" alt="AM example demographics parties">
</div>
<div class="title">Figure 3. Reference Model Sub-type Hierarchy</div>
</div>
<div class="paragraph">
<p>The following cADL statement defines an instance space that includes instances of any of the concrete subtypes of the <code>PARTY</code> class within an instance of the class <code>XXXX</code> in the figure (the ellipsis indicates particular constrraints not shown here).</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, in some circumstances, it may be desirable to define a constraint that will match a particular subtype in a specific way, while other subtypes are matched by the more general rule. Under a single-valued attribute, this can be done as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This cADL text says that the instance value of the <code><em>counter_party</em></code> attribute in the data can either be a <code>PERSON</code> object matching the <code>PERSON</code> block, with a <code><em>date_of_birth</em></code> matching the given range, or else any other kind of <code>PARTY</code> object.</p>
</div>
<div class="paragraph">
<p>Under a multiply-valued attribute, the alternative subtypes are included as identified child members. The following example illustrates a constraint on the <code><em>counter_parties</em></code> attribute of instances of the class <code>YYYY</code> in <a href="#ADL-demographics-parties">Figure 3</a>.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_parties</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ORGANISATION</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_registration</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_parties</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ORGANISATION</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">date_of_registration</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above says that <code>ORGANISATION</code> and <code>PERSON</code> instances in the data must match, respectively, the <code>ORGANISATION</code> and <code>PERSON</code> constraints stated above, while an instance of any other subtype of <code>PARTY</code> must match the <code>PARTY</code> constraint.</p>
</div>
</div>
<div class="sect4">
<h5 id="_remove_specified_subtypes"><a class="anchor" href="#_remove_specified_subtypes"></a>4.3.6.2. Remove Specified Subtypes</h5>
<div class="paragraph">
<p>In some cases it is required to remove some subtypes altogether. This is achieved by stating a constraint on the specific subtypes with <code>occurrences</code> limited to zero. The following example matches any <code>PARTY</code> instance with the exception of instances of <code>COMPANY</code> or <code>GROUP</code> subtypes.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">COMPANY</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">GROUP</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">counter_party</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PARTY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">COMPANY</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">GROUP</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_paths"><a class="anchor" href="#_paths"></a>4.3.7. Paths</h4>
<div class="sect4">
<h5 id="_archetype_path_formation"><a class="anchor" href="#_archetype_path_formation"></a>4.3.7.1. Archetype Path Formation</h5>
<div class="paragraph">
<p>The use of identified object nodes allows the formation of archetype paths, which can be used to unambiguously reference object nodes within the same archetype or within a specialised child. The syntax of archetype paths is designed to be close to the W3C Xpath syntax, and can be directly converted to it for use in XML.</p>
</div>
<div class="paragraph principle">
<p>Archetype paths are paths extracted from the definition section of an archetype, and refer to object nodes within the definition. A path is constructed as a concatenation of '/' characters and attribute names, with the latter including node identifiers as predicates where required for disambiguation.</p>
</div>
<div class="paragraph">
<p>In the following example, the <code>PERSON</code> constraint node is the sole object constraint under the single-valued attribute manager:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">manager</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0103</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head of finance&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;head of engineering&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Two valid paths to the object under the <code><em>title</em></code> attribute are possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">manager</span><span class="tok-p">[</span><span class="tok-nd">at0103</span><span class="tok-p">]/</span><span class="tok-nc">title</span>
<span class="tok-p">    </span><span class="tok-nc">manager</span><span class="tok-p">/</span><span class="tok-nc">title</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">manager</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head of finance&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;head of engineering&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Two valid paths to the object under the <code><em>title</em></code> attribute are possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">manager</span><span class="tok-p">[</span><span class="tok-nd">id104</span><span class="tok-p">]/</span><span class="tok-nc">title</span>
<span class="tok-p">    </span><span class="tok-nc">manager</span><span class="tok-p">/</span><span class="tok-nc">title</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Where there is more than one sibling node, node identifiers must be used to ensure unique referencing:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">employees</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0103</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The paths to the respective <code><em>title</em></code> attributes are now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">employees</span><span class="tok-p">[</span><span class="tok-nd">at0103</span><span class="tok-p">]/</span><span class="tok-nc">title</span>
<span class="tok-p">    </span><span class="tok-nc">employees</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]/</span><span class="tok-nc">title</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">employees</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id105</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The paths to the respective <code><em>title</em></code> attributes are now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">employees</span><span class="tok-p">[</span><span class="tok-nd">id104</span><span class="tok-p">]/</span><span class="tok-nc">title</span>
<span class="tok-p">    </span><span class="tok-nc">employees</span><span class="tok-p">[</span><span class="tok-nd">id105</span><span class="tok-p">]/</span><span class="tok-nc">title</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following provides another example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following paths can be constructed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/                      </span><span class="tok-c">-- the HISTORY (root) object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">periodic</span><span class="tok-p">              </span><span class="tok-c">-- the HISTORY.periodic attribute</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]        </span><span class="tok-c">-- the 1 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]        </span><span class="tok-c">-- the 2 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]        </span><span class="tok-c">-- the 3 minute event object</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following paths can be constructed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/                      </span><span class="tok-c">-- the HISTORY (root) object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">periodic</span><span class="tok-p">              </span><span class="tok-c">-- the HISTORY.periodic attribute</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]           </span><span class="tok-c">-- the 1 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]           </span><span class="tok-c">-- the 2 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]           </span><span class="tok-c">-- the 3 minute event object</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above paths can all be used to reference the relevant nodes within the archetype in which they are defined, or within any specialised child archetype.</p>
</div>
<div class="paragraph">
<p>Paths used in cADL are expressed in the ADL path syntax, described in detail in <a href="#_adl_paths">Section 5</a>. ADL paths have the same alternating object/attribute structure implied in the general hierarchical structure of cADL, obeying the pattern <code>TYPE/attribute/TYPE/attribute/</code> &#8230;&#8203; .</p>
</div>
<div class="paragraph">
<p>The examples above are <em>physical</em> paths because they refer to object nodes using node identifier codes such as 'at0003' ('id4'). Physical paths can be rendered as <em>logical</em> paths by adding the code meanings from the <code>terminology</code> section as annotations for node identifiers, if defined. Thus, the following two paths might be equivalent:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>    /events[at0003]                       -- the 3 minute event object
    /events[at0003|3 minute event|]       -- the 3 minute event object</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>    /events[id4]                       -- the 3 minute event object
    /events[id4|3 minute event|]       -- the 3 minute event object</pre>
</div>
</div>
<div class="paragraph">
<p>The double-bar ('|xxx|') method of displaying annotations on codes is adopted from the <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT medical terminology</a> and is widely used in the healthcare domain.</p>
</div>
</div>
<div class="sect4">
<h5 id="_external_use_of_paths"><a class="anchor" href="#_external_use_of_paths"></a>4.3.7.2. External Use of Paths</h5>
<div class="paragraph">
<p>None of the paths shown above are valid outside the cADL text in which they occur, since they do not include an identifier of the enclosing artefact, normally an archetype. To reference a cADL node in an archetype from elsewhere (e.g. another archetype or a template), the identifier of the containing itself must be prefixed to the path, as in the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>    [openehr-ehr-entry.apgar-result.v]/events[at0001]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>    [openehr-ehr-entry.apgar-result.v]/events[id2]</pre>
</div>
</div>
<div class="paragraph">
<p>This kind of path expression is necessary to form the paths that occur when archetypes are composed to form larger structures.</p>
</div>
</div>
<div class="sect4">
<h5 id="_runtime_paths"><a class="anchor" href="#_runtime_paths"></a>4.3.7.3. Runtime Paths</h5>
<div class="paragraph">
<p>Paths for use with runtime data based on an archetype can be constructed in the same way as the paths from the archetype, and are the same except for single-valued attributes. Since in data only a single instance can appear as the value of a single-valued attribute, there is never any ambiguity in referencing it, whereas an archetype path to or through the same attribute may require a node identifier due to the possible presence of multiple alternatives. Consider the example from above:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- miles per hour</span>
<span class="tok-w">                    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">                    </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- km per hour</span>
<span class="tok-w">                    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|}</span>
<span class="tok-w">                    </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;km/h&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following archetype paths can be constructed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span>
<span class="tok-p">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance data created according to this archetype, the following runtime path can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">               </span><span class="tok-c">-- since there is only one DV_QUANTITY in the data</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- miles per hour</span>
<span class="tok-w">                    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">                    </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id23</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                       </span><span class="tok-c">-- km per hour</span>
<span class="tok-w">                    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|}</span>
<span class="tok-w">                    </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;km/h&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following archetype paths can be constructed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span>
<span class="tok-p">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">id23</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance data created according to this archetype, the following runtime path can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">               </span><span class="tok-c">-- since there is only one DV_QUANTITY in the data</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A query using this path will match the data regardless of which type of <code>DV_QUANTITY</code> object is there. However, in some circumstances, queries may need to be specific, in which case they will use the full archetype path, i.e. <code>items[at0003]/value[at9001]</code> (<code>items[id4]/value[id22]</code>) or <code>items[at0003]/value[at9002]</code> (<code>items[id4]/value[id23]</code>) to select only 'miles' or 'kilometres' data. This will only work if the node ids (at/id-codes) are in fact stored in all types of the reference model data.
If for example this was not the case with the <code>DV_QUANTITY</code> type (as in openEHR reference model), another facet of the <code>DV_QUANTITY</code> objects from the archetype such as 'units = "km/h"' would need to be used in the query to correctly locate only metric <code>DV_QUANTITY</code> objects.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_internal_references_proxy_constraint_objects"><a class="anchor" href="#_internal_references_proxy_constraint_objects"></a>4.3.8. Internal References (Proxy Constraint Objects)</h4>
<div class="paragraph">
<p>It is possible to define a constraint structure at a certain point to be the same as a structure defined elsewhere in the archetype, rather than copying the desired structure. This is achieved using a proxy constraint object, using the following syntax:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_node </span><span class="tok-nc">TYPE</span><span class="tok-p">[</span><span class="tok-nc">atNNNN</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-nc">archetype_path</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_node </span><span class="tok-nc">TYPE</span><span class="tok-p">[</span><span class="tok-nc">idN</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-nc">archetype_path</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This statement defines a node of type <code>TYPE</code>, whose definition is the same as the one found at path <code>archetype_path</code>. The type mentioned in the <code>use_node</code> reference must always be the same type as the referenced type.</p>
</div>
<div class="paragraph">
<p>The path must not be in the parent path of the proxy object itself, but may be a sibling of the proxy object. The sibling case is a special case, and the meaning of the proxy constraint is that the target object&#8217;s children should be re-used, but not the target itself (since that would illegally create two siblings with the same identifier). The general case is that the proxy object and target object locations are different, and the meaning is that the proxy object is logically replaced by a deep copy of the target object. (In theory the sibling case could be banned, and proxies defined one level further down with targets of the children of the originally intended target, but this creates inconvenience for the archetype author, and can easily be dealt with in tools).</p>
</div>
<div class="paragraph">
<p>Occurrences from the target are also assumed, or may be explicitly overridden:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_node </span><span class="tok-nc">TYPE</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-nc">archetype_path</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_node </span><span class="tok-nc">TYPE</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-nc">archetype_path</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Proxy objects provide an internal reuse mechanism. Specialised archetypes may redefine structures on such nodes as if they had been defined inline. This is described in more detail in <a href="#_internal_reference_proxy_object_redefinition">Section 9.5.6</a>.</p>
</div>
<div class="paragraph principle">
<p>A proxy constraint object allows object constraints defined elsewhere to be re-used within the same archetype or a specialised child.</p>
</div>
<div class="paragraph">
<p>The following example shows the definitions of the <code>ADDRESS</code> nodes for phone, fax and email for a home <code>CONTACT</code> being reused for a work <code>CONTACT</code> .</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">identities</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- etc --</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- postal address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- phone</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- fax</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- email</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                    </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]    </span><span class="tok-c">-- phone</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]   </span><span class="tok-c">-- fax</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]   </span><span class="tok-c">-- email</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">identities</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- etc --</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- postal address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- phone</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- fax</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- email</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                    </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]    </span><span class="tok-c">-- phone</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]   </span><span class="tok-c">-- fax</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]   </span><span class="tok-c">-- email</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example shows the occurrences being overridden in the referring node, to enable the specification for 'phone' to be re-used, but with a different occurrences constraint.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...}</span><span class="tok-w">   </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                  </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]      </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...}</span><span class="tok-w">   </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                  </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]      </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_paths_and_proxy_objects"><a class="anchor" href="#_paths_and_proxy_objects"></a>4.3.8.1. Paths and Proxy Objects</h5>
<div class="paragraph">
<p>In forming paths through the proxy and to nodes below the target, two cases can be identified:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the proxy object is a sibling of the target object, the proxy object node identifier is used in paths, and the node id of the target object is not;</p>
</li>
<li>
<p>otherwise, paths are formed using the identifier from the proxy target object.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_external_references"><a class="anchor" href="#_external_references"></a>4.3.9. External References</h4>
<div class="paragraph">
<p>Another kind of reference in an archetype is to another archetype. There are two ways this can be done: using a direct reference, and using an archetype 'slot'. The first is used when the need is to refer to one specific archetype (or to a template from another template), while the second is a constraint that allows for various archetypes matching specified criteria to be used. The slot concept is described in the next section.</p>
</div>
<div class="paragraph principle">
<p>An external reference defines a fixed compositional connection between two archetypes.</p>
</div>
<div class="paragraph">
<p>Direct references, or external references as they will be denoted here occur for two main reasons: re-use and templating. In the first case, an archetype has originally been built using inline constraints when it is discovered that another archetype contains the same or very similar inline constraints at a similar point. As would be normal in software design, a refactoring exercise is conducted that results in the common part being created as its own, new archetype, and both original archetypes 'referring' to it. They do this using an external reference, which has syntax of the form:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>    use_archetype TYPE[atNNNN, archetype_id] &lt;occurrences constraint&gt;</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>    use_archetype TYPE[idN, archetype_id] &lt;occurrences constraint&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the <code>archetype_id</code> is included with the usual archetype node identifier (at-code/id-code). The usual occurrence constraints can be applied at the end.</p>
</div>
<div class="paragraph">
<p>The following example shows sections of two parent archetypes both referring to the same child archetype. The first section is from an openEHR <code>INSTRUCTION</code> archetype to do with a medication order.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                       </span><span class="tok-c">-- Medication order</span>
<span class="tok-w">        </span><span class="tok-nc">activities</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ACTIVITY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                  </span><span class="tok-c">-- Medication activity</span>
<span class="tok-w">                </span><span class="tok-nc">action_archetype_id</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-ACTION\.medication\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                       </span><span class="tok-c">-- Medication order</span>
<span class="tok-w">        </span><span class="tok-nc">activities</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ACTIVITY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                  </span><span class="tok-c">-- Medication activity</span>
<span class="tok-w">                </span><span class="tok-nc">action_archetype_id</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-ACTION\.medication\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This section is from an openEHR <code>ACTION</code> archetype defining medication administration actions.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ACTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- Medication action</span>
<span class="tok-w">        </span><span class="tok-nc">ism_transition</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ISM_TRANSITION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-c">-- ...</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ACTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- Medication action</span>
<span class="tok-w">        </span><span class="tok-nc">ism_transition</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ISM_TRANSITION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-c">-- ...</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each of these archetypes refers to the openEHR <code>ITEM_TREE</code> archetype <code>openEHR-EHR-ITEM_TREE.medication.v1</code> , which is a normal archetype describing medication.</p>
</div>
<div class="paragraph">
<p>Following the standard object-oriented semantics of type substitutability, and also the ontological subsumption notion, specialisations of the referenced archetype (including templates) are also valid substitutions at design or runtime. At design time, this takes the form of a redefinition, e.g.:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0002.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.vaccine.v1</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">use_archetype </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id3.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ITEM_TREE.vaccine.v1</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where the 'vaccine' archetype is a specialisation of the 'medication' archetype. Redefinitions of this kind are described in more detail in <a href="#_external_reference_redefinition">Section 9.5.7</a>.</p>
</div>
<div class="paragraph">
<p>External references can of course also be defined under container attributes.</p>
</div>
<div class="paragraph">
<p>The second use of external references is typically in templates, to specify an archetype or sub-template of a template for an attribute where no slot has been defined. This use is described in <a href="#_unconstrained_attributes">Section 9.5.9</a>.</p>
</div>
<div class="sect4">
<h5 id="_paths_2"><a class="anchor" href="#_paths_2"></a>4.3.9.1. Paths</h5>
<div class="paragraph">
<p>Paths that terminate in external reference nodes in source-form archetypes will include only the at-codes (id-codes), as in the following examples:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">activities</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span>
<span class="tok-p">    /</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">activities</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span>
<span class="tok-p">    /</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, in flattened archetypes, the corresponding paths will include the archetype identifier(s) rather than the at-codes (id-codes), and may continue down through the structure of the included archetypes, as in the following example.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">activities</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]/</span><span class="tok-err">...</span>
<span class="tok-p">    /</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]/</span><span class="tok-err">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">activities</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]/</span><span class="tok-err">...</span>
<span class="tok-p">    /</span><span class="tok-nc">description</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-ITEM_TREE.medication.v1</span><span class="tok-p">]/</span><span class="tok-err">...</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_archetype_slots"><a class="anchor" href="#_archetype_slots"></a>4.3.10. Archetype Slots</h4>
<div class="paragraph">
<p>At any point in a cADL definition, a constraint can be defined that allows other archetypes to be used, rather than defining the desired constraints inline. This is known as an archetype 'slot', i.e. a connection point whose allowable 'fillers' are constrained by a set of statements, written in the <a href="https://specifications.openehr.org/releases/LANG/latest/EL.html" target="_blank" rel="noopener">openEHR Expression Language</a>.</p>
</div>
<div class="paragraph principle">
<p>An archetype slot defines a constrained compositional chaining point in an archetype at which other archetypes can be inserted, if they are in the set defined by the slot constraint.</p>
</div>
<div class="paragraph">
<p>An archetype slot is introduced with the keyword <code>allow_archetype</code> and defined in terms of two lists of assertion statements defining which archetypes are allowed and/or which are excluded from filling that slot, introduced with the keywords <code>include</code> and <code>exclude</code> , respectively. The following example illustrates the general form of an archetype slot.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-c">-- constraints for inclusion</span>
<span class="tok-w">        </span><span class="tok-kt">exclude</span>
<span class="tok-w">            </span><span class="tok-c">-- constraints for exclusion</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-c">-- constraints for inclusion</span>
<span class="tok-w">        </span><span class="tok-kt">exclude</span>
<span class="tok-w">            </span><span class="tok-c">-- constraints for exclusion</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A slot constraint evaluates to a set of archetype identifiers from whatever is considered in the current model environment to be the total available set of archetypes.</p>
</div>
<div class="paragraph">
<p>The simplest possible slot has no includes or excludes, and effectively imposes no constraint. However, it is allowed in order to enable authoring tools to create a slot whose actual constraint definition will be defined at a later point in time.</p>
</div>
<div class="paragraph">
<p>A slot is designed to be 'filled', i.e. to have one of the allowed archetypes chosen for use. This is done in a child archetype, almost always a template. A slot can also be 'closed', meaning no further fillers can be added.</p>
</div>
<div class="paragraph">
<p>The actual specification of slot fillers, and also the 'closing' of slots is done in specialised archetypes, and is described in <a href="#_slot_filling_and_redefinition">Section 9.5.8</a>, in the chapter on specialisation.</p>
</div>
<div class="sect4">
<h5 id="_formal_semantics_of_include_and_exclude_constraints"><a class="anchor" href="#_formal_semantics_of_include_and_exclude_constraints"></a>4.3.10.1. Formal Semantics of include and exclude Constraints</h5>
<div class="paragraph">
<p>The semantics of the <code>include</code> and <code>exclude</code> lists are somewhat subtle. They are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The meaning of the 'set of all archetypes' in any given environment is evaluable (and evaluated) to a finite set consisting of all archetypes available within the current archetype Library, not some notional virtual / global set of archetypes, or theoretical possible set.</p>
</li>
<li>
<p>Either the <code>include</code> or <code>exclude</code> constraint, but not both, may be 'substantive', i.e. define a particular set of archetypes that would be matched within a given slot, or 'open', i.e. matching all possible archetypes.</p>
</li>
<li>
<p>A slot constraint may consist of a single <code>include</code> or <code>exclude</code> constraint, or of an <code>include</code> / <code>exclude</code> pair.</p>
</li>
<li>
<p>If an <code>include</code> or <code>exclude</code> constraint is present on its own, it is understood as a recommendation, i.e. it does not constitute a formal constraint for matching or exclusion, but tools and applications may use the recommended match set in an intelligent way. The result set for such an <code>include</code> or <code>exclude</code> is the whole current archetype set.</p>
</li>
<li>
<p>If a substantive <code>include</code> or <code>exclude</code> constraint is present with a corresponding open <code>exclude</code> or <code>include</code> , respectively, the substantive constraint is considered formally binding.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The meaning of the slot constraint overall is that only archetypes matching the <code>include</code> constraint are allowed, and no others. The same logic applies in the reverse sense when the <code>exclude</code> constraint is substantive.</p>
</div>
</div>
<div class="sect4">
<h5 id="_slots_based_on_lexical_archetype_identifiers"><a class="anchor" href="#_slots_based_on_lexical_archetype_identifiers"></a>4.3.10.2. Slots based on Lexical Archetype Identifiers</h5>
<div class="paragraph">
<p>In this kind of slot constraint, the core expression type is of the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-\.SECTION\..*\..*/</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code><em>archetype_id/value</em></code> stands for the literal String value of the archetype identifier, and the regular expression is recognised as occurring between two slash delimiters (//).</p>
</div>
<div class="paragraph">
<p>The following example shows how the "Objective" <code>SECTION</code> in a problem/SOAP headings archetype defines two slots, indicating which <code>OBSERVATION</code> and <code>SECTION</code> archetypes are allowed and excluded under the <code><em>items</em></code> property.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- objective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-kt">exclude</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-SECTION\.patient_details\..+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- objective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-kt">exclude</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-SECTION\.patient_details\..+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, every constraint inside the block starting on an <code>allow_archetype</code> line contains constraints that must be met by archetypes in order to fill the slot. In the examples above, the constraints are in the form of regular expressions on archetype identifiers. In cADL, the PERL regular expression syntax is assumed.</p>
</div>
<div class="paragraph">
<p>There are two ways in which <code><em>archetype_id</em></code> regular expressions patterns can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as a pattern against which to test a particular archetype identifier being proposed for that slot;</p>
</li>
<li>
<p>as a pattern to use against a population of archetypes (e.g. all archetypes in a particular repository) in order to generate a list of all possible archetypes for filling the slot.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Due to the second use, it is required that the regular expression pattern always cover a full archetype identifier rather than only sub-parts. As a consequence, a 'meta-pattern' can be defined to check <code><em>archetype_id</em></code> regular expressions for validity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    ^.+-.+-.+\..*\..+$</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because identifier matching is an inherently lexical operation, subtypes of mentioned types are not matched unless explicitly stated. Consider the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-ENTRY..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-ENTRY..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The intention is to allow any kind of <code>ENTRY</code> , but the above constraint won&#8217;t have the desired effect, because the pattern <code>openEHR-EHR-ENTRY</code> is unlikely to match any actual archetypes. Instead the following kind of constraint should be used:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\..+\.v1|openEHR-EHR-OBSERVATION\..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\..+\.v1|openEHR-EHR-OBSERVATION\..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above would allow any <code>EVALUATION</code> and any <code>OBSERVATION</code> archetypes to be used in the slot. Note that since no exclude clause was used, the above slot definition constitutes a recommendation. To make it a hard constraint, the following would be needed:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\..+\.v1|openEHR-EHR-OBSERVATION\..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-kt">exclude</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- any kind of ENTRY</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\..+\.v1|openEHR-EHR-OBSERVATION\..+\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-kt">exclude</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_slots_based_on_other_constraints"><a class="anchor" href="#_slots_based_on_other_constraints"></a>4.3.10.3. Slots based on other Constraints</h5>
<div class="paragraph">
<p>Other constraints are possible as well, including that the allowed archetype must contain a certain keyword, or a certain path. The latter allows archetypes to be linked together on the basis of content. For example, under a "genetic relatives" heading in a Family History Organiser archetype, the following slot constraint might be used:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION.family_history.v1/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-p"> </span><span class="tok-o">-&gt;</span>
<span class="tok-w">                </span><span class="tok-err"></span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-err">)</span><span class="tok-p"> </span><span class="tok-c">-- self</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">archetype_id</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION.family_history.v1/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-p"> </span><span class="tok-o">-&gt;</span>
<span class="tok-w">                </span><span class="tok-err"></span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-err">)</span><span class="tok-p"> </span><span class="tok-c">-- self</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This says that the slot allows archetypes on the <code>EVALUATION</code> class, which either have as their concept 'family_history' or, if there is a constraint on the subject relationship, then it may not include the code <code>[openehr::0]</code> (the openEHR term for "self") - i.e. it must be an archetype designed for family members rather than the subject of care his/herself.</p>
</div>
</div>
<div class="sect4">
<h5 id="_slot_filling"><a class="anchor" href="#_slot_filling"></a>4.3.10.4. Slot-filling</h5>
<div class="paragraph">
<p>Slots are 'filled' in specialised archetypes or templates by the use of use_archetype statements, i.e. the same construct as for an external reference described above. The typical form of a filled slot is as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.clin_synopsis.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.clin_synopsis.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In ADL, slot-filling is considered a kind of specialisation of a slot, which enables slots to be filled by the same mechanism as any other kind of specialisation found in a child archetype. Slot-filling and other forms of slot redefinition are described in more detail in <a href="#_slot_filling_and_redefinition">Section 9.5.8</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mixed_structures"><a class="anchor" href="#_mixed_structures"></a>4.3.11. Mixed Structures</h4>
<div class="paragraph">
<p>Four types of structure representing constraints on reference model objects have been presented so far:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">complex object structures</dt>
<dd>
<p>any node introduced by a type name and followed by {} containing constraints on attributes;</p>
</dd>
<dt class="hdlist1">internal references</dt>
<dd>
<p>any node introduced by the keyword <code>use_node</code> , followed by a type name; such nodes indicate re-use of a complex object constraint that has already been expressed elsewhere in the archetype;</p>
</dd>
<dt class="hdlist1">archetype slots</dt>
<dd>
<p>any node introduced by the keyword <code>allow_archetype</code> , followed by a type name; such nodes indicate a complex object constraint which is expressed in some other archetype;</p>
</dd>
<dt class="hdlist1">value set constraints</dt>
<dd>
<p>any node whose constraint is of the form <code>[acN]</code> .</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Under any given attribute node, any combination of these object constraint types can co-exist, as in the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at19999</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at1011</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at1051</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id2000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">id1012</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">id1052</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id2007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we have a constraint on an attribute called <code><em>items</em></code> (of cardinality <code>0..*</code>), expressed as a series of possible constraints on objects of type <code>ENTRY</code>. The 1st, 4th and 7th are described inline; the 3rd, 5th and 6th are expressed in terms of internal references to other nodes earlier in the archetype, while the 2nd is an archetype slot, whose constraints are expressed in other archetypes matching the include/exclude constraints appearing between the braces of this node. Note also that the <code>ordered</code> keyword on the enclosing <code><em>items</em></code> node has been used to indicate that the list order is intended to be significant.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_second_order_constraints"><a class="anchor" href="#_second_order_constraints"></a>4.4. Second-order Constraints</h3>
<div class="sect3">
<h4 id="_tuple_constraints"><a class="anchor" href="#_tuple_constraints"></a>4.4.1. Tuple Constraints</h4>
<div class="paragraph">
<p>In realistic data, it is not uncommon to need to constrain multiple object properties that co-vary in a specific way. A simple example is the need to state range constraints on a temperature, represented as an openEHR <code>DV_QUANTITY</code> type, for both Centigrade and Fahrenheit scales. The default way to do this in ADL is as follows (the <code>DV_QUANTITY</code> class has <code><em>property</em></code>, <code><em>units</em></code> and <code><em>magnitude</em></code> attributes):</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- basic form of constraint on a Quantity type, allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at9013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at9014</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- basic form of constraint on a Quantity type, allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id15</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, this is verbose, and does not clearly convey the dependence of <code><em>units</em></code> and <code><em>magnitude</em></code> on each other. What we logically want to do is to state a single constraint on a <code>DV_QUANTITY</code> that sets the <code><em>magnitude</em></code> range constraint dependent on the <code><em>units</em></code> constraint.</p>
</div>
<div class="paragraph">
<p>The covarying requirement could be met using assertions like the following in the <code>rules</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p">/</span><span class="tok-nc">units</span><span class="tok-p"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|}</span>
<span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p">/</span><span class="tok-nc">units</span><span class="tok-p"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-w"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, this seems obscure for what is logically a very simple kind of constraint.</p>
</div>
<div class="paragraph">
<p>A generic solution that can be used in the main <code>definition</code> section involves treating co-varying properties formally as tuples, and providing syntax to express constraints on tuples. The following syntax achieves this:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Tuple form of constraint on a Quantity type</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-nc">units</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">magnitude</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|}]</span><span class="tok-w"> </span><span class="tok-p">,</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}]</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Tuple form of constraint on a Quantity type</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-nc">units</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">magnitude</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|}]</span><span class="tok-w"> </span><span class="tok-p">,</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}]</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above defines constraints on <code><em>units</em></code> and <code><em>magnitude</em></code> together, as tuples such as <code>[{"deg F"}, {|32.0..212.0|}]</code> .</p>
</div>
<div class="paragraph">
<p>The brackets surrounding each leaf level constraint are needed because although such constraints are typically atomic, as above, they may also take other standard ADL forms such as a list of strings, list of integers etc. In the latter case, the ',' characters from such lists will be conflated with the ',' separator of the distinct constraints in the tuple. Use of <code>{}</code> is also logically justified: each such entity is indeed a constraint in the ADL sense, and all ADL constraints are delimited by <code>{}</code>.</p>
</div>
<div class="paragraph">
<p>The tuple form has the advantage of expressing the additional constraint that only <em>corresponding</em> <code><em>units</em></code> and <code><em>magnitude</em></code> leaf level constraints can occur together, while other combinations like <code>"deg F"</code> and <code>|0.0..100.0|</code> would be illegal.</p>
</div>
<div class="paragraph">
<p>Another way to attempt to represent the effect of covarying constraints might be as follows, using lists of primitive values as shown below. However, there is nothing in these constraints that forces the correct associations between the <code><em>units</em></code> and <code><em>magnitude</em></code> constraints, preventing wrong combinations.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- List form of constraint on a Quantity type, also allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- List form of constraint on a Quantity type, also allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">openehr</span><span class="tok-p">::</span><span class="tok-nd">151</span><span class="tok-p">|</span><span class="tok-s">temperature</span><span class="tok-p">|]}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;deg F&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;deg C&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">32.0</span><span class="tok-p">..</span><span class="tok-mf">212.0</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In the openEHR ADL 1.4 Archetype Profile, a custom constrainer type <code>C_DV_QUANTITY</code> was used to provide the above constraint. However, this is specific to the Reference Model type, and does not solve similar constraints occurring in other types. This type and also the <code>C_DV_ORDINAL</code> type have been removed from ADL 2 altogether.</p>
</div>
<div class="paragraph">
<p>This same syntax will work for tuples of 3 or more co-varying properties. It does involve some extra work for compiler implementers, but this only needs to be performed once to support any use of tuple constraints, regardless of Reference Model type.</p>
</div>
<div class="paragraph">
<p>A constraint on the openEHR <code>DV_ORDINAL</code> type provides another example of the utility of ADL tuples. First, a typical ordinal constraint (a scale of +, ++, +++) with  standard ADL:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Basic form of constraint on an Ordinal type, allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ordinal_attr</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- +</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- ++</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">at9003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">}</span><span class="tok-w">         </span><span class="tok-c">-- +++</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Basic form of constraint on an Ordinal type, allowing unintended combinations</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ordinal_attr</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- +</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- ++</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">symbol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">}</span><span class="tok-w">         </span><span class="tok-c">-- +++</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By the use of tuple constraint, almost the same thing can be achieved much more efficiently. We can write:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Tuple form of constraint on an Ordinal type</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ordinal_attr</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">at9006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-nc">value</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">symbol</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">0</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at1</span><span class="tok-p">]}],</span><span class="tok-w">           </span><span class="tok-c">-- +</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">1</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at2</span><span class="tok-p">]}],</span><span class="tok-w">           </span><span class="tok-c">-- ++</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">2</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at3</span><span class="tok-p">]}]</span><span class="tok-w">            </span><span class="tok-c">-- +++</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Tuple form of constraint on an Ordinal type</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ordinal_attr</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_ORDINAL</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-nc">value</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">symbol</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">0</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at1</span><span class="tok-p">]}],</span><span class="tok-w">           </span><span class="tok-c">-- +</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">1</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at2</span><span class="tok-p">]}],</span><span class="tok-w">           </span><span class="tok-c">-- ++</span>
<span class="tok-w">                </span><span class="tok-p">[{</span><span class="tok-mi">2</span><span class="tok-p">},</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at3</span><span class="tok-p">]}]</span><span class="tok-w">            </span><span class="tok-c">-- +++</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph deprecated">
<p>Deprecated: in the openEHR profiled version of ADL 1.4, a custom syntax was used, below, which is now replaced by the above generic form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    --
    -- ADL 1.4
    --
    ordinal_attr  {
        0|[local::at1],       -- +
        1|[local::at2],       -- ++
        2|[local::at3]        -- +++
    }</pre>
</div>
</div>
<div class="paragraph deprecated">
<p>This hides the <code>DV_ORDINAL</code> type altogether, but as for the <code>C_DV_QUANTITY</code> example above, it was a custom solution.</p>
</div>
<div class="sect4">
<h5 id="_paths_in_tuple_structures"><a class="anchor" href="#_paths_in_tuple_structures"></a>4.4.1.1. Paths in Tuple structures</h5>
<div class="paragraph">
<p>Unlike the basic form primitive constraint, tuple constraints introduce multiplicity, and as a consequence, paths to ther terminal objects are no longer unique. Thus, the paths <code>value[at9007]/magnitude</code> (<code>value[id4]/magnitude</code>) in the Quantity example and <code>ordinal_attr[at9003]/value</code> (<code>ordinal_attr[id3]/value</code>) in the ordinal example could each refer to more than one primitive object.</p>
</div>
<div class="paragraph">
<p>This solved by allowing Xpath-style child numbering predicates in paths starting at 1, as shown below.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">value</span><span class="tok-p">[</span>9007<span class="tok-p">]/</span><span class="tok-nc">magnitude</span><span class="tok-p">[</span>1<span class="tok-p">]     </span><span class="tok-c">-- refer to the constraint {|32.0..212.0|}</span>
<span class="tok-nc">value</span><span class="tok-p">[</span>9007<span class="tok-p">]/</span><span class="tok-nc">magnitude</span><span class="tok-p">[</span>2<span class="tok-p">]     </span><span class="tok-c">-- refer to the constraint {|0.0..100.0|}</span>

<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">at9006</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>1<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {0}</span>
<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">at9006</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>2<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {1}</span>
<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">at9006</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>3<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {2}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">magnitude</span><span class="tok-p">[</span>1<span class="tok-p">]     </span><span class="tok-c">-- refer to the constraint {|32.0..212.0|}</span>
<span class="tok-nc">value</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">magnitude</span><span class="tok-p">[</span>2<span class="tok-p">]     </span><span class="tok-c">-- refer to the constraint {|0.0..100.0|}</span>

<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>1<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {0}</span>
<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>2<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {1}</span>
<span class="tok-nc">ordinal_attr</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p">[</span>3<span class="tok-p">]  </span><span class="tok-c">-- refer to the constraint {2}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_group_constraints"><a class="anchor" href="#_group_constraints"></a>4.4.2. Group Constraints</h4>
<div class="paragraph">
<p>Within a container attribute, any number of object constraints may be defined. The cardinality and occurrences constraints described above show how to control respectively, the overall container contents, and the occurrence of any particular object constraint within data. However, sometimes finer control is needed on repetition and grouping of members within the container. This can be achieved by the <code>group</code> construct, which provides an interior block where a subset of the overall container can be treated as a sub-group. The following example shows a typical used of the group construct.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">              </span><span class="tok-c">-- Investigation type</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- reason</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Methodology</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- as Text</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Coded</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- structured</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0011</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">              </span><span class="tok-c">-- Investigation type</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- reason</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Methodology</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- as Text</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Coded</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- structured</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id12</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
although block-style indenting is used to express group blocks, the <code>group</code> constraint is not itself a structural object node, only a pure grouping mechanism.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above, the group is used to state a logical choice of methodology representations, each defined by one of the three constraints within the group. The <code>group</code> construct includes both <code>cardinality</code> and <code>occurrences</code> qualifier constraints. The former indicates the size and ordering of the group, in the same way as a cardinality constraint does for the overall contents of a container attribute. The latter defines the repeatability of the group. If the group <code>occurrences</code> upper limit is above 1, it means that the sub-group may repeat, with each repetition respecting the order and size defined by the group cardinality.</p>
</div>
<div class="paragraph principle">
<p>A <code>group</code> constraint may be used to delimit a subset of objects within the total list of object constraints defined within a container attribute. A cardinality must be stated, defining size, ordering and uniqueness of the subset. An occurrences defining the repeatability of the subset must also be stated. Group constraints can be nested.</p>
</div>
<div class="paragraph">
<p>The use of group cardinality and occurrences constraints, coupled with the occurrences constraints on each group member provide a means of specifying a number of logical constraint types found in other formalisms, including XML, as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Logical constraint</th>
<th class="tableblock halign-left valign-top">Group<br>
                             cardinality</th>
<th class="tableblock halign-left valign-top">Group<br>
                                                     occurrences</th>
<th class="tableblock halign-left valign-top">Item<br>
                                                                     occurrences</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 of N choice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper = 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 of N choice, repeating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">N of M choice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N..N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper = 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">N of M choice, repeating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N..N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequence, repeating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1, ordered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sub-group, repeating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1, unordered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upper &gt; 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">any</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Group blocks can be nested, enabling subsets of subsets to be defined, as illustrated below.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                </span><span class="tok-c">-- Investigation type</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">             </span><span class="tok-c">-- Investigation reason</span>
<span class="tok-w">        </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- pick any 2 &amp; repeat</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- at least one</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0011</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                </span><span class="tok-c">-- Investigation type</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">             </span><span class="tok-c">-- Investigation reason</span>
<span class="tok-w">        </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- pick any 2 &amp; repeat</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- at least one</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id12</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- (other details)</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For nested groups, the individual object nodes of the sub-group count <em>individually</em> towards the super-group&#8217;s cardinality, i.e. the group itself is not counted as a node. Thus, in the following example, any three nodes can be chosen from nodes <code>at0005</code> - <code>at0010</code> (<code>id6</code> - <code>id11</code>), with one or two of those nodes being from nodes <code>at0008</code> - <code>at0010</code> (<code>id9</code> - <code>id11</code>).</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">3</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- pick any 3 from id6-id11 &amp; repeat</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..2</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- pick 1-2 from id9 - id11</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">3</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- pick any 3 from id6-id11 &amp; repeat</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..2</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- pick 1-2 from id9 - id11</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_slots_and_grouping"><a class="anchor" href="#_slots_and_grouping"></a>4.4.2.1. Slots and Grouping</h5>
<div class="paragraph">
<p>The group constraint is often useful with a slot definition, in order to control the ordering and occurrences of items defined by other archetypes, within an overall container. Consider the example of data of the general structure: 'any number of problem and diagnosis Entries, followed by one plan and one or more treatment Entries'. An example of data following this structure would be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>EVALUATION</code> : problem #1</p>
</li>
<li>
<p><code>EVALUATION</code> : diagnosis #1</p>
</li>
<li>
<p><code>EVALUATION</code> : problem #2</p>
</li>
<li>
<p><code>EVALUATION</code> : problem #3</p>
</li>
<li>
<p><code>EVALUATION</code> : plan</p>
</li>
<li>
<p><code>INSTRUCTION</code> : medication #1</p>
</li>
<li>
<p><code>INSTRUCTION</code> : therapy #1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It might be expected that the slot constraints needed to define this are as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                           </span><span class="tok-c">-- Subjective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Problem</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem-diagnosis\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Plan</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.plan\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- Intervention</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-INSTRUCTION\.(medication_order|therapy)\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                           </span><span class="tok-c">-- Subjective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Problem</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem-diagnosis\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Plan</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.plan\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- Intervention</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-INSTRUCTION\.(medication_order|therapy)\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above says that the <code>SECTION.<em>items</em></code> attribute is an ordered list, and that its contents include multiple <code>EVALUATION</code> objects representing problem, diagnosis and plan, and also multiple <code>INSTRUCTION</code> objects representing interventions. The problem is now apparent. Each slot definition is set of possibilities, but we do not necessarily want to follow the slot ordering for the ordering of the archetypes chosen to fill the slots. To impose the required ordering and occurrences, we can use the group construct as follows.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                             </span><span class="tok-c">-- Subjective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-c">-- sub-group of any number of problems &amp; diagnoses</span>
<span class="tok-w">                </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">--Problem</span>
<span class="tok-w">                    </span><span class="tok-kt">include</span>
<span class="tok-w">                      </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">                    </span><span class="tok-kt">include</span>
<span class="tok-w">                      </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.diagnosis\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- Plan</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.plan\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">     </span><span class="tok-c">-- Intervention</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-INSTRUCTION\.(medication_order|therapy)\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                             </span><span class="tok-c">-- Subjective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">group cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-c">-- sub-group of any number of problems &amp; diagnoses</span>
<span class="tok-w">                </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">--Problem</span>
<span class="tok-w">                    </span><span class="tok-kt">include</span>
<span class="tok-w">                      </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.problem\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">                    </span><span class="tok-kt">include</span>
<span class="tok-w">                      </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.diagnosis\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- Plan</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-EVALUATION\.plan\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">INSTRUCTION</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">     </span><span class="tok-c">-- Intervention</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-INSTRUCTION\.(medication_order|therapy)\.v*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above has the desired result in data: a group of any number of problems and diagnoses, followed by a plan, followed by one or more medications or other therapies.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cADL_Constraints_Primitive_Types"><a class="anchor" href="#cADL_Constraints_Primitive_Types"></a>4.5. Constraints on Primitive Types</h3>
<div class="paragraph">
<p>ADL assumes the existence of various primitive types, as described in the <a href="https://specifications.openehr.org/releases/BASE/latest/foundation_types.html" target="_blank" rel="noopener">openEHR Foundation Types</a> specification. These include the usual built-in types of any programming language, as well as dates and times, and lists and intervals of primitive types. The following subsections describe how each of these is constrained.</p>
</div>
<div class="sect3">
<h4 id="_general_structure"><a class="anchor" href="#_general_structure"></a>4.5.1. General Structure</h4>
<div class="paragraph">
<p>At the leaf nodes in a cADL text, constraints can be expressed on the following primitive types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Boolean</code>;</p>
</li>
<li>
<p><code>Character</code>, <code>String</code>;</p>
</li>
<li>
<p><code>Integer</code>, <code>Real</code>;</p>
</li>
<li>
<p><code>Date</code>, <code>Time</code>, <code>Date_time</code>, <code>Duration</code>;</p>
</li>
<li>
<p><code>Terminology_code</code>;</p>
</li>
<li>
<p>lists and intervals of some of the above.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Since primitive objects constitute the terminal nodes in an archetype, constraints may constrain type, occurrences (rare), and value.</p>
</div>
<div class="paragraph">
<p>While constraints on complex types follow the rules described so far, constraints on attributes of primitive types in cADL may be expressed in a shorter form, without type names, and omitting one level of braces, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&lt;</span><span class="tok-nc">some_pattern</span><span class="tok-o">&gt;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>rather than:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PRIMITIVE_TYPE</span><span class="tok-p">[</span><span class="tok-nd">at9009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&lt;</span><span class="tok-nc">some_pattern</span><span class="tok-o">&gt;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PRIMITIVE_TYPE</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&lt;</span><span class="tok-nc">some_pattern</span><span class="tok-o">&gt;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is possible because the syntax patterns of all primitive type constraints are mutually distinguishable, i.e. the type can always be inferred from the syntax alone. Since all leaf attributes of all object models are of primitive types, or lists or sets of them, cADL archetypes using the brief form for primitive types are significantly less verbose overall, as well as being more directly comprehensible to human readers. Because the brief form omits an at-code (id-code), the at-code (id-code) for primitive object nodes is automatically set to a fixed value, defined in the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_overview" target="_blank" rel="noopener">AOM specification</a> as <code>Primitive_node_id</code>.</p>
</div>
<div class="paragraph">
<p>Although for the majority of primitive type constraints, the shortened form is the most convenient, there is one circumstance in which the regular syntax form is needed, which is when only the type is to be constrained, but not the value. This leads to a constraint of the following form:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PRIMITIVE_TYPE</span><span class="tok-p">[</span><span class="tok-nd">at9013</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">PRIMITIVE_TYPE</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This may occur because the attribute <code><em>some_attr</em></code> in the reference model is of a more general type, e.g. <code>Any</code>. The constraint may thus be to simply require a <code>String</code>, <code>Terminology_code</code> or other primitive type. In the regular form a valid at-code (id-code) must be supplied; this may be either a standard at-code, e.g. <code>at9013</code> (id-code, e.g. <code>id9</code>) or the <code>Primitive_node_id</code> value. If the former is used, any specialised archetype that adds a value constraint must use the regular form, as in the following example.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- in parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">at9013</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- in specialisation child</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">at9013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;match me&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- in parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- in specialisation child</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;match me&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>Primitive_node_id</code> is used, a specialisation may use the brief form, as in the following.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- in parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">at9017</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- in specialisation child</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;match me&quot;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- in parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">String</span><span class="tok-p">[</span><span class="tok-nd">id9999</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- in specialisation child</span>
<span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;match me&quot;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_assumed_values"><a class="anchor" href="#_assumed_values"></a>4.5.2. Assumed Values</h4>
<div class="paragraph">
<p>In an archetype containing optional data elements, an ability to define 'assumed' values is useful. For example, an archetype for 'blood pressure measurement' might include an optional data element describing the patient position, with choices 'lying', 'sitting' and 'standing'. Since this element is optional, data could be created according to the archetype that does not contain it. However, a blood pressure cannot be taken without the patient in some position, so clearly there is an implied value.</p>
</div>
<div class="paragraph">
<p>The archetype allows this to be explicitly stated so that all users/systems know what value to assume when optional items are not included in the data. Assumed values are definable on any primitive type, and are expressed after the constraint expression, by a semi-colon (';') followed by a value of the same type as that implied by the preceding part of the constraint. Example constraints containing assumed values are shown in the sections below.</p>
</div>
<div class="paragraph">
<p>If no assumed value is stated, no reliable assumption can be made by the receiver of the archetyped data about what the values of removed optional parts might be, from inspecting the archetype. However, this usually corresponds to a situation where the assumed value does not even need to be stated - the same value will be assumed by all users of this data, if its value is not transmitted. In most cases, if an element specified as optional in the archetype, data users only care about the value if it is actually present. The 'assumed value' concept is therefore not likely to be needed in most cases.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_boolean"><a class="anchor" href="#_constraints_on_boolean"></a>4.5.3. Constraints on Boolean</h4>
<div class="paragraph">
<p>Boolean runtime values can be constrained to be True, False, or either, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-l">False</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-l">False</span><span class="tok-p">}</span><span class="tok-w">         </span><span class="tok-c">-- with assumed value</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_character"><a class="anchor" href="#_constraints_on_character"></a>4.5.4. Constraints on Character</h4>
<div class="paragraph">
<p>Attribute values of type <code>Character</code> can be constrained in two ways: using a list of characters, and using a regular expression.</p>
</div>
<div class="sect4">
<h5 id="_list_of_characters"><a class="anchor" href="#_list_of_characters"></a>4.5.4.1. List of Characters</h5>
<div class="paragraph">
<p>The following examples show how a character value may be constrained using a list of fixed character values. Each character is enclosed in single quotes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sc">&#39;r&#39;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sc">&#39;r&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-sc">&#39;g&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-sc">&#39;b&#39;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_regular_expression"><a class="anchor" href="#_regular_expression"></a>4.5.4.2. Regular Expression</h5>
<div class="paragraph">
<p>Character values can also be constrained using a single-character regular expression character class, as per the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/[rgbcmyk]/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/[^\s\t\n]/</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only allowed elements of the regular expression syntax in character expressions are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any item from the Character Classes list above;</p>
</li>
<li>
<p>any item from the Special Character Classes list above;</p>
</li>
<li>
<p>an alternative expression whose parts are any item types, e.g. <code>'a'|'b'|[m-z]</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_string"><a class="anchor" href="#_constraints_on_string"></a>4.5.5. Constraints on String</h4>
<div class="paragraph">
<p>The value of an attribute of type <code>String</code> is constrained using a list of one or more Strings, each of which may be a fixed String, or a regular expression. In both cases, comparison to the constraint values is case-sensitive.</p>
</div>
<div class="paragraph">
<p>Although any mixture of fixed Strings and regular expressions may be used, the most common possibilities are a list of fixed Strings and a single regular expression.</p>
</div>
<div class="sect4">
<h5 id="_list_of_strings"><a class="anchor" href="#_list_of_strings"></a>4.5.5.1. List of Strings</h5>
<div class="paragraph">
<p>A String-valued attribute can be constrained by a list of strings (using the ODIN syntax for string lists), including the simple case of a single string. Examples are as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;kangaroo&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;kangaroo&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;wombat&quot;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first example constrains the runtime value of the <code><em>species</em></code> attribute of some object to take the value "platypus"; the second constrains it be either "platypus" or "kangaroo", and so on. <strong>In almost all cases, this kind of string constraint should be avoided</strong>, since it usually renders the body of the archetype language-dependent. Exceptions are proper names (e.g. "NHS", "Apgar"), product trade-names (but note even these are typically different in different language locales, even if the different names are not literally translations of each other). The preferred way of constraining string attributes in a language independent way is with value sets of terminology codes. See <a href="#cADL_Terminology_Constraints">Section 4.5.10</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_regular_expression_2"><a class="anchor" href="#_regular_expression_2"></a>4.5.5.2. Regular Expression</h5>
<div class="paragraph">
<p>The second way of constraining strings is with regular expressions, a widely used syntax for expressing patterns for matching strings. The regular expression syntax used in cADL is a proper subset of that used in the Perl language (see <a href="https://perldoc.perl.org/perlre.html" target="_blank" rel="noopener">the specification of the regular expression language of Perl</a>). It is specified as a constraint using either <code>//</code> or <code>^^</code> delimiters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">string_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/regular expression/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">string_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">^regular expression^</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, the following two patterns are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/km\/h|mi\/h/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">^km/h|mi/h^</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The rules for including special characters within strings are described in <a href="#_file_encoding_and_character_quoting">Section 3</a>.</p>
</div>
<div class="paragraph tbd">
<p>TBD: there is an argument for only allowing a single String value rather than a list, where the value is aways a regex since <code>{"platypus", "kangaroo", "wombat"}</code> can be expressed as <code>{/platypus|kangaroo|wombat/}</code>. See also AOM spec.</p>
</div>
<div class="paragraph">
<p>The regular expression patterns supported in cADL are as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 42.8571%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="3">Character Class</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any single character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>&#8230;&#8203;</code> matches any 3 characters;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[xyz]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any of the characters in the set <code>xyz</code> (case-sensitive).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[0-9]</code> matches any string containing a single decimal digit;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[a-m]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any of the characters in the set of characters formed by the continuous range from <code>a</code> to <code>m</code> (case-sensitive).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[0-9]</code> matches any single character string containing a single decimal digit, <code>[S-Z]</code> matches any single character in the range <code>S</code> - <code>Z</code> ;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[^a-m]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any character except those in the set of characters formed by the continuous range from <code>a</code> to <code>m</code> .</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[^0-9]</code> matches any single character string as long as it does not contain a single decimal digit;</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Grouping</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parentheses are used to group items; any pattern appearing within parentheses is treated as an atomic item for the purposes of the occurrences operators.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>([1-9][0-9])</code> matches any 2-digit number.</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Occurrences</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 0 or more of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>.*</code> matches any string; <code>[a-z][a-z0-9]*</code> matches any alphanumeric string starting with a letter;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 1 or more occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>a[^\s]+</code> matches any string starting with 'a', followed by at least one further non-whitespace character;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 0 or 1 occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>ab?</code> matches the strings <code>"a"</code> and <code>"ab"</code> ;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m,n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match m to n occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>ab{1,3}</code> matches the strings <code>"ab"</code> and <code>"abb"</code> and <code>"abbb"</code> ; <code>[a-z]{1,3}</code> matches all lower-case alphabetic strings of one to three characters in length;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m,}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match at least m occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{,n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match at most n occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match exactly m occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Special Character Classes</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\d</code> , <code>\D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match a decimal digit character; match a non-digit character;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\s</code> , <code>\S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match a whitespace character; match a non-whitespace character;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Alternatives</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern1|pattern2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match either pattern1 or pattern2.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>lying|sitting|standing</code> matches any of the words <code>"lying"</code> , <code>"sitting"</code> and <code>"standing"</code> .</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A similar warning as for a list of strings should be noted for the use of regular expressions to constrain strings: they should be limited to non-linguistically dependent patterns, such as proper and scientific names. The use of regular expressions for constraints on normal words will render an archetype linguistically dependent, and potentially unusable by others.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_ordered_types"><a class="anchor" href="#_constraints_on_ordered_types"></a>4.5.6. Constraints on Ordered Types</h4>
<div class="paragraph">
<p>Of the primitive types defined in the <a href="https://specifications.openehr.org/releases/BASE/latest/foundation_types.html" target="_blank" rel="noopener">openEHR Foundation Types</a>, some inherit (at least notionally) from the abstract type <code>Ordered</code>, including <code>Integer</code>, <code>Real</code>, and the Date/Time types. Constraints on all these types follow a constraint type of <code>List&lt;Interval&lt;T:Ordered&gt;&gt;</code>, i.e. a <code>List</code> of <code>Intervals</code>. Since the <code>Interval&lt;T&gt;</code> type in openEHR includes a descendant <code>Point_interval&lt;T&gt;</code> that can represent a degenerate interval of the form <code>{N..N}</code>, i.e. effectively a single value, this constraint type can represent many patterns of constraint, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>single value e.g. <code>{3}</code>;</p>
</li>
<li>
<p>list of values e.g. <code>{3, 4, 5}</code>;</p>
</li>
<li>
<p>single interval e.g. <code>{|0..10|}</code>;</p>
</li>
<li>
<p>list of intervals e.g. <code>{|0..10|, |60..90|, |&gt;500|}</code>;</p>
</li>
<li>
<p>any combination of values and intervals, e.g. <code>{5, |10..100|, 150, |200..400|, 1000}</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional 'pattern' constraints are available on the Date/Time types.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_integer"><a class="anchor" href="#_constraints_on_integer"></a>4.5.7. Constraints on Integer</h4>
<div class="paragraph">
<p>The value of an attribute of type <code>Integer</code> is constrained using a list of one or more integer values or intervals. The most common possibilities are a list of single integers, and a single interval, but multiple intervals and or single values are possible as well.</p>
</div>
<div class="sect4">
<h5 id="_list_of_integers"><a class="anchor" href="#_list_of_integers"></a>4.5.7.1. List of Integers</h5>
<div class="paragraph">
<p>Lists of integers expressed in the syntax from ODIN can be used as a constraint, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1000</span><span class="tok-p">}</span><span class="tok-w">       </span><span class="tok-c">-- fixed value of 1000</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-mi">0</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">8</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- any of 0, 5 or 8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first constraint requires the attribute <code><em>length</em></code> to be 1000, while the second limits the value of <code><em>magnitude</em></code> to be 0, 5, or 8 only. A list may contain a single integer only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- matches 0</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_interval_of_integer"><a class="anchor" href="#_interval_of_integer"></a>4.5.7.2. Interval of Integer</h5>
<div class="paragraph">
<p>Integer intervals are expressed using the interval syntax from ODIN (described in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">openEHR ODIN specification</a>. Examples of 2-sided intervals include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- point interval of 1000 (=fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">950</span><span class="tok-p">..</span><span class="tok-mi">1050</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 950 - 1050</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- allow 0 - 1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..&lt;</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                   </span><span class="tok-c">-- allow 0&gt;= x &lt;1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;</span><span class="tok-mi">0</span><span class="tok-p">..&lt;</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 0&gt; x &lt;1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">100</span><span class="tok-p">+/-</span><span class="tok-mi">5</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- allow 100 +/- 5, i.e. 95 - 105</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples of one-sided intervals include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&lt;</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow up to 9</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow 11 or more</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&lt;=</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- allow up to 10</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;=</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- allow 10 or more</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;=</span><span class="tok-mi">10</span><span class="tok-p">|;</span><span class="tok-mi">5</span><span class="tok-p">}</span><span class="tok-w">                     </span><span class="tok-c">-- allow 10 or more; assumed value = 5</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_more_complex_integer_constraints"><a class="anchor" href="#_more_complex_integer_constraints"></a>4.5.7.3. More Complex Integer Constraints</h5>
<div class="paragraph">
<p>There may be applications for which the full possibilities of the Integer value constraint need to be exploited. The following provides an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-mi">5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mi">10</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-mi">150</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mi">200</span><span class="tok-p">..</span><span class="tok-mi">400</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-mi">1000</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In such cases, all of the values and ranges should be mutually exclusive.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_real"><a class="anchor" href="#_constraints_on_real"></a>4.5.8. Constraints on Real</h4>
<div class="paragraph">
<p>Constraints on attributes of type <code>Real</code> follow the same syntax as for Integers, in both list and interval forms. The only difference is that the real number values used in the constraints are indicated by the use of the decimal point and at least one succeeding digit, which may be 0. Typical examples are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mf">5.5</span><span class="tok-p">}</span><span class="tok-w">                             </span><span class="tok-c">-- list of one (fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">5.5</span><span class="tok-p">|}</span><span class="tok-w">                           </span><span class="tok-c">-- point interval (=fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">5.5</span><span class="tok-p">..</span><span class="tok-mf">6.0</span><span class="tok-p">|}</span><span class="tok-w">                      </span><span class="tok-c">-- interval</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mf">5.5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mf">6.0</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mf">6.5</span><span class="tok-p">}</span><span class="tok-w">                   </span><span class="tok-c">-- list</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..&lt;</span><span class="tok-mf">1000.0</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 0&gt;= x &lt;1000.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&lt;</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                         </span><span class="tok-c">-- allow anything less than 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                         </span><span class="tok-c">-- allow greater than 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&lt;=</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow up to 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow 10.0 or more</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">80.0</span><span class="tok-p">+/-</span><span class="tok-mf">12.0</span><span class="tok-p">|}</span><span class="tok-w">                   </span><span class="tok-c">-- allow 80 +/- 12</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_dates_times_and_durations"><a class="anchor" href="#_constraints_on_dates_times_and_durations"></a>4.5.9. Constraints on Dates, Times and Durations</h4>
<div class="paragraph">
<p>Attributes of type <code>Date</code>, <code>Time</code>, <code>Date_time</code> and <code>Duration</code> (or of differently-named primitive types with the same meaning) may all be constrained in either of two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in terms of values, using a list of ISO 8601 values or value intervals, in the same manner as for <code>Integer</code> and <code>Real</code>; and</p>
</li>
<li>
<p>using patterns based on the ISO 8601 value syntax.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first method allows temporal values to be constrained to actual date, time etc values, while the second allows values to be constrained on the basis of which parts of the date, time etc. are present or missing, regardless of value. The pattern method is described first, since patterns can also be used in lists and intervals.</p>
</div>
<div class="sect4">
<h5 id="_date_time_and_datetime"><a class="anchor" href="#_date_time_and_datetime"></a>4.5.9.1. Date, Time and Date/Time</h5>
<div class="sect5">
<h6 id="date_time_constraint_patterns"><a class="anchor" href="#date_time_constraint_patterns"></a>Patterns</h6>
<div class="paragraph">
<p>Dates, times, and date/times (i.e. timestamps), can be constrained using patterns based on the <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener">ISO 8601 date/time syntax</a>, which indicate which parts of the date or time must be supplied. A constraint pattern is formed from the abstract pattern <code>yyyy-mm-ddThh:mm:ss</code> (itself formed by translating each field of an ISO 8601 date/time into a letter representing its type), with either <code>?</code> (meaning optional) or <code>X</code> (not allowed) characters substituted in appropriate places. Timezone may be indicated as being <em>required</em> by the addition of a patterns such as <code>+hh:mm</code>, <code>+hhmm</code>, and <code>-hh</code>. The <code>Z</code> (UTC, i.e. equivalent of <code>+0000</code>) timezone modifier can always be used when any such pattern is specified (see <a href="#timezone_constraints">table below</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
there is no way to state that timezone information be <em>prohibited</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The syntax of legal patterns is given by Antlr4 lexical rules <code>DATE_CONSTRAINT_PATTERN</code>, <code>TIME_CONSTRAINT_PATTERN</code> and <code>DATE_TIME_CONSTRAINT_PATTERN</code> shown below in the <a href="#_base_lexer">Base Lexer syntax section</a>.</p>
</div>
<div class="paragraph">
<p>All expressions generated by these patterns must also satisfy the validity rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>where <code>??</code> appears in a field, only <code>??</code> or <code>XX</code> can appear in fields to the right</p>
</li>
<li>
<p>where <code>XX</code> appears in a field, only <code>XX</code> can appear in fields to the right</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table shows the valid patterns that can be used, and the types implied by each pattern.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 30%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Implied Type</th>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-dd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full date must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional day;<br>
 e.g. day in month forgotten</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional month, optional day;<br>
 i.e. any date allowed; e.g. mental health questionnaires which include well known historical dates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mandatory month, no day</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional month, no day</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:mm:ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full time must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:mm:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds;<br>
 e.g. appointment time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:??:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional minutes, no seconds;<br>
 e.g. normal clock times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:??:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional minutes, seconds;<br>
 i.e. any time allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full date/time must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional seconds;<br>
 e.g. appointment date/time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds;<br>
 e.g. appointment date/time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:??:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds, minutes optional;<br>
 e.g. in patient-recollected date/times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-??T??:??:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum valid date/time constraint</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the above patterns, the 'yyyy' etc. match strings can be replaced by literal date/time numbers. For example, <code>yyyy-??-XX</code> could be transformed into <code>1995-??-XX</code> to mean any partial date in 1995.</p>
</div>
<div class="paragraph">
<p>Any of the time or date/time (but not date) patterns above may be modified to require a timezone by appending one of the following timezone constraint patterns:</p>
</div>
<table id="timezone_constraints" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hours-only timezone modifier required, commencing with '+' or '-'; 'Z' also allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:mm</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">full timezone modifier required, commencing with '+' or '-'; 'Z' also allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hhmm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Z' required (indicating GMT)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is assumed that any time or date/time datum that includes timezone is correctly constructed to include the effect of summer time.</p>
</div>
<div class="paragraph">
<p>The absence of a timezone constraint indicates that a timezone modifier is optional.</p>
</div>
<div class="paragraph">
<p>An assumed value can be used with any of the above using the semi-colon separator, as follows, e.g. <code>yyyy-??-??; 1970-01-01</code>. If there is a timezone constraint, the assumed value must include a valid timezone, i.e. <code>yyyy-mm-ddhh; 1970-01-01+02</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_intervals"><a class="anchor" href="#_intervals"></a>Intervals</h6>
<div class="paragraph">
<p>Dates, times and date/times can also be constrained using intervals. Each date, time or date/time in an interval may be a literal value. Examples of such constraints:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                     </span><span class="tok-c">-- exactly 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&lt; </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                   </span><span class="tok-c">-- any time before 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&lt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                  </span><span class="tok-c">-- any time at or before 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&gt; </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                   </span><span class="tok-c">-- any time after 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&gt; </span><span class="tok-ld">09:30:00+0200</span><span class="tok-p">|</span><span class="tok-w">                              </span><span class="tok-c">-- any time after 9:30 am in UTC+0200 timezone</span>
<span class="tok-w">    </span><span class="tok-p">|&gt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                  </span><span class="tok-c">-- any time at or after 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20</span><span class="tok-p">..</span><span class="tok-ld">2004-06-02</span><span class="tok-p">|</span><span class="tok-w">                       </span><span class="tok-c">-- a date range</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20T00:00:00</span><span class="tok-p">..</span><span class="tok-ld">2005-05-19T23:59:59</span><span class="tok-p">|</span><span class="tok-w">     </span><span class="tok-c">-- a date/time range</span>
<span class="tok-w">    </span><span class="tok-p">|&gt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|;</span><span class="tok-ld">09:30:00</span><span class="tok-w">                         </span><span class="tok-c">-- any time at or after 9:30 am; assume 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20T00:00:00Z</span><span class="tok-p">..</span><span class="tok-ld">2005-05-19T23:59:59Z</span><span class="tok-p">|</span><span class="tok-w">   </span><span class="tok-c">-- a date/time range with UTC timezone</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Within any interval containing two literal date/time values (i.e. not one-sided intervals), if a timezone is used on one, it must be used on both, to ensure comparability. The timezones need not be identical.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_duration_constraints"><a class="anchor" href="#_duration_constraints"></a>4.5.9.2. Duration Constraints</h5>
<div class="sect5">
<h6 id="_patterns"><a class="anchor" href="#_patterns"></a>Patterns</h6>
<div class="paragraph">
<p>Patterns based on ISO 8601 can be used to constrain durations in the same way as for Date/time types. The Antlr4 lexical rule for the pattern is <code>DURATION_CONSTRAINT_PATTERN</code>, shown below in the <a href="#_base_lexer">Base Lexer syntax section</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the use of the <code>W</code> designator with the other designators is an openEHR deviation from the published ISO 8601 standard (where durations are supposed to take the form of either <code>PnnW</code> or <code>PnnYnnMnnDTnnHnnMnnS</code>), to support the common healthcare duration of pregnancy as some combination of weeks and days.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The use of this pattern indicates which 'slots' in an ISO duration string may be filled. Where multiple letters are supplied in a given pattern, the meaning is 'or', i.e. any one or more of the slots may be supplied in the data. This syntax allows specifications like the following to be made:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-ld">Pd</span><span class="tok-w">            </span><span class="tok-c">-- a duration containing days only, e.g. P5d</span>
<span class="tok-w">    </span><span class="tok-ld">Pm</span><span class="tok-w">            </span><span class="tok-c">-- a duration containing months only, e.g. P5m</span>
<span class="tok-w">    </span><span class="tok-ld">PTm</span><span class="tok-w">           </span><span class="tok-c">-- a duration containing minutes only, e.g. PT5m</span>
<span class="tok-w">    </span><span class="tok-ld">Pwd</span><span class="tok-w">           </span><span class="tok-c">-- a duration containing weeks and/or days only, e.g. P4w</span>
<span class="tok-w">    </span><span class="tok-ld">PThm</span><span class="tok-w">          </span><span class="tok-c">-- a duration containing hours and/or minutes only, e.g. PT2h30m</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the 's' (seconds) slot covers fractional seconds as well as whole seconds.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Pure pattern constraints are used to constrain negative durations as well as positive durations. Accordingly, any of the above constraints may be used for values such as <code>'-P5d'</code> etc.</p>
</div>
</div>
<div class="sect5">
<h6 id="_lists_and_intervals"><a class="anchor" href="#_lists_and_intervals"></a>Lists and Intervals</h6>
<div class="paragraph">
<p>Durations can also be constrained by using absolute ISO 8601 duration values, or ranges of the same (including negative values), e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-ld">PT1m</span><span class="tok-w">              </span><span class="tok-c">-- 1 minute</span>
<span class="tok-w">    </span><span class="tok-ld">P1dT8h</span><span class="tok-w">            </span><span class="tok-c">-- 1 day 8 hrs</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">PT0m</span><span class="tok-p">..</span><span class="tok-ld">PT1m30s</span><span class="tok-p">|</span><span class="tok-w">   </span><span class="tok-c">-- Reasonable time offset of first apgar sample</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-err">-</span><span class="tok-ld">P5M</span><span class="tok-p">..</span><span class="tok-ld">P1Y</span><span class="tok-p">|</span><span class="tok-w">       </span><span class="tok-c">-- Possible range of infant gestational ages</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_mixed_pattern_and_interval"><a class="anchor" href="#_mixed_pattern_and_interval"></a>Mixed Pattern and Interval</h6>
<div class="paragraph">
<p>In some cases there is a need to be able to limit the allowed units as well as state a duration interval. This is common in obstetrics, where physicians want to be able to set an interval from say 0-50 weeks and limit the units to only weeks and days. This can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    PWD/|P0W..P50W|   -- 0-50 weeks, expressed only using weeks and days</pre>
</div>
</div>
<div class="paragraph">
<p>The same type of constraint can be used to constrain values that may be negative (usually allowing for zero):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    PYMWD/|&lt;=P0Y|     -- negative age, with years/months/weeks/days allowed</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
a negative sign (or equivalently, the '&lt;= 0' construction as above) is only used for specifying interval values; the pattern part is understood as allowing values of either sign.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The general form is a pattern followed by a slash ('/') followed by an interval, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">duration_constraint</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_pattern</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_interval</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cADL_Terminology_Constraints"><a class="anchor" href="#cADL_Terminology_Constraints"></a>4.5.10. Terminology Constraints</h4>
<div class="paragraph">
<p>Terminology constraints deal with a special category of data values known as 'coded terms' or 'terminology'. Coded data values are both textual (e.g. 'diastolic blood pressure') and semantic, i.e. they may have relationships to each other. The idea is that instead of using text, the possible values are represented in structured vocabularies, terminologies or ontologies that define both the possible text (including translations) and also the relationships, if any, between the terms (sometimes known as 'concepts'). In health, typical examples include 'terminology' resources such as <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">WHO ICDx</a> and <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a> terminologies and drug databases.</p>
</div>
<div class="paragraph">
<p>Coded terms are treated as a primitive type in ADL in order to enable the formalism and tools to work with terminology constraints. Unlike other primitive constraints, terminology constraints may be complex, because they can refer to external resources, either directly or via 'bindings' defined elsewhere in the archteype. This section describes just the syntax representations and relationships between these.</p>
</div>
<div class="paragraph">
<p>The full description, including binding and resolution is provided in <a href="#_terminology_integration">Section 8</a>. This section describes only the syntax for term constraint in the <code>definition</code> section of an archetype.</p>
</div>
<div class="paragraph">
<p>Terminology constraints come in both the usual 'formal' form, as well as a 'soft' form, designed to allow constraints to be treated as various kinds of preferences. These are described below. The allowed specialisations of terminology constraints are described in <a href="#_primitive_object_redefinition">Section 9.6</a>.</p>
</div>
<div class="sect4">
<h5 id="_formal_terminology_constraint"><a class="anchor" href="#_formal_terminology_constraint"></a>4.5.10.1. Formal Terminology Constraint</h5>
<div class="paragraph">
<p>Syntactically, there are two types of terminology constraint expressible in 'source form' ADL, i.e. authored archetypes and templates. The first is expressed with an ac-code which refers to a value set which is either defined in the archetype terminology or externally. The second, for convenience, uses a single at-code, in order to express a single term value without requiring a value-set. For the first case, an assumed value in the form of an at-code can also be stated, and has the same sense as the assumed values of other primitive types already described.</p>
</div>
<div class="paragraph">
<p>The possibilities are illustrated below.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- fragment of openEHR-EHR-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>

<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at0004</span><span class="tok-p">]}</span><span class="tok-w">		</span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0054</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">		</span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0021</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Certainty</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0057</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-err">; </span><span class="tok-nd">at0022</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- fragment of openEHR-EHR-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>

<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at5</span><span class="tok-p">]}</span><span class="tok-w">		</span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id55</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">		</span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Certainty</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id58</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-err">; </span><span class="tok-nd">at23</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the constraint at the path <code>items[at0010]/name[at0007]</code> (<code>items[id11]/name[id8]</code>) is on a <code>DV_CODED_TEXT.<em>defining_code</em></code> representing the <code><em>name</em></code> of the <code>ELEMENT</code>. It is constrained to a single at-code value representing 'Substance' (assume this is the preferred name of the institution that created this archetype). The at-code is defined in the terminology part of the archetype, and may have bindings defined there as well. These are described in later sections.</p>
</div>
<div class="paragraph">
<p>The second variant uses the code <code>ac1</code>, which refers to a value set. This is by definition: all ac-codes in ADL refer only to value sets. This is the most common form of terminology constraint - defining possible codes for a codable value in the model. The code and any bindings are also defined in the <code>terminology</code> section.</p>
</div>
<div class="paragraph">
<p>The last variant shows a second value set constraint, this time with an assumed code, where <code>at0022</code> (<code>at23</code>) must be in the value set referred to by <code>ac2</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_soft_terminology_constraint"><a class="anchor" href="#_soft_terminology_constraint"></a>4.5.10.2. Soft Terminology Constraint</h5>
<div class="paragraph">
<p>Uniquely in ADL, terminology constraints may be modified to be informal, also known as specifying a 'constraint strength'. Normally constraints in ADL are formal in the sense that they are intended to strictly apply to the instances they constrain. However, in the terminology value domain, the ability to easily constrain allowed 'values' to particular terms or value-sets is complicated by various factors, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>unforeseeable changes in thinking in classification and description in the terminology world;</p>
</li>
<li>
<p>the lack of available fully developed terminological descriptions of the phenomena being represented;</p>
</li>
<li>
<p>practical needs of mapping to specific local or other terminologies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For these reasons, terminology constraints may be relaxed from the default 'required' status, to three <em>informal</em> constraint statuses, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>extensible</em>: the data instance must conform to the value set <em>if the intended concept is available within the value-set constraint</em>; if not, the instance may be any other code;</p>
</li>
<li>
<p><em>preferred</em>: the data instance preferably conforms to the value set, but may use any other code, even if the concept is represented by a code within the constraint;</p>
</li>
<li>
<p><em>example</em>: the constraint value or value-set is provided as an illustrative example only.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Formally, all three of these statuses are the same as a value constraint specifying only the RM type as being a terminology code (e.g. <code>DV_CODED_TEXT</code> from openEHR) and nothing more, which is to say, at the archetype level, validity of the data instance is achieved by supplying <em>any terminology code</em>. However, higher levels of semantic validation in tooling may be performed that do take into account any informal constraint status that may be set.</p>
</div>
<div class="paragraph">
<p>Soft terminology constraints are typically intended to be used alongside a constraint allowing a pure text value as well, i.e. to cope with the case where no terminology code of any kind is available at runtime to express the intended value (this happens every so often in healthcare when a novel virus or pathogen is identified, but not yet incorporated into published terminologies). The ability to construct a coded-text + plain-text constraint pattern is entirely dependent on the types available in the Reference Model on which the archetypes in question are based.</p>
</div>
<div class="paragraph">
<p>The <em>recommendation</em> is that if a terminology constraint is not <code>required</code>, a plain text constraint should be supplied alongside if the RM permits, to allow for the case of unavailability of any coded term.</p>
</div>
<div class="paragraph">
<p>Soft terminology constraints are specified in ADL using keywords prior to the formal constraint. Taking into account the recommendation for coded-text + text, the typical usage is as shown below. If no keyword is supplied, the meaning is <code>required</code>, although this may also be stated using the <code>required</code> keyword if desired.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]}</span><span class="tok-w">	</span><span class="tok-c">-- prefer &#39;Substance&#39;, any code ok</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w">                                </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0054</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">example</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">	</span><span class="tok-c">-- ac1 provided as example only</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0055</span><span class="tok-p">]</span><span class="tok-w">                               </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0021</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0057</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">extensible</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span><span class="tok-w"> </span><span class="tok-c">-- use ac2 value-set if there is a match</span>
<span class="tok-w">                </span><span class="tok-p">}</span><span class="tok-w">                                            </span><span class="tok-c">-- or another code from same terminology</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0058</span><span class="tok-p">]</span><span class="tok-w">                                </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at5</span><span class="tok-p">]}</span><span class="tok-w">	</span><span class="tok-c">-- prefer &#39;Substance&#39;, any code ok</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w">                                </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id55</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">example</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">	</span><span class="tok-c">-- ac1 provided as example only</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id56</span><span class="tok-p">]</span><span class="tok-w">                               </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id58</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">extensible</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span><span class="tok-w"> </span><span class="tok-c">-- use ac2 value-set if there is a match</span>
<span class="tok-w">                </span><span class="tok-p">}</span><span class="tok-w">                                            </span><span class="tok-c">-- or another code from same terminology</span>
<span class="tok-w">                </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id59</span><span class="tok-p">]</span><span class="tok-w">                                </span><span class="tok-c">-- or plain text</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_operational_binding_constraints"><a class="anchor" href="#_operational_binding_constraints"></a>4.5.10.3. Operational Binding Constraints</h5>
<div class="paragraph">
<p>The above sections describe 'source form' constraints, i.e. constraints expressed in terms of internal codes and value-sets. A further constraint possibility exists, for use at the point of operational template generation. As described in <a href="#_from_constraints_to_concrete_codes_in_data">Section 8.3</a>, the choice may be made that a specific operational template (OPT) should use external codes from the archetype bindings (such as from <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a>, <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICD10</a>, etc) as the values of some or all coded nodes, rather than using the internal at-codes.</p>
</div>
<div class="paragraph">
<p>To express this choice, the OPT&#8217;s <code>definition</code> section contains a modified version of the usual syntax <code>[at0001]</code> (<code>[at1]</code>) or <code>[ac1]</code> in those nodes where an external term from the bindings is to be used. This takes the form <code>[acN@ttttt]</code> or <code>[atNNNN@ttttt]</code> (<code>[atN@ttttt]</code>) where <code>ttttt</code> is the namespace identifier of a binding in the <code>terminology</code> section of the archetype.</p>
</div>
<div class="paragraph">
<p>Specifying which codable nodes (including 'all' and 'none' options) should have their values substituted by the external codes is assumed to be part of the OPT generator tool. Different terminology bindings may be specified on different nodes of the same archetype, or none at all, allowing for a mixture of external term substitutions depending on node.</p>
</div>
<div class="paragraph">
<p>The following example shows the result in an operational template fragment.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- extract of an operational template based on openEHR-EHR-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0054</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- use snomed_ct binding for value from ac1 at runtime</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- extract of an operational template based on openEHR-EHR-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id55</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- use snomed_ct binding for value from ac1 at runtime</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_terminology_integration">Section 8</a> for fuller picture of how this works.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_lists_of_primitive_types"><a class="anchor" href="#_constraints_on_lists_of_primitive_types"></a>4.5.11. Constraints on Lists of Primitive Types</h4>
<div class="paragraph">
<p>In some cases, the type in the information model of an attribute to be constrained is a list or set of primitive types, i.e. <code>List&lt;Integer&gt;</code>, <code>Set&lt;String&gt;</code> etc. Here, the types <code>List&lt;T&gt;</code> and <code>Set&lt;T&gt;</code> are understood in the standard way in computer science, i.e. as linear containers with respectively, ordering and unique membership.</p>
</div>
<div class="paragraph">
<p>Any constraint described above for single-valued attributes, which is commensurate with the type of the attribute in question, may be used for this purpose as well. However, for values of type <code>List&lt;T&gt;</code>, <code>Set&lt;T&gt;</code> etc., the meaning is now that every item in the value list is constrained to be <em>any one of the values</em> specified by the constraint expression. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">speed_limits</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mi">50</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">60</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">70</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">80</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">100</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">130</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>constrains each value in the list corresponding to the value of the attribute <code>speed_limits</code> (of type <code>List&lt;Integer&gt;</code> ), to be any one of the values <code>50</code>, <code>60</code>, <code>70</code> etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_intervals_of_ordered_primitive_types"><a class="anchor" href="#_constraints_on_intervals_of_ordered_primitive_types"></a>4.5.12. Constraints on Intervals of Ordered Primitive Types</h4>
<div class="paragraph">
<p>A third variation on primitive types is that of Intervals of Ordered primitive types, i.e. where the attribute type is <code>Interval&lt;Integer&gt;</code>, <code>Interval&lt;Duration&gt;</code> etc. The type <code>Interval&lt;T:Ordered&gt;</code> is understood as defined in the <a href="https://specifications.openehr.org/releases/BASE/latest/foundation_types.html#_interval" target="_blank" rel="noopener">openEHR Foundation Types</a>, and corresponds to a similar type in most programming language libraries.</p>
</div>
<div class="paragraph">
<p>Values of these types may be constrained with the same constraint expressions as for atomic values of the same type, with the most usual pattern being one or more Intervals, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">speed_range</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">60</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mi">60</span><span class="tok-p">..</span><span class="tok-mi">90</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mi">90</span><span class="tok-p">..</span><span class="tok-mi">110</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|</span><span class="tok-mi">110</span><span class="tok-p">..</span><span class="tok-mi">130</span><span class="tok-p">|,</span><span class="tok-w"> </span><span class="tok-p">|&gt;</span><span class="tok-mi">130</span><span class="tok-p">|}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of such constraints is interpreted differently for Interval-valued attributes compared to single-valued attributes. Here, each Interval in the constraint is understood as a <em>possible (Interval) value</em> for the constrained attribute, not as providing a range of possible values. The example above thus allows 5 different Interval values for the attribute <code>speed_range</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_enumerated_types"><a class="anchor" href="#_constraints_on_enumerated_types"></a>4.5.13. Constraints on Enumerated Types</h4>
<div class="paragraph">
<p>Enumeration types in a reference model are assumed to have the semantics defined in UML and mainstream programming languages, i.e. to be a distinct type based on a primitive type, normally Integer or String. Each such type consists of a set of values from the domain of its underlying type, thus, a set of Integer, String or other primitive values. Each of these values is assumed to be named in the manner of a symbolic constant. Although strictly speaking UML doesn&#8217;t require an enumerated type to be based on an underlying primitive type, programming languages do, hence the assumption here that values from the domain of such a type are involved.</p>
</div>
<div class="paragraph">
<p>In ADL, constraints on enumerated types are represented by constraints on the underlying primitive values. The following example shows 2 constraints on an attribute of the type <code>PROPORTION_KIND</code> from the openEHR Reference Model.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- test enum 1</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">1.0</span><span class="tok-p">|;</span><span class="tok-w"> </span><span class="tok-mf">0.0</span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w">                         </span><span class="tok-c">-- pk_unitary</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- test enum 2</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">1.0</span><span class="tok-p">|;</span><span class="tok-w"> </span><span class="tok-mf">0.0</span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mi">2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-p">}</span><span class="tok-w">                      </span><span class="tok-c">-- pk_percent, pk_fraction</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- test enum 1</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">1.0</span><span class="tok-p">|;</span><span class="tok-w"> </span><span class="tok-mf">0.0</span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w">                         </span><span class="tok-c">-- pk_unitary</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- test enum 2</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">1.0</span><span class="tok-p">|;</span><span class="tok-w"> </span><span class="tok-mf">0.0</span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mi">2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-p">}</span><span class="tok-w">                      </span><span class="tok-c">-- pk_percent, pk_fraction</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>PROPORTION_KIND</code> is defined as <code>{pk_ratio = 0; pk_unitary = 1; pk_percent = 2; pk_fraction = 3; pk_integer_fraction = 4}</code> in its reference model. Modelling tools are relied on to visualise enumeration constraints in a suitable way, by inferring the type based on inspection of the reference model on which the archetype is based.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_validity_rules"><a class="anchor" href="#_syntax_validity_rules"></a>4.6. Syntax Validity Rules</h3>
<div class="paragraph">
<p>Various coded syntax rules have been defined for the cADL syntax, for use by parser and compiler authors. These can be found on at the GitHub location <a href="https://github.com/openEHR/adl-resources/blob/master/messages/ADL/adl_syntax_errors.txt" class="bare">https://github.com/openEHR/adl-resources/blob/master/messages/ADL/adl_syntax_errors.txt</a>.</p>
</div>
<div class="paragraph">
<p>The state of this file at the issue of this document is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">syntax_errors</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SUNK&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error (unknown cause)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SARID&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in artefact identification clause; expecting archetype id (format = model_issuer-package-class.concept.version)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SASID&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in &#39;specialise&#39; clause; expecting parent archetype id (model_issuer-ref_model-model_class.concept.version)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SACO&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in &#39;concept&#39; clause; expecting TERM_CODE reference&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SALA&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in language section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SALAN&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error no language section found&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SADS&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in description section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SADF&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in definition section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SAIV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in invariant section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SAON&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in terminology section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SAAN&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error in annotations section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SDSF&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: differential syntax not allowed in top-level archetype&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SDINV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid ODIN section; error: $1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCCOG&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting a new node definition, primitive node definition, &#39;use&#39; path, or &#39;archetype&#39; reference&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SUAID&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting [archetype_id] in use_archetype statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SUAIDI&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid archetype id $1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SOCCF&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting an &#39;occurrences expression&#39;, e.g. &#39;occurrences matches {n..m}&#39;&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SUNPA&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting absolute path in use_node statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCOAT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting attribute definition(s)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SUAS&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: error after &#39;use_archetype&#39; keyword; expecting Object node definition&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCAS&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting a &#39;any&#39; node, &#39;leaf&#39; node, or new node definition&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SINVS&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: illegal invariant expression at identifier $1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SEXPT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: expecting absolute path after exists keyword&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SEXLSG&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: existence single value must be 0 or 1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SEXLU1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: existence upper limit must be 0 or 1 when lower limit is 0&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SEXLU2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: existence upper limit must be 1 when lower limit is 1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SEXLMG&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: existence must be one of 0..0, 0..1, or 1..1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCIAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an integer&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCRAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be a real number&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an ISO8601 date&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCTAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an ISO8601 time&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDTAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an ISO8601 date/time&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDUAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an ISO8601 duration&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCSAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be a string&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCBAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be a &#39;True&#39; or &#39;False&#39;&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCOAV&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid assumed value; must be an ordinal integer value&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDPT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid date constraint pattern &#39;$1&#39;; allowed patterns: $2&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCTPT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid time constraint pattern &#39;$1&#39;; allowed patterns: $2&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDTPT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid date/time constraint pattern &#39;$1&#39;; allowed patterns: $2&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCDUPT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid duration constraint pattern &#39;$1&#39;; legal pattern: P[Y|y][M|m][W|w][D|d][T[H|h][M|m][S|s]] or P[W|w] [/duration_interval]&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;SCSRE&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: regular expression compile error &#39;$1&#39; is not a valid regular expression&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;STCCP&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: invalid term code constraint pattern &#39;$1&#39;: $2&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;STCDC&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: duplicate code(s) found in code list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;STCAC&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: assumed value code $1 not found in code list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;STCNT&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Syntax error: terminology not specified&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adl_paths"><a class="anchor" href="#_adl_paths"></a>5. ADL Paths</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>5.1. Overview</h3>
<div class="paragraph">
<p>The notion of paths is integral to ADL, and a common path syntax is used to reference nodes in both ODIN and cADL sections of an archetype. The same path syntax works for both, because both ODIN and cADL have an alternating object/attribute structure. However, the interpretation of path expressions in ODIN and cADL differs slightly; the differences are explained in the ODIN and cADL sections of this document. This section describes only the common syntax and semantics.</p>
</div>
<div class="paragraph">
<p>The general form of the path syntax is as follows (see syntax section below for full specification):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-w">    </span><span class="tok-nl">path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">path_segment</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">path_segment</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-nl">path_segment</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">attr_name</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">object_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Essentially, ADL paths consist of segments separated by slashes (<code>'/'</code>), where each segment is an attribute name with optional object identifier predicate, indicated by brackets ('[]').</p>
</div>
<div class="paragraph principle">
<p><strong>ADL Paths</strong> are formed from an alternation of segments made up of an attribute name and optional object node identifier predicate, separated by slash (<code>'/'</code>) characters. Node identifiers are delimited by brackets (i.e. <code>[]</code>).</p>
</div>
<div class="paragraph">
<p>Similarly to paths used in file systems, ADL paths are either absolute or relative, with the former being indicated by a leading slash.</p>
</div>
<div class="paragraph principle">
<p>Paths are <strong>absolute</strong> or <strong>relative</strong> with respect to the document in which they are mentioned. Absolute paths commence with an initial slash ('/') character.</p>
</div>
<div class="paragraph">
<p>The ADL path syntax also supports the concept of "movable" path patterns, i.e. paths that can be used to find a section anywhere in a hierarchy that matches the path pattern. Path patterns are indicated with a leading double slash ('//') as in Xpath.</p>
</div>
<div class="paragraph principle">
<p><strong>Path patterns</strong> are absolute or relative with respect to the document in which they are mentioned. Absolute paths commence with an initial slash ('/') character.</p>
</div>
<div class="sect3">
<h4 id="_relationship_with_w3c_xpath"><a class="anchor" href="#_relationship_with_w3c_xpath"></a>5.1.1. Relationship with W3C Xpath</h4>
<div class="paragraph">
<p>The ADL path syntax is semantically a subset of the Xpath query language, with a few syntactic shortcuts to reduce the verbosity of the most common cases. Xpath differentiates between "children" and "attributes" sub-items of an object due to the difference in XML between Elements (true sub-objects) and Attributes (tag-embedded primitive values). In ADL, as with any pure object formalism, there is no such distinction, and all sub-parts of any object are referenced in the manner of Xpath children; in particular, in the Xpath abbreviated syntax, the key <code>child::</code> does not need to be used.</p>
</div>
<div class="paragraph">
<p>ADL does not distinguish attributes from children, and also assumes the node_id attribute. Thus, the following expressions are legal for cADL structures:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span>1<span class="tok-p">]</span><span class="tok-w">                            </span><span class="tok-c">-- the first member of &#39;items&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nc">systolic</span><span class="tok-p">]</span><span class="tok-w">                     </span><span class="tok-c">-- the member of &#39;items&#39; with meaning &#39;systolic&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w">                       </span><span class="tok-c">-- the member of &#39;items&#39; with node id &#39;at0003&#39;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span>1<span class="tok-p">]</span><span class="tok-w">                            </span><span class="tok-c">-- the first member of &#39;items&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nc">systolic</span><span class="tok-p">]</span><span class="tok-w">                     </span><span class="tok-c">-- the member of &#39;items&#39; with meaning &#39;systolic&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w">                          </span><span class="tok-c">-- the member of &#39;items&#39; with node id &#39;id1&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Xpath equivalents are:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xpath"><span></span>    items[1]                              -- the first member of &#39;items&#39;
    items[meaning() = &#39;systolic&#39;]         -- the member of &#39;items&#39; for which the meaning()
                                          -- function evaluates to &quot;systolic&quot;
    items[@archetype_node_id = &#39;at0003&#39;]  -- the member of &#39;items&#39; with key &#39;at0003&#39;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="xpath"><span></span>    items[1]                           -- the first member of &#39;items&#39;
    items[meaning() = &#39;systolic&#39;]      -- the member of &#39;items&#39; for which the meaning()
                                       -- function evaluates to &quot;systolic&quot;
    items[@archetype_node_id = &#39;id1&#39;]  -- the member of &#39;items&#39; with key &#39;id1&#39;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, <code>meaning()</code> is a notional function is defined for Xpath in openEHR, which returns the rubric for the node_id of the current node. Such paths are only for display purposes, and paths used for computing always use the 'at' ('id') codes, e.g. <code>items[at0003]</code> (<code>items[id1]</code>), for which the Xpath equivalent is <code>items[@node_id = 'at0003']</code> (<code>items[@node_id = 'id1']</code>).</p>
</div>
<div class="paragraph">
<p>The ADL movable path pattern is a direct analogue of the Xpath syntax abbreviation for the 'descendant' axis.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_values"><a class="anchor" href="#_default_values"></a>6. Default Values</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_syntax"><a class="anchor" href="#_syntax"></a>6.1. Syntax</h3>
<div class="paragraph">
<p>In ADL, it is possible to specify a default value for any object node. This is usually limited to locally specialised archetypes and templates, since default values are usually specific to local contexts or use cases. However they may validly be used in any archetype.</p>
</div>
<div class="paragraph">
<p>Default values are expressed in any regular object instance syntax, including <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">ODIN syntax</a> and <a href="http://json.org" target="_blank" rel="noopener">JSON</a>, since they are instances of objects rather than constraints. They are introduced using a pseudo-attribute <code>_default</code>, followed by the <code>'='</code> symbol, and then a block in the chosen syntax. The following shows the syntax in ODIN.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- ODIN embedded in ADL</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">path</span><span class="tok-p">[</span><span class="tok-nc">idN</span><span class="tok-p">]</span><span class="tok-err">...</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">TYPE</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">TYPE</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">attribute_1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-nc">value_1</span><span class="tok-o">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">attribute_2</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-nc">value_2</span><span class="tok-o">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">...</span>
<span class="tok-w">                </span><span class="tok-nc">attribute_N</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-nc">value_N</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The JSON equivalent is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- JSON embedded in ADL</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">path</span><span class="tok-p">[</span><span class="tok-nc">idN</span><span class="tok-p">]</span><span class="tok-err">...</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">TYPE</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">json</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-err">#</span>
<span class="tok-w">                </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;_type&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-s">&quot;TYPE&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;attribute_1&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-nc">value_1</span><span class="tok-p">,</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;attribute_2&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-nc">value_2</span><span class="tok-p">,</span>
<span class="tok-w">                    </span><span class="tok-p">...</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;attribute_N&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-nc">value_N</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-err">#</span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A default value is either of the same type as specified by the corresponding archetype node (i.e. the first occurrence of 'TYPE' in each of the above examples) or any subtype allowed by the reference model. Accordingly, the second occurrence of 'TYPE' in both ODIN and JSON cases above represents either the same type as the first, or a subtype.</p>
</div>
</div>
<div class="sect2">
<h3 id="_examples"><a class="anchor" href="#_examples"></a>6.2. Examples</h3>
<div class="paragraph">
<p>Within a template, a default value can be defined to support the situation where only one value is possible for a data item due to the specific nature of the template. For example, a blood pressure archetype may allow a number of possible values for 'patient position', such as 'lying', and 'sitting', 'standing'. When used in a hospital, the patient will usually be lying so a default value for this can be set, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above only sets the default value, but it could have also modified the constraint on the value object as well, as in the following version, where the standing blood pressure possibility from the archetype has been removed:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163035008</span><span class="tok-p">|</span><span class="tok-s">sitting BP</span><span class="tok-p">|],</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163035008</span><span class="tok-p">|</span><span class="tok-s">sitting BP</span><span class="tok-p">|],</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-p">[</span><span class="tok-nd">snomed_ct</span><span class="tok-p">::</span><span class="tok-nd">163033001</span><span class="tok-p">|</span><span class="tok-s">lying BP</span><span class="tok-p">|]</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in the above, the standard brief syntax for a <code>CODE_PHRASE</code> (also the equivalent class <code>Terminology_code</code>) is used. In the JSON format, the default value in the above examples is as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">json</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-err">#</span>
<span class="tok-w">                </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;_type&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-s">&quot;DV_CODED_TEXT&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;defining_code&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;terminology_id&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;code_string&quot;</span><span class="tok-err">:</span><span class="tok-w">    </span><span class="tok-s">&quot;163033001&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;value&quot;</span><span class="tok-err">:</span><span class="tok-w">          </span><span class="tok-s">&quot;lying BP&quot;</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-err">#</span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]/</span><span class="tok-nc">state</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">_default</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">json</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-err">#</span>
<span class="tok-w">                </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;_type&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-s">&quot;DV_CODED_TEXT&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                    </span><span class="tok-s">&quot;defining_code&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;terminology_id&quot;</span><span class="tok-err">:</span><span class="tok-w"> </span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;code_string&quot;</span><span class="tok-err">:</span><span class="tok-w">    </span><span class="tok-s">&quot;163033001&quot;</span><span class="tok-p">,</span>
<span class="tok-w">                        </span><span class="tok-s">&quot;value&quot;</span><span class="tok-err">:</span><span class="tok-w">          </span><span class="tok-s">&quot;lying BP&quot;</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-err">#</span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adl_archetype_definition_language"><a class="anchor" href="#_adl_archetype_definition_language"></a>7. ADL - Archetype Definition Language</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction"><a class="anchor" href="#_introduction"></a>7.1. Introduction</h3>
<div class="paragraph">
<p>This section describes whole ADL artefacts. The relationship of the cADL-encoded <code>definition</code> section and the ODIN-encoded <code>terminology</code> section is discussed in detail.</p>
</div>
<div class="paragraph">
<p>Some syntax validity rules are defined, but validity in general is defined by the rules stated in the AOM specification, which can be checked by a compiler as soon as an AOM structure is parsed from an ADL document (or other serialisation format).</p>
</div>
<div class="paragraph">
<p>The general structure of ADL artefacts is as follows (the full definitions are shown in <a href="#_syntax_specification">Appendix B</a> below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">adl_artefact</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">artefact_type</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_HRID</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;specialize&#39;</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_REF</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;language&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;description&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;definition&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rules&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">el_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rm_overlay&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;terminology&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;annotations&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">artefact_type</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;archetype&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;template&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;template_overlay&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;operational_template&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax for <code>meta_data_item</code>, <code>ARCHETYPE_HRID</code> and <code>ARCHETYPE_REF</code> can be found below in <a href="#_base_patterns">[_base_patterns]</a>.</p>
</div>
<div class="paragraph">
<p>The 'archetype' artefact type can have any or all of the above sections. The other artefact types are more specific in their form.</p>
</div>
<div class="paragraph">
<p>An ADL source template has the following structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">adl_template</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;template&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_HRID</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;specialize&#39;</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_REF</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;language&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;description&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;definition&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rules&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">el_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rm_overlay&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;terminology&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;annotations&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>An ADL template overlay has the structure shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">adl_template_overlay</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;template_overlay&#39;</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_HRID</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;specialize&#39;</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_REF</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;definition&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rules&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">el_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rm_overlay&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;terminology&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The structure of an operational template is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">adl_operational_template</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;operational_template&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span>
<span class="tok-w">        </span><span class="tok-no">ARCHETYPE_HRID</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;language&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;description&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;definition&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rules&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">el_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;rm_overlay&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;terminology&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-s1">&#39;annotations&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;component_terminologies&#39;</span>
<span class="tok-w">        </span><span class="tok-nv">odin_text</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_file_naming_convention"><a class="anchor" href="#_file_naming_convention"></a>7.2. File-naming Convention</h3>
<div class="paragraph">
<p>Up until ADL 1.4, archetypes were expressed in 'flat' form ADL and were saved in files with the extension <code>.adl</code>. These are now treated as legacy flat format files. Beginning with ADL 2, the source file format of an archetype is the 'differential' form, with the extension <code>.adls</code>. The flat format generated by tools now has the extension <code>.adlf</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_artefact_content"><a class="anchor" href="#_artefact_content"></a>7.3. Artefact Content</h3>
<div class="paragraph">
<p>For specialised archetypes, differential form follows the object-oriented convention and only includes overridden or new elements but not unchanged inherited elements. Inherited elements are determined by compiling and 'flattening' a differential archetype with respect to the parent archetypes in its <em>inheritance lineage</em> .</p>
</div>
<div class="paragraph">
<p>For top-level archetypes the full structure is included in the differential file, but internal references, where they exist, are expanded out in the flat form.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basics_2"><a class="anchor" href="#_basics_2"></a>7.4. Basics</h3>
<div class="sect3">
<h4 id="_keywords_2"><a class="anchor" href="#_keywords_2"></a>7.4.1. Keywords</h4>
<div class="paragraph">
<p>ADL has a small number of keywords which are reserved for use in archetype declarations, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>, <code>template</code>, <code>template_overlay</code>, <code>operational_template</code>,</p>
</li>
<li>
<p><code>specialise</code> / <code>specialize</code>,</p>
</li>
<li>
<p><code>language</code> ,</p>
</li>
<li>
<p><code>description</code> , <code>definition</code> , <code>rules</code> , <code>terminology</code></p>
</li>
<li>
<p><code>annotations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these words can safely appear as identifiers in the <code>definition</code> and <code>terminology</code> sections.</p>
</div>
<div class="paragraph">
<p>Deprecated keywords include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>invariant</code>&#8201;&#8212;&#8201;replaced by <code>rules</code></p>
</li>
<li>
<p><code>ontology</code> &#8201;&#8212;&#8201;replaced by <code>terminology</code></p>
</li>
<li>
<p><code>concept</code>  &#8201;&#8212;&#8201;obsolete</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_artefact_declaration"><a class="anchor" href="#_artefact_declaration"></a>7.4.2. Artefact declaration</h4>
<div class="paragraph">
<p>The first word in a source ADL archetype declares the artefact type, and is one of the following keywords:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>:        signifies an archetype;</p>
</li>
<li>
<p><code>template</code>:         signifies a template;</p>
</li>
<li>
<p><code>template_overlay</code>: signifies an overlay component of a template.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The flattened form of any of the above types starts with the keyword 'flat' followed by the artefact type.</p>
</div>
<div class="paragraph">
<p>A fourth artefact type is also possible.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>operational_archetype</code>: signifies an operational archetype, generated by flattening a template.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_node_identifier_codes"><a class="anchor" href="#_node_identifier_codes"></a>7.4.3. Node Identifier Codes</h4>
<div class="paragraph">
<p>In the <code>definition</code> section of an ADL archetype, a specific set of codes is used as node identifiers. Identifier codes always appear in brackets (<code>[]</code> ), and begin with the 'at' prefix for at-coded archetypes or 'id' prefix for id-coded archetypes. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>[at0009.2]</code> (<code>[id10.2]</code>). From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
<div class="paragraph">
<p>In ADL 1.4 at-codes were used as node identifiers. For id-coded ADL2 archetypes, these are converted to id-codes by ADL 1.4 to ADL 2 converters.</p>
</div>
</div>
<div class="sect3">
<h4 id="_local_term_codes"><a class="anchor" href="#_local_term_codes"></a>7.4.4. Local Term Codes</h4>
<div class="paragraph">
<p>In the <code>definition</code> section of an ADL archetype, a second set of codes is used for terms denoting constraints on coded items. Term codes are either local to the archetype, or from an external lexicon. This means that the archetype description is the same in all languages, and is available in any language that the codes have been translated to. All term codes are shown in brackets (<code>[]</code>) and are prefixed with "at", e.g. <code>at10</code> . Codes of any length are acceptable in ADL archetypes. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>at10.2</code> . From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_local_value_set_codes"><a class="anchor" href="#_local_value_set_codes"></a>7.4.5. Local Value Set Codes</h4>
<div class="paragraph">
<p>A third kind of local code is used to stand for value set constraints on coded text items in the body of the archetype. Because they are language- and/or terminology-sensitive, they are defined in the terminology section, and referenced by codes prefixed by "ac", e.g. <code>[ac9]</code>.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4 and transitional forms of ADL 1.5/2, 0-padded 'at' and 'ac' codes were used within top-level archetypes. In ADL 2, all such codes are reformatted to remove the 0-padding.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_archetype_identification_section"><a class="anchor" href="#_archetype_identification_section"></a>7.5. Archetype Identification Section</h3>
<div class="paragraph">
<p>This section introduces the archetype with the keyword <code>archetype</code>, <code>template</code>, <code>template_overlay</code> or <code>operational_archetype</code>, followed by a number of items of meta-data in parentheses, and on the next line, a human-readable archetype identifier. The following shows an identification section with all possible meta-data items.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.3</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">provenance_id</span><span class="tok-o">=</span><span class="tok-l">15E82D77-7DB7-4F70-8D8E-EED6FF241B2D</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">build_uid</span><span class="tok-o">=</span><span class="tok-l">E163E472-3E90-409C-9803-0668A7DA48CE</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">generated</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">controlled</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_adl_version_indicator"><a class="anchor" href="#_adl_version_indicator"></a>7.5.1. ADL Version Indicator</h4>
<div class="paragraph">
<p>An ADL version identifier is mandatory in all archetypes, and is expressed as a string of the form <code>adl_version=N.M</code> , or <code>N.M.P</code>, where <code>N.M[.P]</code> is the ADL release identifier.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rm_release_indicator"><a class="anchor" href="#_rm_release_indicator"></a>7.5.2. RM Release Indicator</h4>
<div class="paragraph">
<p>An RM (Reference Model) Release identifier is mandatory in all archetypes, and is expressed as a string of the form <code>rm_release=N.M</code>, or <code>N.M.P</code>, where the version number indicates the release of the reference model on which the archetype is based.</p>
</div>
</div>
<div class="sect3">
<h4 id="_machine_identifiers"><a class="anchor" href="#_machine_identifiers"></a>7.5.3. Machine Identifiers</h4>
<div class="paragraph">
<p>A unique identifier for the archetype in the form of a GUID can be specified using the syntax below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.3</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">uid</span><span class="tok-o">=</span><span class="tok-l">15E82D77-7DB7-4F70-8D8E-EED6FF241B2D</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This identifier is set at initial creation or at any time later, and never subsequently changes. It acts as an identifier for the physical artefact, regardless of what semantics are changed, including changes to the constituent parts of the multi-axial identifier.</p>
</div>
<div class="paragraph">
<p>A <code>build_uid</code> identifier can also be specified, with a GUID value, identifying the current artefact. This identifier changes whenever any change is made to the text of the archetype, and can thus be used to disambiguate subsequent versions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_namespaces"><a class="anchor" href="#_namespaces"></a>7.5.4. Namespaces</h4>
<div class="paragraph">
<p>A namespaced archetype has an identification section like the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">br.gov.saude::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0</span>

<span class="tok-gh">template</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">uk.org.primary_care::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15</span>

<span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">org.openehr::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Namespaces are used to distinguish locally created artefacts representing a given concept (such as 'haematology result') from an artefact created elsewhere intended to represent the same concept.</p>
</div>
<div class="paragraph">
<p>Once a namespace is attached to an archetype, it is considered a part of the identifier, and never changed, even if the archetype moves to a new publishing organisation. This ensures the constant relationship between archetypes and the data created using them.</p>
</div>
</div>
<div class="sect3">
<h4 id="_human_readable_archetype_identifier"><a class="anchor" href="#_human_readable_archetype_identifier"></a>7.5.5. Human Readable Archetype Identifier</h4>
<div class="paragraph">
<p>The archetype identifier may include a namespace, in the form of a reverse domain name, which denotes the original authoring organisation. The lack of a namespace in the identifier indicates an ad hoc, uncontrolled artefact, not formally associated with any organisation, typical for experimental archetypes, and pre-ADL 1.5 archetypes not yet upgraded to have a namespace. The main part of the identifier is multi-axial concept identifier.</p>
</div>
<div class="paragraph">
<p>A typical identification sectionfor an ad hoc archetype is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology_result.v0.1.9</span></code></pre>
</div>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: In ADL 1.4 and transitional forms of ADL 1.5, archetype identifiers included only a single version number, and this typically started at 1. Tools that deal with older archetypes should accept these identifiers, and convert the version part to 'v1.0.0' or any other appropriate identifier, obeying the openEHR Artefact Knowledge Identification specification.</p>
</div>
<div class="paragraph">
<p>The multi-axial archetype identifier identifies archetypes in a global concept space within a given namespace. It is also known as an 'ontological' identifier, since the concept space can be understood as an ontology of informational concepts on which the archetypes are based. The syntax of the identifier is described in the <a href="https://specifications.openehr.org/releases/AM/latest/Identification.html" target="_blank" rel="noopener">openEHR Identification Specification</a>. The structure of the concept space is essentially two-level, with the first level being a reference model class (e.g. openEHR <code>OBSERVATION</code> class) and the second being a domain concept (e.g. 'haematology result').</p>
</div>
<div class="paragraph">
<p>Because namespaces are usually treated hierarchically, higher level namespaces (e.g. '.org' domains) are assumed to be includable by more local namespaces, with the result that the concept definition space is inherited as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specialised_archetype_identification"><a class="anchor" href="#_specialised_archetype_identification"></a>7.5.6. Specialised Archetype Identification</h4>
<div class="paragraph">
<p>The archetype identifier of any specialised archetype, including all templates, follows the same rules as for non-specialised archetypes.</p>
</div>
<div class="paragraph deprecated">
<p><strong>Deprecated</strong>: in previous versions of ADL, the archetype identifier of a specialised archetype had a concept part that consisted of the concept part of the parent followed by '-' and a further specialised concept. For example, <code>openEHR-EHR-OBSERVATION.haematology-cbc. v1</code> was a valid child of <code>openEHR-EHR-OBSERVATION.haematology.v1</code>. This restriction is no longer the case. The previous style of identifier is still legal, but the '-' no longer has any significance.</p>
</div>
</div>
<div class="sect3">
<h4 id="_version_identifiers"><a class="anchor" href="#_version_identifiers"></a>7.5.7. Version Identifiers</h4>
<div class="paragraph">
<p>ADL 2 Archetypes contain 3-part version identifiers, with optional qualifiers, following the openEHR Artefact Knowledge Identification specification. Examples below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-w">    </span><span class="tok-nd">br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.0.0</span>
<span class="tok-w">    </span><span class="tok-nd">br.ms::openEHR-EHR-OBSERVATION.haematology_result.v1.2.15-alpha.45</span>
<span class="tok-w">    </span><span class="tok-nd">br.ms::openEHR-EHR-OBSERVATION.haematology_result.v3.22.125-rc.7</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The version identifier variants are summarised as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>N.M.P</code>         - 3-part version id with no qualifier indicates major.minor.path version</p>
</li>
<li>
<p><code>N.M.P-alpha.N</code> - a <code>-alpha.N</code> qualifier indicates uncontrolled changes on <code>N.M.P</code> , leading to a new version that is yet to be decided</p>
</li>
<li>
<p><code>N.M.P-rc.N</code>    - a <code>-rc.N</code> qualifier indicates a release candidate.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_validity"><a class="anchor" href="#_validity"></a>7.5.8. Validity</h4>
<div class="paragraph">
<p>The following syntax validity rule applies in the identification section:</p>
</div>
<div class="paragraph rule">
<p>SARID: archetype identifier validity. the identifier of the artefact must conform to the ARCHETYPE_ID identifier syntax defined in the <a href="https://specifications.openehr.org/releases/BASE/latest/base_types.html">openEHR BASE/Base Types Specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_generated_indicator"><a class="anchor" href="#_generated_indicator"></a>7.5.9. Generated Indicator</h4>
<div class="paragraph">
<p>A flag indicating whether the archetype was generated or authored can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">generated</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This marker is used to support the migration to differential archetype representation introduced in ADL 1.5, to enable proper representation of specialised archetypes. The 'generated' marker can be used on specialised archetypes - i.e. ADL 1.5 style .adls files - generated from flat archetypes - ADL 1.4 .adl files - and also in flat archetypes generated from differential files, by an inheritance-flattening process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_controlled_indicator"><a class="anchor" href="#_controlled_indicator"></a>7.5.10. Controlled Indicator</h4>
<div class="paragraph">
<p>A flag indicating whether the archetype is change-controlled or not can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">controlled</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">org.openehr::openEHR-EHR-OBSERVATION.haematology.v1.2.0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag may have the two values <code>controlled</code> and <code>uncontrolled</code> only, and is an aid to authoring tools, but has no semantic significance. Tools may treat archetypes with an <code>uncontrolled</code> flag as not needing version control, whereas archetypes containing the <code>controlled</code> flag should be versioned on every change. This enables archetypes to be repeatedly edited in early development without generating large version histories of little or no value.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_specialise_section"><a class="anchor" href="#_specialise_section"></a>7.6. Specialise Section</h3>
<div class="paragraph">
<p>This optional section indicates that the archetype is a specialisation of some other archetype, whose identity must be given. Only one specialisation parent is allowed, i.e. an archetype cannot 'multiply-inherit' from other archetypes. An example of declaring specialisation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.cbc.v1.0.0</span>
<span class="tok-gh">specialise</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology.v1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the identifier of the new archetype is derived from that of the parent by adding a new section to its domain concept section. See the <code>ARCHETYPE_ID</code> definition in the identification package in the <a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">openEHR Support IM specification</a>.</p>
</div>
<div class="paragraph">
<p>Note that both the US and British English versions of the word "specialise" are valid in ADL.</p>
</div>
<div class="paragraph">
<p>The following syntax validity rule applies in the specialisation section:</p>
</div>
<div class="paragraph rule">
<p>SASID: archetype specialisation parent identifier validity. for specialised artefacts, the identifier of the specialisation parent must conform to the ARCHETYPE_ID identifier syntax defined in the <a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">openEHR Support IM specification</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_language_section"><a class="anchor" href="#_language_section"></a>7.7. Language Section</h3>
<div class="paragraph">
<p>The <code>language</code> section includes meta-data describing the original language in which the archetype was authored (essential for evaluating natural language quality), and the total list of languages available in the archetype. There can be only one <code>original_language</code> . The <code>translations</code> list must be updated every time a translation of the archetype is undertaken. The following shows a typical example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">translations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">de</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Frederik Tyler&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;freddy@something.somewhere.co.uk&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">accreditation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;British Medical Translator id 00400595&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ru&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">ru</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Nina Alexandrovna&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dostoevsky Media Services&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nina@translation.dms.ru&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">accreditation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Russian Translator id 892230-3A&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Archetypes must always be translated completely, or not at all, to be valid. This means that when a new translation is made, every language dependent section of the <code>description</code> and <code>terminology</code> sections has to be translated into the new language, and an appropriate addition made to the <code>translations</code> list in the language section.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
some non-conforming ADL tools in the past created archetypes without a language section, relying on the terminology section to provide the original_language (there called primary_language) and list of languages (<code>languages_available</code>). In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_description_section"><a class="anchor" href="#_description_section"></a>7.8. Description Section</h3>
<div class="paragraph">
<p>The <code>description</code> section of an archetype contains descriptive information, or what some people think of as document "meta-data", i.e. items that can be used in repository indexes and for searching. The ODIN syntax is used for the description, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dr J Joyce&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NT Health Service&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2003-08-03</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;initial&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">resource_package_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.aihw.org.au/data_sets/diabetic_archetypes.html&quot;</span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;archetype for diabetic patient review&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">use</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;used for all hospital or clinic-based diabetic reviews,</span>
<span class="tok-w">                </span><span class="tok-nc">including</span><span class="tok-w"> </span><span class="tok-nc">first</span><span class="tok-w"> </span><span class="tok-nc">time</span><span class="tok-err">.</span><span class="tok-w"> </span><span class="tok-err">O</span><span class="tok-nc">ptional</span><span class="tok-w"> </span><span class="tok-nc">sections</span><span class="tok-w"> </span><span class="tok-nc">are</span><span class="tok-w"> </span><span class="tok-nc">removed</span><span class="tok-w"> </span><span class="tok-nc">according</span><span class="tok-w"> </span><span class="tok-nc">to</span><span class="tok-w"> </span><span class="tok-nc">the</span><span class="tok-w"> </span><span class="tok-nc">particular</span><span class="tok-w"> </span><span class="tok-nc">review</span><span class="tok-s">&quot;&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">misuse</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;not appropriate for pre-diagnosis use&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">original_resource_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">de</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Archetyp fr die Untersuchung von Patienten mit Diabetes&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">use</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;wird benutzt fr alle Diabetes-Untersuchungen im</span>
<span class="tok-w">                    </span><span class="tok-err">K</span><span class="tok-nc">rankenhaus</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">inklusive</span><span class="tok-w"> </span><span class="tok-nc">der</span><span class="tok-w"> </span><span class="tok-nc">ersten</span><span class="tok-w"> </span><span class="tok-err">V</span><span class="tok-nc">orstellung</span><span class="tok-err">.</span><span class="tok-w"> </span><span class="tok-err">O</span><span class="tok-nc">ptionale</span>
<span class="tok-w">                    </span><span class="tok-err">A</span><span class="tok-nc">bschnitte</span><span class="tok-w"> </span><span class="tok-nc">werden</span><span class="tok-w"> </span><span class="tok-nc">in</span><span class="tok-w"> </span><span class="tok-err">A</span><span class="tok-nc">bhngigkeit</span><span class="tok-w"> </span><span class="tok-nc">von</span><span class="tok-w"> </span><span class="tok-nc">der</span><span class="tok-w"> </span><span class="tok-nc">speziellen</span>
<span class="tok-w">                    </span><span class="tok-err">V</span><span class="tok-nc">orstellung</span><span class="tok-w"> </span><span class="tok-nc">entfernt</span><span class="tok-err">.</span><span class="tok-s">&quot;&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">misuse</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nicht geeignet fr Benutzung vor Diagnosestellung&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">original_resource_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of details are worth noting here. Firstly, the free hierarchical structuring capability of ODIN is exploited for expressing the 'deep' structure of the <code>details</code> section and its subsections. Secondly, the ODIN qualified list form is used to allow multiple translations of the <code>purpose</code> and <code>use</code> to be shown. Lastly, empty items such as <code>misuse</code> (structured if there is data) are shown with just one level of empty brackets. The above example shows meta-data based on the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html" target="_blank" rel="noopener">openEHR Archetype Object Model (AOM)</a>.</p>
</div>
<div class="paragraph">
<p>The <code>description</code> section is technically optional according to the AOM, but in any realistic use of ADL for archetypes, it will be required. A minimal description section satisfying to the AOM is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dr J Joyce&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NT Health Service&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2003-08-03</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;initial&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;archetype for diabetic patient review&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deprecated_sections"><a class="anchor" href="#_deprecated_sections"></a>7.9. Deprecated Sections</h3>
<div class="sect3">
<h4 id="_concept_section"><a class="anchor" href="#_concept_section"></a>7.9.1. Concept Section</h4>
<div class="paragraph">
<p>A 'concept' section was required up until ADL 1.4. In ADL 1.5, the concept section is deprecated, but allowed, enabling ADL 1.4 archetypes to be treated as valid. It will be removed in a future version of ADL, since it is completely redundant.</p>
</div>
<div class="paragraph">
<p>All archetypes represent some real world concept, such as a "patient", a "blood pressure", or an "ante-natal examination". The concept is always coded, ensuring that it can be displayed in any language the archetype has been translated to. A typical <code>concept</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>concept [at0000] -- haematology result</pre>
</div>
</div>
<div class="paragraph">
<p>In this concept definition, the term definition of <code>[at0000]</code> is the proper description corresponding to the "haematology-cbc" section of the archetype identifier above.</p>
</div>
<div class="paragraph">
<p>The following syntax validity rule applies to the concept section, if present, allowing parsers to correctly ignore it:</p>
</div>
<div class="paragraph rule">
<p>SACO: archetype concept validity: if a concept section is present, it must consist of the 'concept' keyword and a single local term.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_definition_section"><a class="anchor" href="#_definition_section"></a>7.10. Definition Section</h3>
<div class="paragraph">
<p>The <code>definition</code> section contains the main formal definition of the archetype, and is written in the Constraint Definition Language (cADL). A typical <code>definition</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                 </span><span class="tok-c">-- blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                         </span><span class="tok-c">-- any synonym of BP</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                              </span><span class="tok-c">-- history</span>
<span class="tok-w">                </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">POINT_EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">            </span><span class="tok-c">-- baseline</span>
<span class="tok-w">                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">at9003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                              </span><span class="tok-c">-- systemic arterial BP</span>
<span class="tok-w">                                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                        </span><span class="tok-c">-- systolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- any synonym of &#39;systolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">at9005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">          </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- diastolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                 </span><span class="tok-c">-- any synonym of &#39;diastolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">at9008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac3</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">   </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">           </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0016</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w">    </span><span class="tok-c">-- unknown new item</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">...</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                 </span><span class="tok-c">-- blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                         </span><span class="tok-c">-- any synonym of BP</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                              </span><span class="tok-c">-- history</span>
<span class="tok-w">                </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">POINT_EVENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">            </span><span class="tok-c">-- baseline</span>
<span class="tok-w">                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                              </span><span class="tok-c">-- systemic arterial BP</span>
<span class="tok-w">                                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                        </span><span class="tok-c">-- systolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- any synonym of &#39;systolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac2</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id12</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">          </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- diastolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                 </span><span class="tok-c">-- any synonym of &#39;diastolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-p">[</span><span class="tok-nd">id15</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac3</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id16</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">   </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">           </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id17</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w">    </span><span class="tok-c">-- unknown new item</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This definition expresses constraints on instances of the types <code>ENTRY</code> , <code>HISTORY</code> , <code>EVENT</code> , <code>ITEM_LIST</code> , <code>ELEMENT</code> , <code>QUANTITY</code> , and <code>CODED_TEXT</code> so as to allow them to represent a blood pressure measurement, consisting of a history of measurement events, each consisting of at least systolic and diastolic pressures, as well as any number of other items (expressed by the <code>[at0016]</code> (<code>[id17]</code>) "any" node near the bottom).</p>
</div>
<div class="sect3">
<h4 id="_design_time_and_run_time_paths"><a class="anchor" href="#_design_time_and_run_time_paths"></a>7.10.1. Design-time and Run-time paths</h4>
<div class="paragraph">
<p>All archetype object constraint nodes require a node identifier. When data are created according to the <code>definition</code> section of an archetype, the archetype node identifiers can be written into the data, providing a reliable way of finding data nodes, regardless of what other runtime names might have been chosen by the user for the node in question. There are two reasons for doing this. Firstly, querying cannot rely on runtime names of nodes (e.g. names like "sys BP", "systolic bp", "sys blood press." entered by a doctor are unreliable for querying); secondly, it allows runtime data retrieved from a persistence mechanism to be re-associated with the cADL structure which was used to create it.</p>
</div>
<div class="paragraph">
<p>An example which shows the difference between design-time meanings associated with node identifiers and runtime names is the following, from a <code>SECTION</code> archetype representing the problem/SOAP headings (a simple heading structure commonly used by clinicians to record patient contacts under top-level headings corresponding to the patient&#8217;s problem(s), and under each problem heading, the headings "subjective", "objective", "assessment", and "plan").</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- problem</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">       </span><span class="tok-c">-- any clinical problem type</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- problem</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">       </span><span class="tok-c">-- any clinical problem type</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the node identifier <code>[at0000]</code> (<code>[id1]</code>) is assigned a meaning such as "clinical problem" in the archetype terminology section. The subsequent lines express a constraint on the runtime <em>name</em> attribute, using the internal code <code>[ac1]</code> . The constraint <code>[ac1]</code> is also defined in the archetype terminology section with a formal statement meaning "any clinical problem type", which could clearly evaluate to thousands of possible values, such as "diabetes", "arthritis" and so on. As a result, in the runtime data, the node identifier corresponding to "clinical problem" and the actual problem type chosen at runtime by a user, e.g. "diabetes", can both be found. This enables querying to find all nodes with meaning "problem", or all nodes describing the problem "diabetes". Internal <code>[acN]</code> codes are described in <a href="#Local Constraint Codes">[Local Constraint Codes]</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules_section"><a class="anchor" href="#_rules_section"></a>7.11. Rules Section</h3>
<div class="paragraph">
<p>The <code>rules</code> section in an ADL archetype contains <em>statements</em> representing assertions and computational expressions that relate to the entire archetype. Assertions in the <code>rules</code> section represent constraints that are not possible within the block structure of the <code>definition</code> section. Any constraint that references more than one property is in this category, as are constraints or expressions containing mathematical or logical formulae. Archetype rules are a subset of the openEHR Basic Expression Language (BEL), described in the <a href="https://specifications.openehr.org/releases/LANG/latest/BEL.html" target="_blank" rel="noopener">openEHR BEL specification</a>.</p>
</div>
<div class="sect3">
<h4 id="_assertions"><a class="anchor" href="#_assertions"></a>7.11.1. Assertions</h4>
<div class="paragraph">
<p>Semantically, an assertion is a first order predicate logic statement which can be evaluated to a Boolean result at runtime. Objects and properties are referred to using paths within an assertion.</p>
</div>
<div class="paragraph">
<p>A reference to an object in data, including a leaf value, is expressed using an archetype path. All such paths are absolute (i.e. contain a leading '/') and are understood to be with respect to the root of the current archetype.</p>
</div>
<div class="paragraph">
<p>Types of assertions used in archetypes include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>arithmetic identities</em>: constraints involving more than one node in an archetype, such as an assertion stating that the sum of the five 0-2 value scores in an Apgar test (heart-rate, breathing, muscle tone, reflex, colour) is equal to the Apgar total, recorded in a sixth node;</p>
</li>
<li>
<p><em>mathematical formulae</em>: constraints involving a mathematical formulae that relate various items together, e.g. the pulse pressure and mean arterial pressure formulae used in cardiology;</p>
</li>
<li>
<p><em>value-dependent existence</em>: in some cases optional archetype nodes are intended to be mandatory (or occasionally non-existent) if some other element within the same archetype has a specific value, for example a sub-tree that records details of 'tobacco use' may be considered mandatory if an earlier Boolean node representing 'tobacco user?' has a positive value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these is described below.</p>
</div>
<div class="sect4">
<h5 id="_arithmetic_identities"><a class="anchor" href="#_arithmetic_identities"></a>7.11.1.1. Arithmetic Identities</h5>
<div class="paragraph">
<p>Assertions can be stated that make explicit intended arithmetic identities among value nodes in an archetype. For example, in an archetype representing <a href="https://en.wikipedia.org/wikiApgar_score">Apgar Score</a>, five values should sum to equal the total. This can be expressed as the following assertions:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>rules
	$respiratory_effort: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0009]/value[at9001]/value
    $heart_rate: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0005]/value[at9002]/value
    $muscle_tone: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0013]/value[at9003]/value
    $reflex_irritability: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0017]/value[at9004]/value
    $skin_colour: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0021]/value[at9005]/value
    $apgar_score: Integer := /data[at0002]/events[at0003]/data[at0001]/items[at0025]/value[at9006]/magnitude

    Apgar_total: $apgar_score = $respiratory_effort + $heart_rate + $muscle_tone + $reflex_irritability + $skin_colour</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>rules
	$respiratory_effort: Integer := /data[id3]/events[id4]/data[id2]/items[id10]/value[id39]/value
    $heart_rate: Integer := /data[id3]/events[id4]/data[id2]/items[id6]/value[id40]/value
    $muscle_tone: Integer := /data[id3]/events[id4]/data[id2]/items[id14]/value[id41]/value
    $reflex_irritability: Integer := /data[id3]/events[id4]/data[id2]/items[id18]/value[id42]/value
    $skin_colour: Integer := /data[id3]/events[id4]/data[id2]/items[id22]/value[id43]/value
    $apgar_score: Integer := /data[id3]/events[id4]/data[id2]/items[id26]/value[id44]/magnitude

    Apgar_total: $apgar_score = $respiratory_effort + $heart_rate + $muscle_tone + $reflex_irritability + $skin_colour</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_mathematical_formulae"><a class="anchor" href="#_mathematical_formulae"></a>7.11.1.2. Mathematical Formulae</h5>
<div class="paragraph">
<p>The following ADL example shows a <code>rules</code> section containing the Blood Pressure MAP and Pulse pressure formulae expressed using references to the relevant input and output values in the archetype.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $pulse_pressure: Real := /data[at0001]/events[at0006]/data[at0003]/items[at1007]/value/magnitude
    $mean_arterial_pressure: Real := /data[at0001]/events[at0006]/data[at0003]/items[at1006]/value/magnitude
    $systolic_value: Real := /data[at0001]/events[at0006]/data[at0003]/items[at0004]/value/magnitude
    $diastolic_value: Real := /data[at0001]/events[at0006]/data[at0003]/items[at0005]/value/magnitude

	MAP_valid: $mean_arterial_pressure = $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)

	pulse_pressure: $pulse_pressure = $systolic_value - $diastolic_value</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $pulse_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1008]/value/magnitude
    $mean_arterial_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1007]/value/magnitude
    $systolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id5]/value/magnitude
    $diastolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id6]/value/magnitude

	MAP_valid: $mean_arterial_pressure = $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)

	pulse_pressure: $pulse_pressure = $systolic_value - $diastolic_value</pre>
</div>
</div>
<div class="paragraph">
<p>These assertions can be visualised in tools, e.g. as follows in the <a href="https://www.openehr.org/downloads/ADLworkbench">ADL Workbench</a>.</p>
</div>
<div id="assertions_bp_map_pp.png" class="imageblock text-center text-center">
<div class="content">
<img src="ADL2/images/assertions_bp_map_pp.png" alt="assertions bp map pp" width="70%">
</div>
<div class="title">Figure 4. ADL assertion examples</div>
</div>
<div class="paragraph">
<p>More complex assertions make use of <em>variable sub-paths</em> and the <code>for_all</code> operator to check multiple values in a repeated structure, as in this example.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>    -- ensure that each mean arterial pressure value in a series of blood pressures
    -- has the correct value.
	for_all $event : /data[at0001]/events
		$event/data[at0003]/items[at1006]/value/magnitude =
			$event/data[at0003]/items[at0005]/value/magnitude + 0.33 *
                ($event/data[at0003]/items[at0004]/value/magnitude - $event/data[at0003]/items[at0005]/value/magnitude)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>    -- ensure that each mean arterial pressure value in a series of blood pressures
    -- has the correct value.
	for_all $event : /data[id2]/events
		$event/data[id4]/items[id1007]/value/magnitude =
			$event/data[id4]/items[id6]/value/magnitude + 0.33 *
                ($event/data[id4]/items[id5]/value/magnitude - $event/data[id4]/items[id6]/value/magnitude)</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the evolution toward separation of data context paths and expressions will enable this kind of expression to be made more readable in future.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_value_dependent_existence"><a class="anchor" href="#_value_dependent_existence"></a>7.11.1.3. Value-dependent Existence</h5>
<div class="paragraph">
<p>One specific type of logical expression that is commonly required in archetypes is used to state the mandation (or otherwise) of certain data points as conditional on another specific data point. An example is an archetype that documents Tobacco use. This will normally contain a data point representing substance 'use status', which may have values such as 'never used', 'occasional user', 'frequent user', etc.; and another set of data points quantifying the use. Clearly, if the 'use status' is 'never', the latter set of data is not needed; conversely, if 'use status' is any other value, the quantifying data items are needed. To make them mandatory if the 'use status' is any value other than 'never used', rules like the following can be used.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $substance_use_status: Boolean := /data[at0001]/items[at0002]/value[at90001]
    $substance_use_data: Object_ref := /data[at0001]/items[at0007|details of use|]

    Substance_use: $substance_use_status /= [at0016|never used|] implies
        exists /data[at0001]/items[at0007|details of use|]</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $substance_use_status: Boolean := /data[id2]/items[id3]/value[id18]
    $substance_use_data: Object_ref := /data[id2]/items[id8|details of use|]

    Substance_use: $substance_use_status /= [at17|never used|] implies
        exists /data[id2]/items[id8|details of use|]</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_computational_statements"><a class="anchor" href="#_computational_statements"></a>7.11.2. Computational Statements</h4>
<div class="paragraph">
<p>The <code>rules</code> section may also include computational statements that can be used to compute values for specific fields, generally based on some published algorithm, rather than just asserting a relationship between various fields. The following shows a set of statements similar to the example above, but with the field bound to <code>$mean_arterial_pressure</code> now having its value set, not just tested. The assignment operator (<code>:=</code>) is used to achieve this.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $mean_arterial_pressure: Real := /data[at0001]/events[at0006]/data[at0003]/items[at1006]/value/magnitude
    $systolic_value: Real := /data[at0001]/events[at0006]/data[at0003]/items[at0004]/value/magnitude
    $diastolic_value: Real := /data[at0001]/events[at0006]/data[at0003]/items[at0005]/value/magnitude

	$mean_arterial_pressure := $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre>rules
    $mean_arterial_pressure: Real := /data[id2]/events[id7]/data[id4]/items[id1007]/value/magnitude
    $systolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id5]/value/magnitude
    $diastolic_value: Real := /data[id2]/events[id7]/data[id4]/items[id6]/value/magnitude

	$mean_arterial_pressure := $diastolic_value + 0.33 * ($systolic_value - $diastolic_value)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rm_overlay_section"><a class="anchor" href="#_rm_overlay_section"></a>7.12. RM Overlay Section</h3>
<div class="paragraph">
<p>Most content in an archetype consists of constraints expressed as an attribute/object structure based on a Reference Model. However, sometimes related meta-data need to be stated with respect to unconstrained RM attributes and paths. Such statements can be made in the <code>rm_overlay</code> section of an archetype, which is designed to be extensible. Specific categories of statement or constraint relating to RM attribute paths can be stated within dedicated sub-sections.</p>
</div>
<div class="sect3">
<h4 id="_rm_visibility"><a class="anchor" href="#_rm_visibility"></a>7.12.1. RM Visibility</h4>
<div class="paragraph">
<p>One of the basic characteristics of any underlying information model which may be archetyped is that its class attributes are already named, typically in English, if the model is internationally shared or standardised. Archetyping solves effective renaming and language-independence of object nodes, via the mechanism of at-codes (id-codes), but attribute names are by default unchangeable and mono-lingual. Experience in archetype-based modelling has shown that renaming of RM attributes within the context of an archetype is a common need, usually because the attribute name chosen in the original model is not sufficiently specific for the users of a particular archetype. An example is the <a href="https://specifications.openehr.org/releases/RM/latest/ehr.html#\_composition_package" target="_blank" rel="noopener">openEHR class <code>COMPOSITION</code></a>, which has an attribute <code><em>composer</em></code>. For particular archetypes corresponding to specific sub-domains in healthcare, or specific geographies, a preferable name may be <code><em>author</em></code>; additionally, any such name (even the original) may be needed in multiple languages.</p>
</div>
<div class="paragraph">
<p>In ADL, re-labelling of RM attributes is called <em>aliasing</em>, and is achieved by mentioning an RM attribute path in the archetype and associating an alias with it, in the form of an at-code, defined according to the usual rules of specialisation. Aliasing may apply to any valid RM path in the archetype, i.e. any path through RM objects referenced in the archetype. If archetype-specific nodes are referenced in a path, the settings relate to those paths only in the data, but if not, the settings relate to any matching RM path through the data.</p>
</div>
<div class="paragraph">
<p>A second need, related to the above, is that archetype modellers sometimes need to know what elements are already in an information model, so they don&#8217;t try to remodel them again as redundant object nodes. In a simple implementation of an archetype authoring tool, attributes not so far archetyped will be all hidden, perhaps with a possibility of showing them all. However, commonly, finer-grained control is needed whereby particular attributes, possibly only on <em>particular object nodes</em> need to be made visible in a modelling tool, in order to indicate they need not be modelled.</p>
</div>
<div class="paragraph">
<p>For this reason a 'show' marker can be associated with the path of an non-constrained RM attribute, causing it to be made visible in a modelling tool. Taking into account archetype and template specialisation, it should also be possible to add a 'hide' marker, in order to hide an attribute marked as 'show' in a specialisation parent. It has also been found by experience that sometimes a constrained RM attribute from a parent archetype needs to be hidden in a specialisation child. Thus, the general case is that 'hide' and 'show' markers can be associated with any RM attribute path (constrained or unconstrained) in the archetype.</p>
</div>
<div class="paragraph">
<p>Since both of these needs relate to the visibility of RM attributes in an archetype, and are specfied in terms of RM attribute paths, an <code>rm_overlay</code> sub-section called <code>rm_visibility</code> is used to specify them. The following example illustrates the use of this section to force visibility and aliasing of one attribute, and hiding of another attribute within an archetype.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">rm_overlay</span>
<span class="tok-w">    </span><span class="tok-nc">rm_visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/path/to[at0003]/archetype/node[at0212]/path/to/rm/attribute&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;show&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">alias</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at0011</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/path/to[at0004]/archetype/node[at0063]/path/to/rm/attribute&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;hide&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-nc">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;name in English&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;description in English&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;name in German&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;description in German&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">rm_overlay</span>
<span class="tok-w">    </span><span class="tok-nc">rm_visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/path/to[id4]/archetype/node[id213]/path/to/rm/attribute&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;show&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">alias</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at12</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/path/to[id5]/archetype/node[id64]/path/to/rm/attribute&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">visibility</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;hide&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-nc">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;name in English&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;description in English&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;name in German&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;description in German&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_terminology_section"><a class="anchor" href="#_terminology_section"></a>7.13. Terminology Section</h3>
<div class="sect3">
<h4 id="_overview_4"><a class="anchor" href="#_overview_4"></a>7.13.1. Overview</h4>
<div class="paragraph">
<p>This section describes the syntax of the <code>terminology</code> section of an archetype. The following section, <a href="#_terminology_integration">Section 8</a> describes the semantics.</p>
</div>
<div class="paragraph">
<p>The <code>terminology</code> section of an archetype is expressed in ODIN, and is where codes representing node identifiers, constraints on coded term values, and bindings to terminologies are defined. Linguistic language translations are added in the form of extra blocks keyed by the relevant language. The following example shows the general layout of this section.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id4&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_term_definitions_sub_section"><a class="anchor" href="#_term_definitions_sub_section"></a>7.13.2. Term_definitions Sub-section</h4>
<div class="paragraph">
<p>The <code>term_definitions</code> section is mandatory, and must contain definitions for all terms requiring them, in all translations in use in the archetype. Terms requiring definitions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for at-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p>all at-codes</p>
</li>
<li>
<p>all ac-codes</p>
</li>
</ul>
</div>
</li>
<li>
<p>for id-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p>all id-codes of object nodes under a container attribute or which are multiple alternative siblings under a single-valued attribute</p>
</li>
<li>
<p>all at-codes</p>
</li>
<li>
<p>all ac-codes</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following example shows an extract from the English and German term definitions for the archetype local terms in a problem/SOAP headings archetype. Each term is defined using a structure of name/value pairs, and must at least include the names "text" and "description", which correspond to the usual rubric and full definition found in terminologies like <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a>. Each term object is then included in the appropriate language list of term definitions, as shown in the example below.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The problem experienced by the subject of care to which the contained information relates&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem/SOAP headings&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP heading structure for multiple problems&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;klinisches Problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Das Problem des Patienten worauf sich diese Informationen beziehen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Problem/SOAP Schema&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP-Schlagwort-Gruppierungsschema fuer mehrfache Probleme&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Klinisch-professionelle Beratung des Pflegenden&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The problem experienced by the subject of care to which the contained information relates&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem/SOAP headings&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP heading structure for multiple problems&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;klinisches Problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Das Problem des Patienten worauf sich diese Informationen beziehen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Problem/SOAP Schema&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP-Schlagwort-Gruppierungsschema fuer mehrfache Probleme&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Klinisch-professionelle Beratung des Pflegenden&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In some cases, term definitions may have been lifted from existing terminologies (only a safe thing to do if the definitions <em>exactly</em> match the need in the archetype). To indicate where definitions come from, a "provenance" tag can be used, as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">provenance</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ACME_terminology(v3.9a)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">provenance</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ACME_terminology(v3.9a)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this does not indicate a <em>binding</em> to any term, only the origin of its definition. Bindings are described below.</p>
</div>
<div class="paragraph">
<p>The <code>term_definitions</code> section also includes definitions for archetype-local constraint codes, which are of the form <code>[acN]</code> in the <code>definition</code> part of an archetype. Each such code refers to a terminology 'value set', i.e. a set of possible terms that could be used as the value of the data item being constrained. These constraints are defined in two parts. First, the <code>ac</code> code itself is defined - this names the value set. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-c">--- within a specialist diagnosis archetype</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;type of hepatitis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;any term which means a kind of viral hepatitis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--- within a blood pressure measurement archetype</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;patient position&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;patient position for blood pressure measurement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_value_sets_sub_section"><a class="anchor" href="#_value_sets_sub_section"></a>7.13.3. Value_sets Sub-section</h4>
<div class="paragraph">
<p>The second part is the value set contents. This can be defined either as an 'internal' value set consisting of at-codes, or else as being a value set defined in an external terminology and referenced via a binding. An internal value set is defined using an entry in the <code>value_sets</code> sub-section for the <code>ac</code> code, containing a list of at-code member values. Each of those members must have its own definition in the <code>term_definitions</code> section. The following shows the structures required.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at1&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at2&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at3&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_term_bindings_sub_section"><a class="anchor" href="#_term_bindings_sub_section"></a>7.13.4. Term_bindings Sub-section</h4>
<div class="paragraph">
<p>A value set and/or its constituent terms may also have 'bindings' to externally defined terms and values sets. Object node id-codes may also have bindings, establishing external codings for the names of elements in an archetype. Binding is achieved in the <code>term_bindings</code> sub-section. Bindings are grouped under the target terminology they relate to, and each one consists of a key and a target. There are variations of each.</p>
</div>
<div class="paragraph">
<p>Keys can be any one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for at-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p>an at-code;</p>
</li>
<li>
<p>an object node absolute path terminating in an at-code, e.g. <code>"/data[at0001]/events[at0002]/data[at0003]/item[at0004]"</code>;</p>
</li>
<li>
<p>an ac-code.</p>
</li>
</ul>
</div>
</li>
<li>
<p>for id-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p>for id-coded object nodes:</p>
<div class="ulist">
<ul>
<li>
<p>just the id-code, e.g. <code>id4</code>;</p>
</li>
<li>
<p>an object node  absolute path terminating in an id-code, e.g. <code>"/data[id2]/events[id3]/data[id1]/item[id4]"</code>;</p>
</li>
</ul>
</div>
</li>
<li>
<p>an at-code;</p>
</li>
<li>
<p>an ac-code.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Binding targets are expressed as URIs that follow the model for <a href="https://confluence.ihtsdotools.org/display/DOCURI/URI+Standard">terminology URIs published by IHTSDO</a> or a similar model, in the case of terminologies other than <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a>. Because URIs are native types in ADL/ODIN, they do not need quotes.</p>
</div>
<div class="paragraph">
<p>Bindings may be defined for a given set of terms for more than one terminology, enabling the different bindings to be used in different contexts, e.g. hospital deployment versus aged care.</p>
</div>
<div class="paragraph">
<p>The following is an extract from a <a href="https://github.com/openEHR/adl-archetypes/blob/master/ADL2-reference/features/terminology/term_bindings/openEHR-EHR-OBSERVATION.term_bindings_paths_use_refs.v1.adls" target="_blank" rel="noopener">test archetype</a> based on the openEHR Apgar archetype, showing the different types of bindings:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Derived from openEHR-EHR-OBSERVATION.term_bindings_paths_use_refs.v1.adls</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical score derived from assessment of respiratory effort, heart rate, reflex irritability, muscle_tone tone and skin skin_colour.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;1 minute&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score 1 minute after birth.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Heart Rate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Recording of the infant&#39;s heart rate.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0025&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Total&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The sum of the 5 ordinal scores for each component parameter.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0026&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Absent&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No heart beat is seen, felt or heard.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0003]/data[at0001]/items[at0025]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomedct.info/id/169895004</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Apgar score at 1 minute</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0025&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomedct.info/id/249228009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Total Apgar score (observable entity)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;loinc&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at002]/events[at0003]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/48334-7</span><span class="tok-p">&gt;</span><span class="tok-w">   </span><span class="tok-c">-- 1-minute Apgar panel</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at002]/events[at0003]/data[at0001]/items[at0005]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/32407-9</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 1 minute Apgar Heart rate</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/LA6716-0</span><span class="tok-p">&gt;</span><span class="tok-w">  </span><span class="tok-c">-- No heart rate</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;umls&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://umls.nlm.edu/id/C124305</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- apgar result</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://umls.nlm.edu/id/C234305</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- cardiac score</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- Derived from openEHR-EHR-OBSERVATION.term_bindings_paths_use_refs.v1.adls</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical score derived from assessment of respiratory effort, heart rate, reflex irritability, muscle_tone tone and skin skin_colour.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id4&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;1 minute&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Apgar score 1 minute after birth.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id6&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Heart Rate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Recording of the infant&#39;s heart rate.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id26&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Total&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The sum of the 5 ordinal scores for each component parameter.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at7&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Absent&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No heart beat is seen, felt or heard.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id3]/events[id4]/data[id2]/items[id26]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomedct.info/id/169895004</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Apgar score at 1 minute</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id26&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomedct.info/id/249228009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Total Apgar score (observable entity)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;loinc&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id3]/events[id4]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/48334-7</span><span class="tok-p">&gt;</span><span class="tok-w">   </span><span class="tok-c">-- 1-minute Apgar panel</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id3]/events[id4]/data[id2]/items[id6]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/32407-9</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 1 minute Apgar Heart rate</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at7&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/LA6716-0</span><span class="tok-p">&gt;</span><span class="tok-w">  </span><span class="tok-c">-- No heart rate</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;umls&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://umls.nlm.edu/id/C124305</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- apgar result</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id6&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://umls.nlm.edu/id/C234305</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- cardiac score</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The reason for code and path keys for at-codes (id-codes) is to enable two types of code bindings. A binding to a simple code such as <code>at0025|Total|</code> (<code>id26|Total|</code>), above, means that the bound term (referred to by the URI <code><a href="http://snomedct.info/id/249228009" class="bare">http://snomedct.info/id/249228009</a></code>) has a context-independent correlation to the code. However, a 'pre-coordinated' code such as <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a> <code>169895004|Apgar score at 1 minute|</code> cannot be bound just to <code>at0025|Total|</code> (<code>id26|Total|</code>), but rather to the node representing the 1-minute total, i.e. at the path <code>/data[at0002]/events[at0003|1 minute|]/data[at0001]/items[at0025]</code> (<code>/data[id3]/events[id4|1 minute|]/data[id2]/items[id26]</code>). Such paths can be considered as equivalent to a 'post-coordinated' code, and thus the binding establishes a correspondence between an internal post-coordination and an external pre-coordinated code.</p>
</div>
<div class="paragraph">
<p>In the example shown below, the <code>at0003</code> (<code>id4</code>) code identifies a 'temperature' node in an archetype, and the codes <code>at0002</code>, <code>at0004</code>, <code>at0005</code> (<code>id3</code>, <code>id5</code>, <code>id6</code>) etc correspond to various times such as 'any', '1-hour average', '1-hour maximum' and so on. Some terminologies (notably <a href="http://loinc.org" target="_blank" rel="noopener">LOINC</a>, the laboratory terminology in this example) define pre-coordinated codes, such as '1 hour body temperature'; these clearly correspond not to single codes such as <code>at0003</code> (<code>id4</code>) in the archetype, but to whole paths.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;LNC205&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w">   </span><span class="tok-c">-- LNC205 is a namespace corresponding to LOINC 205</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0001]/events[at0002]/data[at0007]/item[at0003]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8310-5</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0001]/events[at0004]/data[at0007]/item[at0003]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8321-2</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0001]/events[at0005]/data[at0007]/item[at0003]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8311-3</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;LNC205&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w">   </span><span class="tok-c">-- LNC205 is a namespace corresponding to LOINC 205</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id2]/events[id3]/data[id1]/item[id4]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8310-5</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id2]/events[id5]/data[id1]/item[id4]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8321-2</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id2]/events[id6]/data[id1]/item[id4]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://loinc.org/id/8311-3</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Bindings to external value sets are also included in the bindings section, also as URIs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/123456789</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/987654321</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, each local constraint code is formally defined to refer to a value set whose identifier is known in the <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a> terminology.</p>
</div>
<div class="paragraph">
<p>The next section describes the semantics of term constraining, value sets and binding in some detail.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deprecated_terminology_section_features"><a class="anchor" href="#_deprecated_terminology_section_features"></a>7.13.5. Deprecated Terminology Section Features</h4>
<div class="sect4">
<h5 id="_at_codes_as_identifiers"><a class="anchor" href="#_at_codes_as_identifiers"></a>7.13.5.1. At-codes as identifiers</h5>
<div class="paragraph">
<p>In at-coded ADL2 archetypes at-codes are used as code values as well as node identifiers. In id-coded ADL2 archetypes at-codes are used only as code values, not node identifiers. Id-codes are used for the latter purpose, providing a clearer separation between node 'names' and node 'values', for the kind of nodes whose values are coded terms.</p>
</div>
</div>
<div class="sect4">
<h5 id="_terminologies_available_sub_section"><a class="anchor" href="#_terminologies_available_sub_section"></a>7.13.5.2. Terminologies_available sub-section</h5>
<div class="paragraph">
<p>In ADL 1.4, a <code>terminologies_available</code> header statement was required to identify all terminologies for which <code>term_bindings</code> sections have been written. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    terminologies_available = &lt;"snomed_ct", "loinc"&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This is no longer required. In archetypes that have it, it is ignored, and should not be included in ADL 2 or later syntax output serialisation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_separated_definitions_and_bindings_sub_sections"><a class="anchor" href="#_separated_definitions_and_bindings_sub_sections"></a>7.13.5.3. Separated definitions and bindings sub-sections</h5>
<div class="paragraph">
<p>In ADL 1.4, there were two separate definitions sections, <code>term_definitions</code> and <code>constraint_definitions</code>, used to defined <code>at</code> and <code>ac</code> codes respectively. In ADL 2, these are merged into one <code>term_definitions</code> section, containing the definitions for <code>id</code>, <code>at</code> and <code>ac</code> codes. Similarly there were bindings sections, <code>term_bindings ` and `constraint_bindings</code>. These have been merged into one <code>term_bindings</code> section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_term_definitions_structure"><a class="anchor" href="#_term_definitions_structure"></a>7.13.5.4. Term_definitions Structure</h5>
<div class="paragraph">
<p>The following shows the structure of the terminology section used in ADL 1.4 archetypes. The extra <code>items</code> attribute notes are removed by ADL 2 tools, and should be considered deprecated.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_annotations_section"><a class="anchor" href="#_annotations_section"></a>7.14. Annotations Section</h3>
<div class="paragraph">
<p>The <code>annotations</code> section of an archetype or template provides a place for ad hoc node-level meta-data to be added. This can be used during the design phase to track dependencies, design decisions, and specific resource references.</p>
</div>
<div class="paragraph">
<p>Annotations are divided into major named groups. Currently a <code>documentation</code> group is defined, intended for documentary (i.e. human-readable text) annotations. Other groups are likely to be defined in the future for various kinds of processing, where the annotations may be formal expressions or code fragments.</p>
</div>
<div class="paragraph">
<p>Each annotation is keyed by a path, and may have any number of tagged elements. The path key can either be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the path of the archetype node being annotated, or</p>
</li>
<li>
<p>a pure RM path</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The usual case is the first, since annotations mainly relate to nodes in an archetype. However, it may be the case that within the context of the archetype, there is a need to refer to a part of the Reference Model type on which the archetype is based (<code>OBSERVATION</code>, <code>EVALUATION</code> etc) that <em>is not</em> constrained within the archetype, in order to indicate how it is to be understood within that archetyped structure (remember that an archetype does not need to constrain all possible paths of an information model class, but that such structures may nevertheless be instantiated).</p>
</div>
<div class="paragraph">
<p>A typical <code>annotations</code> section looks as follows (<a href="https://github.com/openEHR/adl-archetypes/blob/master/ADL2-reference/features/description/annotations/openEHR-EHR-EVALUATION.annotations_1st_child.v1.adls" target="_blank" rel="noopener">archetype source</a>). The <code>/subject</code> path is a non-constrained 'RM path'.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-c">--</span>
<span class="tok-c">-- Extract from test archetype openEHR-EHR-EVALUATION.annotations_1st_child.v1.0.0</span>
<span class="tok-c">--</span>
<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Exclusion statement - Adverse Reaction</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- No known allergic reaction to</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000.6</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0.10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- No known intolerance to</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000.8</span><span class="tok-p">]</span><span class="tok-w">     </span><span class="tok-c">-- No known allergic reaction to</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">annotations</span>
<span class="tok-w">    </span><span class="tok-nc">documentation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/subject&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;xxxxxx&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0001]/items[at0.8]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a design note on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;requirements note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a requirements note on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;medline ref&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a medline ref on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0001]/items[at0.10]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a design note on intolerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;requirements note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a requirements note on intolerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;national data dictionary&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NDD ref for intolerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-c">--</span>
<span class="tok-c">-- Extract from test archetype openEHR-EHR-EVALUATION.annotations_1st_child.v1.0.0</span>
<span class="tok-c">--</span>
<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Exclusion statement - Adverse Reaction</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id0.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- No known allergic reaction to</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id0.6</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id0.10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- No known intolerance to</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id0.8</span><span class="tok-p">]</span><span class="tok-w">     </span><span class="tok-c">-- No known allergic reaction to</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">annotations</span>
<span class="tok-w">    </span><span class="tok-nc">documentation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/subject&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;xxxxxx&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id2]/items[id0.8]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a design note on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;requirements note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a requirements note on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;medline ref&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a medline ref on allergic reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[id2]/items[id0.10]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;design note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a design note on intelerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;requirements note&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;this is a requirements note on intolerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;national data dictionary&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NDD ref for intolerance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because annotations are defined as a separate section, they can be easily removed in production versions of an archetype or template, and ignored in the generation of digital signatures.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_terminology_integration"><a class="anchor" href="#_terminology_integration"></a>8. Terminology Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Previous sections have provided the syntax possibilities for expressing terminological constraints, definitions, value sets and bindings in an archetype. This section describes the semantics of constraints on terminological entities, and how these constraints are resolved to concrete sets of terms.</p>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>8.1. Requirements</h3>
<div class="paragraph">
<p>The semantic needs of archetypes with respect to terminology are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to identify, i.e. 'name', nodes;</p>
</li>
<li>
<p>to define possible values for nodes whose value is coded;</p>
</li>
<li>
<p>to define the relationship of coded elements in an archetype to external terminologies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Achieving these in a mechanical sense is easy enough, however there are various sources of complexity that complicate things. The first most basic point is the one which motivated the separation of internal and external codes in the original design of ADL: no terminology can be relied on to provide all or even most coded entities within a given archetype. The main reason is not so much that terminologies are limited (major terminologies such as <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a>, <a href="http://loinc.org" target="_blank" rel="noopener">LOINC</a>, <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICD11</a> are quite extensive) but that archetypes are used to create pragmatic, often variable, pattern structures for information; and that such patterns can easily be too variable and/or detailed to have anything but patchy coverage by published terminologies and ontologies (e.g. the OBO ontologies such as <a href="https://code.google.com/p/ogms/" target="_blank" rel="noopener">OGMS</a>).</p>
</div>
<div class="paragraph">
<p>Although some terminology aficionados like to think that one day every element of an information model can be identified using codes from an external terminology, the reality is that it is unlikely. Information structures are fractal, because the things they report on (entities and processes) are fractal - someone always wants to record more details that are not defined in any terminology. A deeper reason is that the relationship between information elements and terminology and ontology entities is (or should be) primarily based on the 'is-about' relation, and this is clearly an irreflexive N:1 relationship, not an equivalence.</p>
</div>
<div class="paragraph">
<p>Another aspect of the messy reality of terminologies is the patchy availability and correctness (particularly for specific use contexts) of value sets that can be used as data values for codable data points. The major terminologies in healthcare do provide good quality hierarchies (and thus, in theory, value sets) for many core concepts such as disease, finding, procedure, lab result, medication and so on. These hierarchies (and usually any derived value set) may contain very large numbers of terms (consider the number of drug types, types of infectious disease etc), and terminologies such as <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICD10AM</a> or <a href="http://www.snomed.org" target="_blank" rel="noopener">SNOMED CT</a>, <a href="http://loinc.org" target="_blank" rel="noopener">LOINC</a>, <a href="http://www.who.int/classifications/icd/adaptations/icpc2/en/" target="_blank" rel="noopener">ICPC</a> and others are the only realistic way to express such large value sets. Unfortunately, there is a very large number of 'small', pragmatic value sets needed in healthcare as well, for things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>patient position when measuring blood pressure;</p>
</li>
<li>
<p>types of BP measuring cuff;</p>
</li>
<li>
<p>possible value sets for data points in 'scores' such as Apgar, Barthel, Waterlow etc;</p>
</li>
<li>
<p>numerous small value sets to do with physical examinations, hearing and eye tests;</p>
</li>
<li>
<p>numerous small value sets classifying results statuses, reporting status and so on;</p>
</li>
<li>
<p>most multiple-value fields on forms other than key items such as 'presenting condition'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This category corresponds to value sets that are a) small enough to be easily created in an archetype; b) typically not available in external terminologies; c) typically very specific to the archetype topic or use. These value sets are more numerous by orders of magnitude than the 'large' kind, and are only sparsely represented in published terminologies.</p>
</div>
<div class="paragraph">
<p>The next source of complexity is that terminologies may contain errors, some which are only known by some users, or even if recognised by the authors, cannot be easily addressed without major structural changes, and therefore won&#8217;t be corrected quickly. This implies that solution systems have to be able to employ workarounds.</p>
</div>
<div class="paragraph">
<p>A final complication is to do with commercial licensing of terminology. Archetypes cannot (at least currently) be developed on the assumption that all, or even most, users of an archetype have legal and technical access to a given terminology. This means that the archetype formalism and tools need to enable archetypes to work in either situation.</p>
</div>
<div class="paragraph">
<p>In sum, external terminologies address certain types of information very well, and many other elements only weakly or variably. The problem is that a good deal of the domain information modelled by archetypes is outside the areas of strength of external terminologies.</p>
</div>
<div class="paragraph">
<p>Taken together, these issues necessitate a design strategy that doesn&#8217;t rely in the first instance on external terminologies to provide either identifiers (names of things), values (taken individually) or explicit value sets. Instead, archetypes rely on internal coding of all identifiable elements (nodes with at-codes/id-codes), as well as the availability of a mechanism for defining at least the 'small' value sets - the ac- and at-codes.</p>
</div>
<div class="paragraph">
<p>Connection with external terminology is managed using in the <code>term_binding</code> section described earlier, and also via transformation from archetypes and template to the deployable operational template. The sections below describe various use cases for terminology constraint, binding and deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_term_constraint_basics"><a class="anchor" href="#_term_constraint_basics"></a>8.2. Term Constraint Basics</h3>
<div class="paragraph">
<p>Expressing terminology constraints in cADL was briefly described in <a href="#cADL_Terminology_Constraints">Section 4.5.10</a>. Constraints in the <code>definition</code> section of an archetype are only a small part of the picture. The targets of the at- and ac- codes are defined in the archetype <code>terminology</code> section, potentially with bindings to external terminology. In order to illustrate the approach clearly, the cADL example from earlier is repeated here, minus the node containing the assumed value, and this time with an extract from the terminology section.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-c">--</span>
<span class="tok-c">-- extract of openehr-ehr-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-c">--</span>
<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at0004</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Specific Substance/Agent&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Specific identification of the actual Substance/Agent considered to be responsible for the Adverse Reaction event.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Substance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Physical substance.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Type of substance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Type of substance that was the cause of the Adverse Reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Pollen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Pollen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Insect allergen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Insect allergen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Animal protein&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Animal protein.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plant material&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plant material.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dust&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dust.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-c">--</span>
<span class="tok-c">-- extract of openehr-ehr-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-c">--</span>
<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at5</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id55</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id11&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Specific Substance/Agent&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Specific identification of the actual Substance/Agent considered to be responsible for the Adverse Reaction event.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at5&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Substance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Physical substance.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Type of substance&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Type of substance that was the cause of the Adverse Reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Pollen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Pollen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Insect allergen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Insect allergen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Animal protein&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Animal protein.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plant material&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plant material.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dust&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dust.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The at- and ac- codes (and id-codes for id-coded archetypes) in the above are defined in the archetype terminology in the normal way (noting that codes <code>at9000</code> and <code>at9001</code> (<code>id8</code> and <code>id55</code>) do not need local terminology definitions, following the rules described earlier<a href="#_node_identifiers_2">Section 4.3.4.1</a>), with various possibilities for defining and binding the value set denoted by the code <code>ac1</code>. Below is shown the first alternative: local value-set definition.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #1: purely local definition</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #1: purely local definition</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>value_sets</code> sub-section shows the definition of the <code>ac1</code> value set as containing the five codes <code>at0009</code> - <code>at0013</code> (<code>at10</code> - <code>at14</code>) (note: this does not attempt to be clinically complete). A local value set definition is part of the archetype, and has no reliance on external terminology. For many value sets, definition in the archetype is the only option available either due to their arbitrary contents, specificity (to the archetype) or the simple practical fact that no-one has done the work to create them elsewhere.</p>
</div>
<div class="paragraph">
<p>The next variation is that bindings are found for the at-codes from a terminology such as SNOMED CT. This would enable the code chosen at runtime in the system using the archetype to be mapped to a SNOMED CT code.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
it is quite common that only <em>some</em> of the local at-codes have equivalents in the external terminology, especially if the archetype has a more fine-grained coding of the concept in question. In general, the availability of any external codes for a given internal code doesn&#8217;t imply that the value set has full coverage by the terminology.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">         </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #2: add individual bindings to member terms</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406464007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Pollen allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406470001</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Insect allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406472009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Animal protein and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410981007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Plant extract and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410980008</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Dust allergen (substance)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">         </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #2: add individual bindings to member terms</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406464007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Pollen allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406470001</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Insect allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406472009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Animal protein and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410981007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Plant extract and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410980008</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Dust allergen (substance)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the bindings are only usable if SNOMED CT is available in the execution environment. A very general clinical archetype such as for allergic reaction is likely to be deployed in all kinds of environments, including those with no SNOMED CT, so a local definition has utility in at least some locations.</p>
</div>
<div class="paragraph">
<p>Clearly, some value sets, including the one above for allergen substances, are likely to be more widely applicable than a single archetype, and may require proper analysis and maintenance to be correct (for one thing, we are likely to discover new types of allergen). Additionally, the total value sets for things like allergens, disease types and so on are likely to be <em>structured hierarchies</em>, such as may be found in the SNOMED CT terminology, not simple flat lists.</p>
</div>
<div class="paragraph">
<p>This provides the basis for the next variant. Assuming that an external value set is explicitly created, in this case within SNOMED CT or one of its extensions, the archetype may now include a binding to the value set. Remembering that some archetype users may have no access to the terminology, the local definition may be left intact. The external value set may of course be richer than the internal one, typically containing a deeper hierarchy, but as long as the local definition contains the top-level terms, this approach can be made reasonably reliable if maintained properly (it can be made clinically safe by enabling a plain text option in case the local codes are insufficient in some circumstances).</p>
</div>
<div class="paragraph">
<p>It will be up to applications or infrastructure in the execution environment to determine if the required external terminology is available and should be used; if so, the local value set definition and at-code bindings can be ignored.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">         </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #3: add a binding for the value set itself</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/900000000000123456</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- value set binding</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406464007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Pollen allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406470001</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Insect allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406472009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Animal protein and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410981007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Plant extract and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410980008</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Dust allergen (substance)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">         </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #3: add a binding for the value set itself</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/900000000000123456</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- value set binding</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406464007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Pollen allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406470001</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Insect allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/406472009</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Animal protein and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410981007</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Plant extract and epidermal allergen (substance)</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/id/410980008</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- Dust allergen (substance)</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the value set binding target is a URI to a value set definition in the target terminology, in this case SNOMED CT. No assumption is made within the archetype about how this is done - it could be a static list, or a so-called 'intensional reference set', meaning a value set whose contents are described by a query that when executed against the terminology, will generate the correct value set.</p>
</div>
<div class="paragraph discussion">
<p>As an example of an intensional ref-set, consider the value set logically defined as "any bacterial infection of the lung". The possible values would be codes from a target terminology, corresponding to numerous strains of pneumococcus, staphylococcus and so on, but not including species that are never found in the lung. The value set may be defined as a ref-set query such as <code>is-a bacteria and has-site lung</code>. All of the syntax and machinery to achieve this is assumed to be outside the archetype. The attraction of binding to an intensional ref-set is that its contents can change over time (e.g. as 'type of hepatitis' has changed over the last 15 years), with no dependence on the archetype. Another is that intensional ref-sets can be used to tailor the value set to a desired level of detail and to remove known errors.</p>
</div>
<div class="paragraph">
<p>The final variation is to assume that the local value set definition is removed, either because it is unreliable or difficult to maintain, or because universal access to the terminology is now available. In this case, the bindings to the individual at-codes are no longer needed. A new archetype designed on this basis would not even need the at-code definitions (a new revision of a legacy archetype would, however). The result would look as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">         </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- alternative #4: external value set only</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomedct.info/id/900000000000123456</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- value set binding</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_from_constraints_to_concrete_codes_in_data"><a class="anchor" href="#_from_constraints_to_concrete_codes_in_data"></a>8.3. From Constraints to Concrete Codes in Data</h3>
<div class="paragraph">
<p>A key question not answered by the above is: what codes ultimately find their way into data created via archetypes used in conjunction with terminology? With the exception of alternative #4 above, there are two ways of recording values of coded terms in data. One is to use the at-codes chosen by the user (or software component) at execution time, and the other is to store the target of the term binding, i.e. a SNOMED CT, LOINC or other external code. Which strategy to use depends on a number of factors, mostly not determinable at archetype development time.</p>
</div>
<div class="paragraph">
<p>There are two dimensions that are relevant to determining a storage approach. One is to distinguish data representation within the internal environment from data formats used for sharing. Within the internal environment, if archetypes are actively used by the system, then local at-codes can be stored, since they can always be converted via the archetypes to whichever bindings are available. The second is the distinction between 'large' and 'small' value sets mentioned earlier. Large value-sets are those which are always modelled by terminology, and even if not available today, terminology will be the only practical approach of implementing them.</p>
</div>
<div class="paragraph">
<p>In this case, the value stored in the data will always be an external terminology code, or else if not available, plain text.</p>
</div>
<div class="paragraph">
<p>The picture for 'small' value sets is less clear. The openEHR.org archetypes for example contain hundreds (possibly thousands) of small value sets within only a few hundred archetypes, all designed by clinical specialists. These value sets could technically have been represented within external terminologies (some undoubtedly will be in the future). There is however a danger in doing this. Value sets within an archetype apply only to that archetype and there is no implication of use outside it. There is no equivalent encapsulation when the same value set is created within say SNOMED CT - specificity usually has to be achieved with either pre- or post-coordination. Nevertheless, creating a 'small' value set inside terminology is perfectly doable and in some cases will be desirable. This means that there are two choices for storing coded values in data: internal at-codes or bound external codes.</p>
</div>
<div class="paragraph">
<p>Various arguments point to the utility of using the former:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>there may be no bindings at all available today, so at-codes must be stored;</p>
</li>
<li>
<p>there may be bindings that only partially cover the at-codes in the model;</p>
</li>
<li>
<p>there may be more than one binding, used for different purposes e.g. hospital versus and general practice;</p>
</li>
<li>
<p>bindings in place today may be found to be incorrect in the future, and may be changed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It would appear that the most reliable thing to do is to store the archetype local codes for values for use within the main computing environment.</p>
</div>
<div class="paragraph">
<p>When it comes to sharing data with external data partners, there may be a requirement to use external terminology codes for some data fields, where they are available. An example is laboratory analytes, which may be coded using archetype internal codes, but for which the extensive LOINC terminology, and many extant country-level lab code systems could also be used. One strategy is to use at-codes in the internal environment and to always generate messages on the fly containing the codes required for sharing.</p>
</div>
<div class="paragraph">
<p>The upshot of these considerations is that the choice of which kind of term to use (internal or external) in a given deployment or situation is deferrable to a later stage than archetype authoring. The approach ADL takes is that 'source form' archetypes and templates always use internal coding and optionally binding, and that if external codes are to be directly substituted for the internal codes for some deployment situation for certain fields in an archetype or template, this is specified as an option at the point of operational template generation.</p>
</div>
<div class="paragraph">
<p>As described in <a href="#cADL_Terminology_Constraints">Section 4.5.10</a>, constraints of the form <code>[acN]</code> and <code>[atN]</code> are replaced by <code>[acN@ttttt]</code> and <code>[atN@ttttt]</code>. A generated operational template that includes the above archetype, with the choice to use the <code>snomed_ct</code> binding&#8217;s external terms made on some nodes, could include the following content.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- extract of operational template based on openehr-ehr-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at0004@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-c">-- extract of operational template based on openehr-ehr-EVALUATION.term_constraint_variations.v0.0.1</span>
<span class="tok-w">    </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at5@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- set name to &#39;Substance&#39;</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id55</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1@snomed_ct</span><span class="tok-p">]}</span><span class="tok-w">        </span><span class="tok-c">-- Type of Substance/Agent</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specialisation"><a class="anchor" href="#_specialisation"></a>9. Specialisation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>9.1. Overview</h3>
<div class="paragraph">
<p>Archetypes can be specialised in a similar way to classes in object-oriented programming languages. Common to both situations is the use of a differential style of declaration, i.e. the contents of a specialised artefact are expressed as differences with respect to the parent artefact - previously defined elements from the parent that are not changed are not repeated in the descendant. Two extra constructs are included in the ADL syntax to support redefinition in specialised archetypes or templates.</p>
</div>
<div class="paragraph">
<p>The basic test that must be satisfied by a specialised archetype is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All possible data instance arrangements that conform to the specialised archetype must also conform to all of its parents, recursively to the ultimate parent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This condition ensures that data created by a specialised archetype that is not itself shared by two systems can be processed by the use of a more general parent that is shared.</p>
</div>
<div class="paragraph">
<p>The semantics that allow this are similar to the <a href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)" target="_blank" rel="noopener">covariant redefinition</a> notion used in some object-oriented programming languages, and can be summarised as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A non-specialised (i.e. top-level) archetype defines an instance space that is a subset of the space defined by the class in the reference information model on which the archetype is based.</p>
</li>
<li>
<p>A specialised archetype can specialise only one parent archetype, i.e. single inheritance.</p>
</li>
<li>
<p>A specialised archetype specifies an instance space defined by the following elements:</p>
<div class="ulist">
<ul>
<li>
<p>unchanged object and attribute constraints inherited from the parent archetype;</p>
</li>
<li>
<p>and one or more redefinitions, additions and removals.</p>
</li>
</ul>
</div>
</li>
<li>
<p>All elements defined in a parent archetype are either inherited unchanged or redefined in a specialised child.</p>
</li>
<li>
<p>Specialised archetypes are expressed differentially with respect to the parent, i.e. they do not mention purely inherited elements, only redefinitions and extensions.</p>
</li>
<li>
<p>Extensions always define an additional subset of the instance space defined by the reference model element being extended (i.e. to which the 'new' objects belong). The extension capability allows archetypes to remain extensible without having to know in advance how or if they will be extended.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To understand specialisation properly, the object-oriented notion of flattening is required. This term refers to the operation of overlaying the (differential) definition of a specialised archetype on its 'flat parent', which is a flattened archetype obtained by a previous invocation of this process. The first invocation creates a flat archetype from overlaying a specialised archetype on a 'top-level' non-specialised archetype.</p>
</div>
<div class="paragraph">
<p>The contents of the definition of any specialised archetype are therefore understood as differences with respect to the <em>flat parent</em>, not the differential parent. This is exactly how object-oriented programming languages work.</p>
</div>
<div class="paragraph">
<p>The following sections describe the details of specialisation. The term 'object' is used synonymously with 'object constraint' since all elements in ADL are constraints unless otherwise indicated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specialisation_concepts"><a class="anchor" href="#_specialisation_concepts"></a>9.2. Specialisation Concepts</h3>
<div class="sect3">
<h4 id="_differential_and_flat_forms"><a class="anchor" href="#_differential_and_flat_forms"></a>9.2.1. Differential and Flat Forms</h4>
<div class="paragraph">
<p>Specialised archetypes in their authored form are represented in 'differential' form. The syntax is the same as for non-specialised archetypes, with two additions: specialisation paths (see <a href="#_specialisation_paths">Section 9.2.3</a>) and ordering indicators (see <a href="#_ordering_of_sibling_nodes">Section 9.4.2.2</a>). For a specialised archetype therefore, the lineage of archetypes back to the ultimate parent must be taken into account in order to obtain its complete semantics.</p>
</div>
<div class="paragraph">
<p>Differential form means that the only attributes or objects mentioned are those that redefine corresponding elements in the parent and those that introduce new elements. The differential approach to representation of specialised archetypes give rise to the need for a <em>flat form</em> of a specialised archetype: the equivalent archetype defined by the sum of the (differential) child and its parent, as if the child archetype had been defined standalone. The flat form of archetypes is used for building templates, and subsequently at runtime. It is generated by 'compressing' the effects of inheritance of the parent to the specialised child into a single archetype, and applies recursively all the way up an archetype lineage to the ultimate parent, which must be a top-level (non-specialised) archetype. For a top-level archetype, the flat-form is the same as its differential form (i.e. in a top-level archetype, every node is considered to be an extension node).</p>
</div>
</div>
<div class="sect3">
<h4 id="_specialisation_levels"><a class="anchor" href="#_specialisation_levels"></a>9.2.2. Specialisation Levels</h4>
<div class="paragraph">
<p>In order to talk about archetypes at different levels of specialisation, a standard way of identifying the levels of specialisation is used, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>level 0: top-level, non-specialised archetypes</p>
</li>
<li>
<p>level 1: specialisations of level 0 archetypes</p>
</li>
<li>
<p>level 2: specialisations of level 1 archetypes</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For nodes carrying a node identifier, the specialisation level is always equal to the number of '.' characters found in the identifier.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specialisation_paths"><a class="anchor" href="#_specialisation_paths"></a>9.2.3. Specialisation Paths</h4>
<div class="paragraph">
<p>Because ADL is a block-structured language, the redefinition of nodes deep in the parent structure normally requires descending into the structure. Since it is common to want to further constrain only nodes deep within a structure in specialised archetype, a more convenient way is provided in ADL to do this using a <em>specialisation path</em>, illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- Thyroid function tests</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- TSH</span>
<span class="tok-w">                    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w"> </span><span class="tok-c">-- Free T3</span>
<span class="tok-w">                </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- Thyroid function tests</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- TSH</span>
<span class="tok-w">                    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id0.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...</span><span class="tok-w"> </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w"> </span><span class="tok-c">-- Free T3</span>
<span class="tok-w">                </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this fragment, a path is used rather than an attribute name. A path can be used in this manner only if no further constraints are required 'on the way' into the deep structure, with the exception of at-code (id-code) overrides (since these can be syntactically accommodated within the path).</p>
</div>
<div class="paragraph">
<p>The rules for specialisation paths are as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A specialisation path is constructed down to the first attribute having any child objects to be further constrained in the present archetype.</p>
</li>
<li>
<p>All path segments must carry an at-code (id-code) predicate.</p>
</li>
<li>
<p>The shortest useful path that can be used is <code>/</code> followed by an attribute name from the top level class being constrained by the archetype.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_path_congruence"><a class="anchor" href="#_path_congruence"></a>9.2.4. Path Congruence</h4>
<div class="paragraph">
<p>Any node in an archetype can unambiguously be located by its archetype path. For example, the text value of the 'problem' node of the <code>openEHR-EHR-EVALUATION.problem.v1</code> archetype shown at the top of the example in <a href="#redefinition_for_specialisation">Section 9.3.2</a> is:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">value</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">value</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly the path to the redefined version of the same node in the <code>openEHR-EHR-EVALUATION.problem-diagnosis.v1</code> archetype at the bottom of the same figure is:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0002.1</span><span class="tok-p">]/</span><span class="tok-nc">value</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id3.1</span><span class="tok-p">]/</span><span class="tok-nc">value</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By inspection, it can be seen that this path is a variant of the corresponding path in the parent archetype, where a particular object node identifier has been specialised.</p>
</div>
<div class="paragraph">
<p>In general, the path of every redefined node in a specialised archetype will have a direct equivalent in the parent archetype, which can be determined by removing one level of specialisation from any node identifiers within the specialised path that are at the level of specialisation of the specialised archetype (i.e. node identifiers corresponding to higher specialisation levels are not changed). In this way, the nodes in a specialised archetype source can be connected to their counterparts in parent archetypes, for purposes of validation and flattening.</p>
</div>
<div class="paragraph">
<p>Conversely, any given path in an archetype that has children will have congruent paths in the children wherever nodes have been specialised.</p>
</div>
</div>
<div class="sect3">
<h4 id="_redefinition_concepts"><a class="anchor" href="#_redefinition_concepts"></a>9.2.5. Redefinition Concepts</h4>
<div class="paragraph">
<p>A specialised archetype definition at any level consists of a set of changes with respect to its flat parent. The technically available changes are categorised as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Logical Intention</th>
<th class="tableblock halign-left valign-top">Physical Redefinition</th>
<th class="tableblock halign-left valign-top">Criteria</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><strong>Attibute node constraints</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MANDATE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential attribute node refines existence to 1.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has same attribute name as a node at the same path location in the flat parent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXCLUDE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential attribute node refines existence to 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has same attribute name as a node at the same path location in the flat parent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REFINE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential attribute node refines cardinality of attribute at corresponding location in flat parent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has same attribute name as a node at the same path location in the flat parent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADD a new node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential attribute node will be added to parent object node at corresponding location in flat parent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node does not exist in the flat parent, only in the Reference Model.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"><p class="tableblock"><strong>Object node constraints</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REFINE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential object node and sub-elements will OVERRIDE corresponding node, and some / all of its sub-elements from the flat parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has a specialised node identifier, and corresponding node in flat parent has max occurrences = 1 or else differential node is sole replacement and has max occurrences = 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPECIALISE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential object node(s) and sub-elements will OVERRIDE a CLONE of the corresponding node, and some / all of its sub-elements from the flat parent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has a specialised node identifier, and corresponding node in flat parent has max occurrences &gt; 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADD a new node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential object node(s) and sub-elements will be ADDed to container or single-valued attribute. In the case of a container, ordering can be controlled with the before/after constraint.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has a specialised node identifier, and corresponding node in flat parent has max occurrences &gt; 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXCLUDE an existing node.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential object node DELETEs existing node which has min occurrences = 0 (i.e. can&#8217;t delete a mandatory node).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node has same node identifier as corresponding node in parent, and occurrences = 0..0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FILL a slot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">External reference node will be added as slot filler next to corresponding slot from flat parent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node is an external reference node, has specialised node identifier of a slot in the flat parent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLOSE a slot.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archetype slot node causes corresponding slot from flat parent to be closed to further filling.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Differential node is an archetype slot node, with same node identifier as a slot in the flat parent, and has the 'closed' flag set.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the ADL syntax, objects can be specified in two places: under single-value attributes and under multiply-valued (container) attributes.</p>
</div>
<div class="paragraph">
<p>Within an archetype, multiple object constraint nodes may appear under a single-valued attribute. Each such node defines an <em>alternative</em> that may be used to constrain data at that attribute position. An example is the <code>OBSERVATION.<em>protocol</em></code> attribute from the openEHR reference model: if multiple objects appear under this attribute, only one can be used at runtime to constrain data. When a single object node is refined by one or more alternatives in a child archetype, any redefined occurrences of the child must conform in the expected way to that of the parent node, i.e. be a narrowed interval.</p>
</div>
<div class="paragraph">
<p>Within a container attribute, the meaning of multiple objects is that each child object defines constraints on one or more members of the container in the data. The <code>occurrences</code> constraint on each one determines how many objects in the data match a given object constraint under the attribute. Valid occurrences intervals for each specialised child in this case are determined <em>collectively</em>, that is to say, by considering the occurrences of all the specialised children of a given parent node. As a consequence, for any child node in such a set that specialises the occurrences of the parent node, the occurrences of each such node need only <em>intersect</em> the occurrences interval of the parent node. This is because it may be assumed (indeed, necessary) for the data to contain instances matching <em>more than one</em> of the set. To correctly determine the effective occurrences of any node in a specialised group, the cardinality of the owning attribute must also be taken into account. For this reason, a particular concrete consequence of collective occurrences is that any given child node occurrences may have an unbounded upper limit (i.e. <code>*</code>) even if the upper bound of the cardinality of the owning attribute is finite.</p>
</div>
<div class="paragraph">
<p>The rules for redefinition of occurrences on object nodes is formally defined in the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#VSONCO" target="_blank" rel="noopener">VSONCO validity rule</a> in the AOM2 specification.</p>
</div>
<div class="paragraph">
<p>Object constraints can be specialised under both types of attributes by redefinition, refinement and exclusion. Addition can also be used under either kind of attribute: in both cases, it corresponds to an alternative. The actual semantics are described in terms of object node identification, type redefinition, and structural constraints (existence, cardinality and occurrences), and are the same for objects under single- and multiply-valued attributes. The following sections describe the details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_examples_2"><a class="anchor" href="#_examples_2"></a>9.3. Examples</h3>
<div class="paragraph">
<p>The examples below provide a basis for understanding most of the semantics discussed in the subsequent sections.</p>
</div>
<div class="sect3">
<h4 id="_redefinition_for_refinement"><a class="anchor" href="#_redefinition_for_refinement"></a>9.3.1. Redefinition for Refinement</h4>
<div class="paragraph">
<p>The example shown below is from an older version of the openEHR 'Problem' archetype and illustrates the use of redefinition and extension. The first text is the definition section of the top-level 'Problem' archetype, and shows one <code>ELEMENT</code> node in expanded form, with the remaining nodes in an elided form.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- openEHR-EHR-EVALUATION.problem.v1 --</span>

<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                              </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w">                             </span><span class="tok-c">-- *** NODE A</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Age at initial onset</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Severity</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Clinical description</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Date clinically received</span>
<span class="tok-w">                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Location</span>
<span class="tok-w">                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Aetiology</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- openEHR-EHR-EVALUATION.problem.v1 --</span>

<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                              </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w">                             </span><span class="tok-c">-- *** NODE A</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Age at initial onset</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Severity</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Clinical description</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Date clinically received</span>
<span class="tok-w">                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Location</span>
<span class="tok-w">                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Aetiology</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second text below is from the 'problem-diagnosis' archetype, i.e. a 'diagnosis' specialisation of the general notion of 'problem'. In this situation, the node <code>[at0001]</code> (<code>[id2]</code>), with occurrences of 1, i.e. mandatory non-multiple, has its meaning narrowed to <code>[at0001.1]</code> (<code>[id2.1]</code>) 'diagnosis' (diagnosed problems are seen as a subset of all problems in medicine), while new sibling nodes are added to the items attribute to define details particular to recording a diagnosis. The extension nodes are identified by the codes <code>[at0.32]</code> , <code>[at0.35]</code> and <code>[at0.37]</code> (<code>[id0.32]</code> , <code>[id0.35]</code> and <code>[id0.37]</code>), with the latter two shown in elided form.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- openEHR-EHR-EVALUATION.problem-diagnosis.v1 --   -- specialises openEHR-EHR-EVALUATION.problem.v1</span>

<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- Recording of diagnosis</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001.1</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">            </span><span class="tok-c">-- redefine at0001 to at0001.1 (in terminology section)</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- &lt;&lt; This node redefines &#39;NODE A&#39; above</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0.1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001.1</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">before </span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0.32</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Status    ++ This node added</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000.33</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-p">[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at0</span><span class="tok-err">.</span><span class="tok-nd">33</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">at0</span><span class="tok-err">.</span><span class="tok-nd">34</span><span class="tok-p">]</span><span class="tok-w">      </span><span class="tok-c">-- provisional</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">at0031</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Diag. criteria  ++ This node added</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0.37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Clin. staging   ++ This node added</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- openEHR-EHR-EVALUATION.problem-diagnosis.v1 --   -- specialises openEHR-EHR-EVALUATION.problem.v1</span>

<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- Recording of diagnosis</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2.1</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- redefine id2 to id2.1 (in terminology section)</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- &lt;&lt; This node redefines &#39;NODE A&#39; above</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0.1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2.1</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">before </span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id0.32</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Status    ++ This node added</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id0.33</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-p">[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at0</span><span class="tok-err">.</span><span class="tok-nd">33</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">at0</span><span class="tok-err">.</span><span class="tok-nd">34</span><span class="tok-p">]</span><span class="tok-w">      </span><span class="tok-c">-- provisional</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">id31</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Diag. criteria  ++ This node added</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id0.37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Clin. staging   ++ This node added</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="redefinition_for_specialisation"><a class="anchor" href="#redefinition_for_specialisation"></a>9.3.2. Redefinition for Specialisation</h4>
<div class="paragraph">
<p>The example shown below illustrates redefinition in a specialised archetype. The first text is taken from the definition section of the 'laboratory result' <code>OBSERVATION</code> archetype (available at <a href="https://www.openehr.org/ckm" target="_blank" rel="noopener">openEHR CKM</a>), and contains an <code>ELEMENT</code> node whose identifier is <code>[at0078]</code> (<code>[id79]</code>) , defined as 'panel item' in the archetype terminology (sibling nodes are not shown here). The intention is that the <code>[at0078]</code> (<code>[id79]</code>) node be specialised into particular 'panel items' or analytes according to particular types of test result. Accordingly, the <code>[at0078]</code> (<code>[id79]</code>) node has occurrences of <code>0..*</code> and its value is not constrained with respect to the reference model, meaning that the type of the <code><em>value</em></code> attribute can be any descendant of <code>DATA_VALUE</code> .</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">------ openEHR-EHR-OBSERVATION.laboratory.v1 ------</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                       </span><span class="tok-c">-- Laboratory Result</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                             </span><span class="tok-c">-- Any event</span>
<span class="tok-w">                        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Specimen</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">   </span><span class="tok-c">-- Diagnostic services</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- level 1</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- panel item</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0016</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Overall Comment</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0017</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Quality</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0036</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Multimedia rep.</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">------ openEHR-EHR-OBSERVATION.laboratory.v1 ------</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                       </span><span class="tok-c">-- Laboratory Result</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                             </span><span class="tok-c">-- Any event</span>
<span class="tok-w">                        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- Specimen</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">   </span><span class="tok-c">-- Diagnostic services</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- level 1</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- panel item</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id17</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Overall Comment</span>
<span class="tok-w">                                    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id18</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Quality</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- Multimedia rep.</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second text, below, is a specialised version of the laboratory result archetype, defining 'thyroid function test result'.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">------ openEHR-EHR-OBSERVATION.laboratory-thyroid.v1 ------</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-c">-- Thyroid function tests</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- TSH</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9001.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at9000</span><span class="tok-p">]}</span>
<span class="tok-w">                        </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">                        </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mIU/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free Triiodothyronine (Free T3)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Total Triiodothyronine (Total T3)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free thyroxine (Free T4)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Total Thyroxine (Total T4)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- T4 loaded uptake</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free Triiodothyronine index (Free T3 index)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free thyroxine index (FTI)</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">------ openEHR-EHR-OBSERVATION.laboratory-thyroid.v1 ------</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-c">-- Thyroid function tests</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- TSH</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id0.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at15</span><span class="tok-p">]}</span>
<span class="tok-w">                        </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">100.0</span><span class="tok-p">|}</span>
<span class="tok-w">                        </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mIU/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free Triiodothyronine (Free T3)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Total Triiodothyronine (Total T3)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free thyroxine (Free T4)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Total Thyroxine (Total T4)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- T4 loaded uptake</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free Triiodothyronine index (Free T3 index)</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Free thyroxine index (FTI)</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The redefinitions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a redefinition of the top-level object node identifier <code>[at0000]</code> (<code>[id1]</code>), with the specialised node identifier <code>[at0000.1]</code> (<code>[id1.1]</code>);</p>
</li>
<li>
<p>eight nodes redefining the <code>[at0078]</code> (<code>[id79]</code>) node are shown, with overridden node identifiers <code>[at0078.1]</code> - <code>[at0078.8]</code> (<code>[id79.1]</code> - <code>[id79.8]</code>);</p>
</li>
<li>
<p>reduced occurrences (<code>0..1</code> in each case);</p>
</li>
<li>
<p>redefinition of the <code><em>value</em></code> attribute of each <code>ELEMENT</code> type to <code>DV_QUANTITY</code>, shown in expanded form for node <code>[at0078.1]</code> (<code>[id79.1]</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the original <code>ELEMENT[at0078]</code> (<code>ELEMENT[id79]</code>) node with <code>occurrences</code> of <code>0..*</code> remains a valid constraint node: the fact of specialisation does not remove it. If the intention is that the specialised nodes constitute an <em>exhaustive</em> redefinition of the original node, the latter can be effectively removed, as described in <a href="#_exhaustive_and_non_exhaustive_redefinition">Section 9.5.4</a>.</p>
</div>
<div class="paragraph">
<p>This archetype is typical of a class of specialisations that use only redefinition, due to the fact that all objects in the redefined part of the specialised version are semantically specific kinds of a general object, in this case, 'panel item'.</p>
</div>
<div class="sect4">
<h5 id="_specialisation_with_cloning"><a class="anchor" href="#_specialisation_with_cloning"></a>9.3.2.1. Specialisation with Cloning</h5>
<div class="paragraph">
<p>In the previous example, each of the nodes with identifiers of the form <code>at0078.N</code> (<code>id79.N</code>) would be effectively copied to the flat output, since the node being redefined <code>at0078</code> (<code>id79</code>) has no sub-structure, i.e. it is a 'matches any' node. However, the general case is that the node in the parent has its own structure, typically some boilerplate nodes that would be used by any specialisation. In that case, an archetype containing nodes that specialise a node with existing structure cause a 'clone and overlay' operation. That is, to generate the flat output of the specialised archetype, the parent node is first cloned from the flat parent to the new flat output, and then the specialised node is overlaid on the cloned structure. The following example shows a parent archetype that defines a 'laboratory result' structure as a <code>CLUSTER</code> containing a number of <code>ELEMENT</code> objects, defining things like Result value, Reference range guidance and so on. The <code>at0001</code> (<code>id2</code>) Result value node is intended to be specialised.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                         </span><span class="tok-c">-- Laboratory test panel</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                 </span><span class="tok-c">-- Laboratory Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w">        </span><span class="tok-c">-- Result Value</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                         </span><span class="tok-c">-- Result Comment</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Ref. Range Guidance</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Result Value Status</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- D/T Result Val Status</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_DATE_TIME</span><span class="tok-p">[</span><span class="tok-nd">at9003</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- Other Detail</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                         </span><span class="tok-c">-- Laboratory test panel</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                 </span><span class="tok-c">-- Laboratory Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w">        </span><span class="tok-c">-- Result Value</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                         </span><span class="tok-c">-- Result Comment</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id15</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Ref. Range Guidance</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id16</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Result Value Status</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id17</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- D/T Result Val Status</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_DATE_TIME</span><span class="tok-p">[</span><span class="tok-nd">id18</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- Other Detail</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specialised child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Lipid studies panel</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- LDL Cholesterol Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- LDL Cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- HDL Cholesterol Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- HDL Cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Ratio Result</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Triglyceride Result</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- Total Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Total cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mosmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0005.6</span><span class="tok-p">]</span><span class="tok-w">     </span><span class="tok-c">-- ! - Laboratory Result</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Lipid studies panel</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- LDL Cholesterol Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- LDL Cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- HDL Cholesterol Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- HDL Cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id0.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Ratio Result</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Triglyceride Result</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- Total Result</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Total cholesterol</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id0.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at0.1</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">0.0</span><span class="tok-p">|}</span>
<span class="tok-w">                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mosmol/l&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3.6</span><span class="tok-p">]</span><span class="tok-w">     </span><span class="tok-c">-- ! - Laboratory Result</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The flattened result consists of a number of repetitions of the entire <code>CLUSTER[at0002]</code> (<code>CLUSTER[id3]</code>) structure from the parent, corresponding to the specialisations in the child. The ADL source form is too large to show here, but the <a href="https://www.openehr.org/downloads/ADLworkbench" target="_blank" rel="noopener">ADL Workbench</a> provides a visualisation in <a href="#specialisation_with_cloning">Figure 5</a>. In this figure we can see that the <code>CLUSTER</code> / <code>ELEMENT</code> overlays from the child archetype have been overlaid on clones of the <code>CLUSTER[id3]</code> structure from the parent, preserving the <code>at0003</code> , <code>at0004</code> (<code>id4</code> , <code>id5</code>) etc nodes. Elements shown in light blue are inherited; where they appear under the nodes <code>[at0002.1]</code>, <code>[at0002.2]</code> (<code>[id3.1]</code>, <code>[id3.2]</code>) etc, they are cloned from the corresponding nodes under <code>[at0002]</code> (<code>[id3]</code>).</p>
</div>
<div id="specialisation_with_cloning" class="imageblock text-center text-center">
<div class="content">
<img src="ADL2/images/specialisation_with_cloning.png" alt="specialisation with cloning" width="75%">
</div>
<div class="title">Figure 5. Specialisation with Cloning</div>
</div>
<div class="paragraph">
<p>It can also be seen that the original <code>[at0002]</code> (<code>[id3]</code>) sub-tree remains. This can be removed if required, as described in <a href="#_exhaustive_and_non_exhaustive_redefinition">Section 9.5.4</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_attribute_redefinition"><a class="anchor" href="#_attribute_redefinition"></a>9.4. Attribute Redefinition</h3>
<div class="paragraph">
<p>A small number of things can be redefined on attributes, including existence and cardinality. A basic rule of redefinition is that a specialised archetype cannot change the multiplicity type of an attribute.</p>
</div>
<div class="sect3">
<h4 id="_existence_redefinition_mandation_and_exclusion"><a class="anchor" href="#_existence_redefinition_mandation_and_exclusion"></a>9.4.1. Existence Redefinition: Mandation and Exclusion</h4>
<div class="paragraph">
<p>All attributes mentioned in an archetype have an <em>existence</em> constraint, indicating whether a value is required or not. The constraint is either stated explicitly - typically done for single-valued attributes - or it is the value from the reference model - typical for multiply-valued attributes. In both cases, the existence of an attribute in a parent archetype can be redefined in a specialised archetype using the standard cADL syntax. In the following example, an implicit existence constraint picked up from the reference model of <code>{0..1}</code> is redefined in a child archetype to <code>{1}</code> , i.e. mandatory.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-nc">protocol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                    </span><span class="tok-c">-- existence not changed from reference model</span>
<span class="tok-w">            </span><span class="tok-c">-- etc</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-nc">protocol</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                    </span><span class="tok-c">-- existence not changed from reference model</span>
<span class="tok-w">            </span><span class="tok-c">-- etc</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">              </span><span class="tok-c">-- paediatric blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">protocol</span><span class="tok-p"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- etc</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">              </span><span class="tok-c">-- paediatric blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">protocol</span><span class="tok-p"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- etc</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Redefinition of existence to <code>{0}</code> by this method denotes exclusion, i.e. removal of the entire attribute (including all sub-structure) from the resulting structure. In an archetype, it is likely to indicate poor design, given that the decision to remove optional attributes is much more likely to be local, and therefore more appropriate in templates rather than archetypes; within a template it would be perfectly normal. The following example shows the protocol attribute in the above <code>OBSERVATION</code> archetype being excluded in this way:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">   </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- paediatric blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">protocol</span><span class="tok-p"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">   </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                </span><span class="tok-c">-- paediatric blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">protocol</span><span class="tok-p"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in the above, the '/' is used to denote '/protocol' as a differential path. Without the slash, the 'protocol' attribute would be considered to be trying to constrain a hitherto unconstrained attribute called 'protocol', rather than redefine a constraint already present in a parent archetype.</p>
</div>
</div>
<div class="sect3">
<h4 id="_multiply_valued_container_attributes"><a class="anchor" href="#_multiply_valued_container_attributes"></a>9.4.2. Multiply-valued (Container) Attributes</h4>
<div class="paragraph">
<p>The following sub-sections describe specialisation semantics specific to container attributes.</p>
</div>
<div class="sect4">
<h5 id="_cardinality_2"><a class="anchor" href="#_cardinality_2"></a>9.4.2.1. Cardinality</h5>
<div class="paragraph">
<p>The <em>cardinality</em> constraint defines how many object instances can be in the container within the data (not the archetype). In a specialised archetype, cardinality can be redefined to be a narrower range than in the parent, further limiting the valid ranges of items in the data that may occur within the container. This would normally only make sense if refinements were made to the occurrences of the contained items, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>narrowing the occurrences range of an object;</p>
</li>
<li>
<p>excluding an object by setting its occurrences to <code>{0}</code>;</p>
</li>
<li>
<p>adding new objects, which themselves will have occurrences constraints;</p>
</li>
<li>
<p>setting some object occurrences to mandatory, and the enclosing cardinality lower limit to some non-zero value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As long as the relationship between the enclosing attribute&#8217;s cardinality constraint and the occurrences constraints defined on all the contained items (including those inherited unchanged, and therefore not mentioned in the specialised archetype) is respected (see <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#VACMCU" target="_blank" rel="noopener">VACMCU, VACMCO validity rules, AOM2 specification</a>), any of the above specialisations can occur.</p>
</div>
<div class="paragraph">
<p>The following provides an example of cardinality redefinition.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- general check list</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- any number of items</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- generic checklist item</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- general check list</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- any number of items</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">      </span><span class="tok-c">-- generic checklist item</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- pre-operative check list</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">3..10</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                    </span><span class="tok-c">-- at least 3 mandatory items</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #1</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #2</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #3</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- item #4</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0011.10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">   </span><span class="tok-c">-- item #10</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- pre-operative check list</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">3..10</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                    </span><span class="tok-c">-- at least 3 mandatory items</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #1</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #2</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- item #3</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- item #4</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id12.10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">   </span><span class="tok-c">-- item #10</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ordering_of_sibling_nodes"><a class="anchor" href="#_ordering_of_sibling_nodes"></a>9.4.2.2. Ordering of Sibling Nodes</h5>
<div class="paragraph">
<p>Within container attributes, the order of objects may be significant from the point of view of domain users, i.e. the container may be considered as an ordered list. This is easy to achieve in top-level archetype, using the 'ordered' qualifier on a cardinality constraint. However, when particular node(s) are redefined into multiple specialised nodes, or new nodes added by extension, the desired order of the new nodes may be such that they should occur interspersed at particular locations among nodes defined in the parent archetype. The following text is a slightly summarised view of the items attribute from the problem archetype shown in <a href="#redefinition_for_specialisation">Section 9.3.2</a>:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">              </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Age at initial onset</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Severity</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Clinical description</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Date clinically received</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Location</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Aetiology</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0017</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Occurrences or exacerb&#39;ns</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0025</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Related problems</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0029</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Date of resolution</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0030</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Age at resolution</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">               </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- Age at initial onset</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- Severity</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">            </span><span class="tok-c">-- Clinical description</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id10</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Date clinically received</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Location</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Aetiology</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id18</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Occurrences or exacerb&#39;ns</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id26</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Related problems</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id30</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Date of resolution</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id31</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">           </span><span class="tok-c">-- Age at resolution</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To indicate significant ordering in the specialised problem-diagnosis archetype, the keywords ` before` and ` after` can be used, as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">before </span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0001.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                             </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0.32</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Status</span>
<span class="tok-w">        </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">at0025</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Diagnostic criteria</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0.37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Clinical Staging</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">before </span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id2.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                                </span><span class="tok-c">-- Diagnosis</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id0.32</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Status</span>
<span class="tok-w">        </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">id26</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Diagnostic criteria</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id0.37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">          </span><span class="tok-c">-- Clinical Staging</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These keywords are followed by a node identifier reference, and act to anchor the location of the node definitions immediately following until the next sibling order marker or the end of the list. The following visual rendition is equivalent, but arguably less readable:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">at0025</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- etc</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">after </span><span class="tok-p">[</span><span class="tok-nd">id26</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id0.35</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">  </span><span class="tok-c">-- etc</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The rules for specifying ordering are as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ordering is only applicable to object nodes defined within a multiply-valued (i.e. container) attribute whose cardinality includes the <code>ordered</code> constraint;</p>
</li>
<li>
<p>Any <code>before</code> or <code>after</code> statement can use as its anchor the node identifier of any sibling node from the same container attribute in the flat form of the parent archetype, or a redefined version of the same, local to the current archetype;</p>
</li>
<li>
<p>If no sibling order markers are used, redefined nodes should appear in the same position as the nodes they replace, while extension nodes appear at the end.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If ordering indicators are used in an archetype that is itself further specialised, the following rules apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the referenced identifier becomes unavailable due to being redefined in the new archetype, it must be redefined to refer to an available sibling identifier as per the rules above.</p>
</li>
<li>
<p>If this does not occur, a <code>before</code> reference will default to the first sibling node identifier currently available conforming to the original identifier, while an <code>after</code> reference will default to the <em>last</em> such identifier available in the current flat archetype.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If, due to multiple levels of redefinition, there is more than one candidate to go before (or after) a given node, the compiler should output a warning. The problem would be resolved by the choice of one of the candidates being changed to indicate that it is to be ordered before (after) another of the candidates rather than the originally stated node.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_object_redefinition"><a class="anchor" href="#_object_redefinition"></a>9.5. Object Redefinition</h3>
<div class="paragraph">
<p>Object redefinition can occur for any object constraint in the parent archetype, and can include redefinition of node identifier, occurrences, reference model type. For certain kinds of object constraints, specific kinds of redefinition are possible.</p>
</div>
<div class="sect3">
<h4 id="_node_identifiers_3"><a class="anchor" href="#_node_identifiers_3"></a>9.5.1. Node Identifiers</h4>
<div class="paragraph">
<p>In an archetype, node identifiers ('at-codes' / 'id-codes') are mandatory on all object constraint nodes. The identifiers of those object nodes defined as children of a multiply-valued attribute and multiple alternative children of single-valued attributes (see <a href="#_node_identifiers">Section 4.2.5</a>) require definitions in the archetype terminology. Definitions are optional on other single child constraints of single-valued attributes. This rule applies in specialised as well as top-level archetypes.</p>
</div>
<div class="paragraph">
<p>A key question is: when does a node identifier need to be redefined? There are three possible situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>when the node is the root node of an archetype, the meaning is always considered to be redefined;</p>
</li>
<li>
<p>it can be redefined for purely semantic purposes on other nodes, e.g. to redefine 'heart rate' to 'fetal heart rate';</p>
</li>
<li>
<p>a node identifier must be redefined if the node is being redefined into multiple child nodes, either under a multiply-valued attribute, or as alternatives under a single-valued attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Redefinition of an object node identifier for purely semantic purposes, unaccompanied by any other kind of constraint change is done as shown in the following example.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Description</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                      </span><span class="tok-c">-- Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Description</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                              </span><span class="tok-c">-- Singapore Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004.1</span><span class="tok-p">]</span><span class="tok-w">                             </span><span class="tok-c">-- Summary</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                              </span><span class="tok-c">-- Singapore Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5.1</span><span class="tok-p">]</span><span class="tok-w">                             </span><span class="tok-c">-- Summary</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the <code>at0004</code> (<code>id5</code>) ('Description') node is refined in meaning to <code>at0004.1</code> (<code>id5.1</code>) ('Summary'). Since there is no other constraint to be stated, no further <code>matches</code> block is required.</p>
</div>
<div class="paragraph">
<p>An example of the 3rd case above of redefinition is shown in the first archetype in <a href="#redefinition_for_specialisation">Section 9.3.2</a>, where the node <code>[at0078]</code> (<code>[id79]</code>) is redefined into a number of more specialised nodes <code>[at0078.2]</code> - <code>[at0078.9]</code> (<code>[id79.2]</code> - <code>[id79.9]</code>), while in the second, the identifier <code>[at0001]</code> (<code>[id2]</code>) is redefined to a single node <code>[at0001.1]</code> (<code>[id2.1]</code>).</p>
</div>
<div class="paragraph">
<p>The syntactic form of the identifier of a redefined node is a copy of the original followed by a dot ('.'), optionally intervening instances of the pattern '0.' and then a further non-zero number, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at-coded archetypes: <code>atNNNN {.0}* .N</code></p>
</li>
<li>
<p>id-coded archetypes: <code>idN {.0}* .N</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This permits node identifiers from a given level to be redefined not just at the next level, but at multiple levels below.</p>
</div>
<div class="paragraph">
<p>The following are examples of redefined node identifiers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>at0001.1</code>: redefinition of <code>at0001</code> at level 1 specialisation;</p>
</li>
<li>
<p><code>at0001.0.1</code>: redefinition of <code>at0001</code> node in level 2 specialisation archetype;</p>
</li>
<li>
<p><code>at0001.1.1</code>: redefinition of <code>at0001.1</code> in level 2 specialisation archetype.</p>
</li>
</ul>
</div>
</li>
<li>
<p>id-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>id2.1</code>: redefinition of <code>id2</code> at level 1 specialisation;</p>
</li>
<li>
<p><code>id2.0.1</code>: redefinition of <code>id2</code> node in level 2 specialisation archetype;</p>
</li>
<li>
<p><code>id2.1.1</code>: redefinition of <code>id2.1</code> in level 2 specialisation archetype.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The digits '1' and '2' here should not be confused with levels 1 and 2. The above identifiers based on an <code>at0005</code> (<code>id6</code>) node might easily be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>at0005.7</code>: redefinition of <code>at0005</code> in a level 1 specialisation archetype;</p>
</li>
<li>
<p><code>at0005.0.8</code>: redefinition of <code>at0005</code> node in a level 2 specialisation archetype;</p>
</li>
<li>
<p><code>at0005.7.8</code>: redefinition of <code>at0005.7</code> in a level 2 specialisation archetype.</p>
</li>
</ul>
</div>
</li>
<li>
<p>id-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>id6.7</code>: redefinition of <code>id6</code> in a level 1 specialisation archetype;</p>
</li>
<li>
<p><code>id6.0.8</code>: redefinition of <code>id6</code> node in a level 2 specialisation archetype;</p>
</li>
<li>
<p><code>id6.7.8</code>: redefinition of <code>id6.7</code> in a level 2 specialisation archetype.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_adding_nodes"><a class="anchor" href="#_adding_nodes"></a>9.5.1.1. Adding Nodes</h5>
<div class="paragraph">
<p>Added object constraint nodes carry identifiers according to the rule mentioned above. The second example includes the new node identifiers <code>at0.32</code> , <code>at0.35</code> and <code>at0.37</code> (<code>id0.32</code> , <code>id0.35</code> and <code>id0.37</code>), whose codes start with a '0'. indicating that they have no equivalent code in the parent archetype.</p>
</div>
<div class="paragraph">
<p>The node identifier syntax of an extension node commences with at least one instance of the pattern '0.'. The structure of node identifiers for both kinds of node thus always indicates at what level the identifier was introduced, given by the number of dots.</p>
</div>
<div class="paragraph">
<p>Examples of added node identifiers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>at0.1</code>  : identifier of extension node introduced at level 1;</p>
</li>
<li>
<p><code>at0.0.1</code>: identifier of extension node introduced at level 2.</p>
</li>
</ul>
</div>
</li>
<li>
<p>id-coded archetypes:</p>
<div class="ulist">
<ul>
<li>
<p><code>id0.1</code>  : identifier of extension node introduced at level 1;</p>
</li>
<li>
<p><code>id0.0.1</code>: identifier of extension node introduced at level 2.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When a flat form is created, the level at which any given node was introduced or redefined is clear due to the identifier coding system.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_occurrences_redefinition"><a class="anchor" href="#_occurrences_redefinition"></a>9.5.2. Occurrences Redefinition</h4>
<div class="paragraph">
<p>The <code>occurrences</code> constraint on an object node indicates how many instances within the data may conform to that constraint (see <a href="#_container_attributes">Section 4.3.3</a>). Occurrences may be redefined for various reasons, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mandation of specific specialised objects;</p>
</li>
<li>
<p>exclusion of certain objects from the parent;</p>
</li>
<li>
<p>controlling occurrences of a specialised object to a specific range.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A basic distinction should be understood prior to considering these specific cases, which is a difference between redefinition of occurrences on a single-occurrence node versus a multiple-occurrence node.</p>
</div>
<div class="paragraph">
<p>A single-occurrence node is one whose effective occurrences has an upper limit of 1, i.e. it can occur either 0..1 or 1 times in data. This is the case for any object node under a single-valued attribute, as well as any object node under a container attribute, that has occurrences set to either 0..1 or 1. The occurrences of such a node can only be redefined in very limited ways, i.e. mandation or exclusion of 0..1.</p>
</div>
<div class="paragraph">
<p>The situation is different for object nodes with multiple occurrences, i.e. whose effective occurrences upper limit is greater than one. The example provided above in <a href="#redefinition_for_specialisation">Section 9.3.2</a> in which node <code>at0078|panel item|</code> (<code>id79|panel item|</code>) in the parent archetype is specialised into multiple nodes <code>at0078.1</code>, <code>at0078.2</code> (<code>id79.1</code>, <code>id79.2</code>) etc, illustrates the standard pattern. When a parent object (the <code>at0078</code> (<code>id79</code>) node in the parent archetype) has multiple occurrences, it defines a potential <em>multiplicity</em> of data objects that may conform to it. When such a node is redefined into multiple specialised child nodes in a child archetype (each typically having its own occurrences constraint), the latter <em>specialisation set</em> acts as a more precise restatement of the original multiplicity of objects. For this reason, the <em>collective occurrences</em> of the specialised children is used to determine their validity, rather than any individual comparison of the occurrences of one specialised child to that of the parent.</p>
</div>
<div class="paragraph">
<p>The formal definition of validity for occurrences in both cases is given by the VSONCO rule in the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_validity_rules_3" target="_blank" rel="noopener">openEHR AOM2 specification</a>.</p>
</div>
<div class="sect4">
<h5 id="_mandation"><a class="anchor" href="#_mandation"></a>9.5.2.1. Mandation</h5>
<div class="paragraph">
<p>Within container attributes, <code>occurrences</code> is usually redefined in order to make a given object mandatory rather than optional. In the following example, the occurrences of the <code>at0003</code> (<code>id4</code>) node is redefined from <code>{0..1}</code> i.e. optional, to <code>{1}</code> , i.e. mandatory.</p>
</div>
<div class="paragraph">
<p>Parent (<code>openEHR-EHR-EVALUATION.problem.v1.0.3</code>):</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Problem</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- Problem</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">       </span><span class="tok-c">-- Problem</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">    </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child (<code>openEHR-EHR-EVALUATION.problem-diagnosis.v1</code>):</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w">  </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w">  </span><span class="tok-c">-- Date of initial onset</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above we can see that if the only change in the redefinition is to occurrences, the remainder of the block from the parent is not repeated in the child.</p>
</div>
</div>
<div class="sect4">
<h5 id="_exclusion"><a class="anchor" href="#_exclusion"></a>9.5.2.2. Exclusion</h5>
<div class="paragraph">
<p>Occurrences is most commonly constrained on child objects of container attributes, but can be set on objects of any attribute to effect exclusion of part of the instance space. This can be useful in archetypes where a number of alternatives for a single-valued attribute have been stated, and the need is to remove some alternatives in a specialised child archetype. For example, an archetype might have the following constraint:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_QUANTITY&gt;</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_COUNT</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_COUNT&gt;</span><span class="tok-p">[</span><span class="tok-nd">at9003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_QUANTITY&gt;</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_COUNT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_COUNT&gt;</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and the intention is to remove the <code>DV_INTERVAL&lt;*&gt;</code> alternatives. This is achieved by redefining the enclosing object to remove the relevant types:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_QUANTITY&gt;</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_COUNT&gt;</span><span class="tok-p">[</span><span class="tok-nd">at9003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_QUANTITY&gt;</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_INTERVAL&lt;DV_COUNT&gt;</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Exclusion by setting occurrences to <code>{0}</code> is also common in templates, and is used to remove specific child objects of container attributes, as in the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0025</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">     </span><span class="tok-c">-- remove &#39;Related problems&#39;</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0030</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">     </span><span class="tok-c">-- remove &#39;Age at resolution&#39;</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id26</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">     </span><span class="tok-c">-- remove &#39;Related problems&#39;</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id31</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">     </span><span class="tok-c">-- remove &#39;Age at resolution&#39;</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If the whole attribute is to be removed, this can be done by redefining existence to <code>{0}</code>, as described in <a href="#_existence_redefinition_mandation_and_exclusion">Section 9.4.1</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_single_and_multiple_specialisation_when_does_cloning_occur"><a class="anchor" href="#_single_and_multiple_specialisation_when_does_cloning_occur"></a>9.5.3. Single and Multiple Specialisation - When does Cloning Occur?</h4>
<div class="paragraph">
<p>In the <a href="#_examples">examples shown above</a> there are two types of redefinition occurring. The first shows a single node in the parent archetype redefined by a single node, both identified by <code>at0003</code> (<code>id4</code>). The second shows a single node in the parent redefined by multiple children. In the first example, the result of flattening is <em>in-place overlaying</em>, while in the second, it is <em>cloning with overlaying</em>. The consequence of the second type of redefinition is that the original parent node survives in its original form in the child archetype, whereas in the first, it is replaced. The reasoning behind this is that redefinition to multiple children is taken to mean that later redefinition to multiple children may occur in deeper child archetypes, and for this to occur, the original parent needs to be left intact. Conversely, the single-parent / single-child redefinition is taken to mean a logical refinement of an existing node, which should therefore be logically replaced.</p>
</div>
<div class="paragraph">
<p>The formal rule for whether cloning occurs or not is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    clone not needed = max effective_occurrences of object node in parent archetype = 1 OR
        object node in child differential archetype is sole child of its parent, and has max occurrences = 1</pre>
</div>
</div>
<div class="paragraph">
<p>The first case corresponds to the situation where the 'effective occurrences' of any child of an attribute can be inferred to be maximum 1, i.e. either the attribute is single-valued, or it is a container with a cardinality constraint with maximum 1. The second is where the object in the child archetype has an explicit occurrences constraint of max 1. In the above, the <code><em>effective_occurrences</em></code> function is defined in the <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_occurrences_inferencing_rules">AOM2 specification</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exhaustive_and_non_exhaustive_redefinition"><a class="anchor" href="#_exhaustive_and_non_exhaustive_redefinition"></a>9.5.4. Exhaustive and Non-Exhaustive Redefinition</h4>
<div class="paragraph">
<p>In any multiple specialisation situation, there is a question of whether the original node being specialised (e.g. <code>at0078</code> (<code>id79</code>) and <code>at0001</code> (<code>id2</code>) in the examples above) remains available for further redefinition in subsequent child archetypes, or do the redefinition children <em>exhaustively</em> define the instance space for the given parent node?</p>
</div>
<div class="paragraph">
<p>Should these children be considered exhaustive? One point of view says so, since all subsequently discovered varieties of hepatitis (C, D, E, etc) would now become children of 'hepatitis non-A non-B'. However, this is likely to be sub-optimal, since now the category 'hepatitis non-A non-B' probably exists solely because of the order in which the various hepatitis virus tests were perfected. Therefore an alternative argument would say that the categories 'hepatitis C', 'hepatitis D' etc should be defined directly below 'hepatitis', as if 'hepatitis non-A non-B' had never existed. Under this argument, the children would not be declared, even when they are theoretically exhaustive.</p>
</div>
<div class="paragraph">
<p>This kind of argument comes up time and again, and the need for catch-all categories (archetype nodes) and the possibility of future discoveries cannot be predicted. Even in situations such as a lab result (e.g. cholesterol), where the list of analytes seem to be known and fixed, experience of clinical modellers has shown that there is nevertheless no guarantee of not needing another data point, perhaps for something other than an analyte.</p>
</div>
<div class="paragraph">
<p>The default situation is that child redefinition nodes do not exhaustively replace the parent unless explicitly stated otherwise. This may be done by excluding the parent node in the normal way, i.e. using <code>occurrences matches {0}</code>. <strong>If an exclusion node is included, it must come last</strong> in the set of siblings that specialise the parent node, otherwise a deletion will occur, leaving no node to specialise. The first example would then become:</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                          </span><span class="tok-c">-- Specimen</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- level 1</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- panel item</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0016</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- Overall Comment</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0036</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- Multimedia rep.</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                          </span><span class="tok-c">-- Specimen</span>
<span class="tok-w">        </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- level 1</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- panel item</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id17</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- Overall Comment</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id37</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                      </span><span class="tok-c">-- Multimedia rep.</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- TSH</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free Triiodothyronine</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Total Triiodothyronine</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free thyroxine (Free T4)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Total Thyroxine (Total T4)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- T4 loaded uptake</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free Triiodothyronine index</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free thyroxine index (FTI)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">                                  </span><span class="tok-c">-- MUST COME LAST!</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- TSH</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free Triiodothyronine</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Total Triiodothyronine</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free thyroxine (Free T4)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Total Thyroxine (Total T4)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- T4 loaded uptake</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free Triiodothyronine index</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79.8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{...}</span><span class="tok-w">                    </span><span class="tok-c">-- Free thyroxine index (FTI)</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span><span class="tok-w">                                  </span><span class="tok-c">-- MUST COME LAST!</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Without the above specification, a deeper child archetype could then redefine both the original <code>at0078</code> (<code>id79</code>) node (e.g. into <code>at0078.0.1</code> , <code>at0078.0.2</code> (<code>id79.0.1</code> , <code>id79.0.2</code>)), and any of the <code>at0078.x</code> (<code>id79.x</code>) nodes (e.g. <code>at0078.1.1</code> , <code>at0078.1.2</code> (<code>id79.1.1</code> , <code>id79.1.2</code>)); with it, only the latter is possible. The <code>at0078</code> (<code>id79</code>) node can thus be considered to be logically 'frozen', in a similar way to frozen class methods in some programming languages.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reference_model_type_refinement"><a class="anchor" href="#_reference_model_type_refinement"></a>9.5.5. Reference Model Type Refinement</h4>
<div class="paragraph">
<p>The type of an object may be redefined to one of its subtypes as defined by the reference model. A typical example of where this occurs in archetypes based on the openEHR reference model is when <code>ELEMENT.<em>value</em></code> is constrained to <code>*</code> in a parent archetype, meaning 'no further constraint on its RM type of <code>DATA_VALUE</code>, but is then constrained in a specialised archetype to subtypes of <code>DATA_VALUE</code>, e.g. <code>DV_QUANTITY</code> or <code>DV_PROPORTION</code> (see <a href="https://specifications.openehr.org/releases/RM/latest/data_types.html" target="_blank" rel="noopener">openEHR Data Types</a>). The following figure contains a simplified extract of the data values part of the openEHR reference model, and is the basis for the examples below.</p>
</div>
<div id="rm_type_structure" class="imageblock text-center text-center">
<div class="content">
<img src="ADL2/diagrams/RM-data_types-overview.svg" alt="RM data types overview" width="50%">
</div>
<div class="title">Figure 6. Example Reference Model type structure</div>
</div>
<div class="paragraph">
<p>The most basic form of type refinement is shown in the following example:</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- any subtype of DATA_VALUE, from the ref model</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specialised archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-c">-- now limit to the DV_QUANTITY subtype</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id8</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-c">-- now limit to the DV_QUANTITY subtype</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of the above is that instance data constrained by the specialised archetype at the value node must match the <code>DV_QUANTITY</code> constraint only - no other subtype of <code>DATA_VALUE</code> is allowed.</p>
</div>
<div class="paragraph">
<p>When a type in an archetype is redefined into one of its subtypes, any existing constraints on the original type in the parent archetype are respected. In the following example, a <code>DV_AMOUNT</code> constraint that required <em>accuracy</em> to be present and in the range +/-5% is refined into a <code>DV_QUANTITY</code> in which two attributes of the subtype are constrained. The original <em>accuracy</em> attribute is inherited without change.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_AMOUNT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">accuracy</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">-0.05</span><span class="tok-p">..</span><span class="tok-mf">0.05</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_AMOUNT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">accuracy</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">-0.05</span><span class="tok-p">..</span><span class="tok-mf">0.05</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specialised archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the same manner, an object node can be specialised into more than one subtype, where each such constraint selects a mutually exclusive subset of the instance space. The following example shows a specialisation of the <code>DV_AMOUNT</code> constraint above into two sub-typed constraints.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">at9000.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- pk_unitary</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id4.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">id4.2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- pk_unitary</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, instance data may only be of type <code>DV_QUANTITY</code> or <code>DV_PROPORTION</code>, and must satisfy the respective constraints for those types.</p>
</div>
<div class="paragraph">
<p>A final variant of subtyping is when the intention is to constraint the data to a supertype with exceptions for particular subtypes. In this case, constraints based on subtypes are matched first, with the constraint based on the parent type being used to constrain all other subtypes. The following example constrains data at the <em>value</em> node to be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an instance of <code>DV_QUANTITY</code> with <em>magnitude</em> within the given range etc;</p>
</li>
<li>
<p>an instance of <code>DV_PROPORTION</code> with <em>numerator</em> in the given range etc;</p>
</li>
<li>
<p>an instance of any other subtype of <code>DV_AMOUNT</code>, with <em>accuracy</em> in the given range.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-nc">pk_unitary</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_AMOUNT</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">accuracy</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">-0.05</span><span class="tok-p">..</span><span class="tok-mf">0.05</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_PROPORTION</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">numerator</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-nc">pk_unitary</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_AMOUNT</span><span class="tok-p">[</span><span class="tok-nd">id6</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">accuracy</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">-0.05</span><span class="tok-p">..</span><span class="tok-mf">0.05</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A typical use of this kind of refinement in openEHR would be to add an alternative for a <code>DV_CODED_TEXT</code> constraint for a specific terminology to an existing <code>DV_TEXT</code> constraint in a <code><em>name</em></code> attribute, as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0013</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- non-empty string</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/123456789</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- any SNOMED CT code</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">DV_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- non-empty string</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://snomed.info/123456789</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-c">-- any SNOMED CT code</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All of the above specialisations based on reference model subtypes can be applied in the same way to identified object constraints.</p>
</div>
</div>
<div class="sect3">
<h4 id="_internal_reference_proxy_object_redefinition"><a class="anchor" href="#_internal_reference_proxy_object_redefinition"></a>9.5.6. Internal Reference (Proxy Object) Redefinition</h4>
<div class="paragraph">
<p>An archetype proxy object, or <code>use_node</code> constraint is used to refer to an object constraint from a point elsewhere in the archetype. These references can be redefined in two ways, as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Target redefinition: the target constraint of reference may be itself redefined. The meaning for this is that all internal references now assume the redefined form.</p>
</li>
<li>
<p>Reference redefinition: specialised archetypes can redefine a use_node object into a normal inline concrete constraint that a) replaces the reference, and b) must be completely conformant to the structure which is the target of the original reference.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that if the intention is to redefine a structure referred to by <code>use_node</code> constraints, but to leave the constraints at the reference source points in form to which the reference points in the parent level, each <code>use_node</code> reference needs to be manually redefined as a copy of the target structure originally pointed to.</p>
</div>
<div class="paragraph">
<p>The second type of redefinition above is the most common, and is shown in the following example.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span>
<span class="tok-p">        }</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span>
<span class="tok-p">        }</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Remembering that the parent archetype is essentially just definition two sibling object structures with the identifiers <code>at0000</code> and <code>at0001</code> (<code>id1</code> and <code>id2</code>) (defined by the use_node reference), the child is redefining the <code>at0001</code> (<code>id2</code>) node (it could have redefined the <code>at0000</code> (<code>id1</code>) node as well). The result of this in the flattened output is as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ENTRY</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CLUSTER</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-c">-- etc --</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There is one subtlety to do with redefinition of occurrences of a use_node target: if it is redefined to have occurrences matches <code>{0}</code> (normally only in a template), then the effect of this is the same on any use_node reference definitions, unless they define occurrences locally at the reference point. The chance of this actually occurring appears vanishingly small, since by the time 'exclusion' occurrence redefinition is being done in templates, use_node object definitions are most likely to have been locally overridden anyway.</p>
</div>
<div class="paragraph">
<p>Lastly, one further type of redefinition appears technically possible, but seems of no utility, and is therefore not part of ADL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reference re-targetting: an internal reference could potentially be redefined into a reference to a different target whose structure conforms to the original target.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_external_reference_redefinition"><a class="anchor" href="#_external_reference_redefinition"></a>9.5.7. External Reference Redefinition</h4>
<div class="paragraph">
<p>External reference nodes can be redefined by another external reference node, in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>exclusion - using the occurrences matches <code>{0}</code> method;</p>
</li>
<li>
<p>semantic refinement of the node identifier in the normal way;</p>
</li>
<li>
<p>redefinition of the reference to another archetype which is a specialisation of the one from the corresponding reference node in the flat parent.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_slot_filling_and_redefinition"><a class="anchor" href="#_slot_filling_and_redefinition"></a>9.5.8. Slot Filling and Redefinition</h4>
<div class="paragraph">
<p>Slots and slot-filling is a special kind of 'redefinition' in ADL, normally only used in templates. Logically, an archetype slot constraint is understood to consist of a) its definition (what archetypes are allowed to fill it) and b) current filler list. At the point of definition, the current fillers is invariably empty. More specialised descendants can progressively add or replace fillers for a slot. Thus, the appearance of an object node whose identifier is the specialisation of a slot node in the flat parent is always understood as a partial specialisation for it.</p>
</div>
<div class="paragraph">
<p>In other words, a slot within an archetype can be specialised by any combination of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>one or more slot-fillers;</p>
</li>
<li>
<p>a redefinition of the slot itself, either to narrow the set of archetypes it matches, or to close it to filling in either further specialisations, or at runtime, or to remove it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both types of redefinition are generally used by templates rather than published archetypes, since the business of filling slots is mostly related to local use-case specific uses of archetypes rather than part of the initial design.</p>
</div>
<div class="paragraph">
<p>The following example shows a slot from a <code>SECTION</code> archetype for the 'history_medical_surgical' archetype.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- Past problems</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-sr">/openEHR-EHR-EVALUATION\.clinical_synopsis\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.excluded(-[a-z0-9_]+)*\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.injury\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.problem(-[a-z0-9_]+)*\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- Past problems</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                        </span><span class="tok-sr">/openEHR-EHR-EVALUATION\.clinical_synopsis\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.excluded(-[a-z0-9_]+)*\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.injury\.v1</span>
<span class="tok-sr">                            |openEHR-EHR-EVALUATION\.problem(-[a-z0-9_]+)*\.v1/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This slot specification allows <code>EVALUATION</code> archetypes for the concepts 'clinical synopsis', various kinds of 'exclusions' and 'problems', and 'injury' to be used, and no others. The following fragment of ADL shows how the slot is filled in a template, using the keyword <code>use_archetype</code>. In this syntax, the node identification is a variation on the normal archetype at-codes (id-codes). Within the template, the identifier of the used archetype is also the identifier of that node. However, the original at-code (if defined) must also be mentioned, to indicate which slot the used archetype is filling. Templates may also be used to fill slots in the same way. Thus, in the following example, two archetypes and a template are designated to fill the <code>at0001</code> (<code>id2</code>) slot defined in the above fragment of ADL. The slot definition is not mentioned, so it remains unchanged, i.e. 'open'.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">uk.nhs.cfh::openEHR-EHR-EVALUATION.t_ed_diagnosis.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.clin_synopsis.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Past history</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">uk.nhs.cfh::openEHR-EHR-EVALUATION.t_ed_diagnosis.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.clin_synopsis.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Slots can be recursively filled in the above fashion, according to the possibilities offered by the chosen archetypes or templates. The following ADL fragment shows two levels of slot-filling:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-COMPOSITION.xxx.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">content</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-SECTION.yyy.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">uk.nhs.cfh::openEHR-EHR-EVALUATION.t_xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">openEHR-EHR-COMPOSITION.xxx.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">content</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-SECTION.yyy.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">uk.nhs.cfh::openEHR-EHR-EVALUATION.t_xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">org.openehr::openEHR-EHR-EVALUATION.xx.v1</span><span class="tok-p">]</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in the above the archetype fillers are specified as published archetypes, but in reality, it is far more likely that template-specific specialisations of these archetypes would be used. The identification and organisation of such archetypes is described in the openEHR Templates document.</p>
</div>
<div class="paragraph">
<p>In addition to or instead of specifying slot fillers, it is possible in a slot specialisation to narrow the slot definition, or to close it. If fillers are specified, closing the slot as well is typical. The latter is done by including an overridden version of the archetype slot object itself, with the 'closed' constraint set, as in the following example:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">org.openehr::openEHR-EHR-SECTION.history_medical_surgical.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">closed</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">org.openehr::openEHR-EHR-SECTION.history_medical_surgical.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.problem.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">closed</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Narrowing the slot is done with a replacement ` allow_archetype` statement containing a narrowed set of match criteria.</p>
</div>
</div>
<div class="sect3">
<h4 id="_unconstrained_attributes"><a class="anchor" href="#_unconstrained_attributes"></a>9.5.9. Unconstrained Attributes</h4>
<div class="paragraph">
<p>The <code>use_archetype</code> keyword can be used to specify child object constraints under any attribute in the reference model that is so far unconstrained by the flat parent of an archetype or template. Technically this could occur in any kind of archetype but would normally be in a specialised archetype or template. This is no more than the standard use of an 'external reference' (see <a href="#_external_references">Section 4.3.9</a>).</p>
</div>
<div class="paragraph">
<p>Any reference specified will have no slot, and is instead validity-checked against the appropriate part of the underlying reference model.</p>
</div>
<div class="paragraph">
<p>The following example from the openEHR reference model is typical.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- Referral document</span>
<span class="tok-w">        </span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT_CONTEXT</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">participations</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">other_context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- Referral document</span>
<span class="tok-w">        </span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT_CONTEXT</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">participations</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">other_context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above cADL block partially specifies a <code>COMPOSITION</code> object, via constraints (often including slot definitions) on the <em>category</em> and <em>context</em> attributes defined on that class in the reference model. However, the attribute of most interest in a <code>COMPOSITION</code> object is usually the <em>content</em> attribute, which is not constrained at all here. The reference model defines it to be of type <code>List&lt;CONTENT_ITEM&gt;</code> .</p>
</div>
<div class="paragraph">
<p>Using an external reference in an unarchetyped part of the RM structure is almost always done in specialised archetypes or templates, but is valid in a top-level archetype.</p>
</div>
<div class="paragraph">
<p>The following example shows the use of <code>use_archetype</code> within a specialised archetype.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- Referral document (specialisation)</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.history_medical_surgical.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">        </span><span class="tok-c">-- Referral document (specialisation)</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.history_medical_surgical.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_primitive_object_redefinition"><a class="anchor" href="#_primitive_object_redefinition"></a>9.6. Primitive Object Redefinition</h3>
<div class="paragraph">
<p>For terminal objects (i.e. elements of the type <code>C_PRIMITIVE_OBJECT</code>) redefinition consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>addition of value constraints for nodes which in the parent are constrained solely to a primitive type (described in <a href="#cADL_Constraints_Primitive_Types">Section 4.5</a>);</p>
</li>
<li>
<p>redefined value ranges or sets using a narrower value range or set;</p>
</li>
<li>
<p>exclusions on the previously defined value ranges or sets which have the effect of narrowing the original range or set.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_numeric_primitive_redefinition"><a class="anchor" href="#_numeric_primitive_redefinition"></a>9.6.1. Numeric Primitive Redefinition</h4>
<div class="paragraph">
<p>The following example shows a redefined real value range.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">2.0</span><span class="tok-p">..</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mmol/ml&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specialised archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">4.0</span><span class="tok-p">..</span><span class="tok-mf">6.5</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">4.0</span><span class="tok-p">..</span><span class="tok-mf">6.5</span><span class="tok-p">|}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_terminology_constraint_redefinition"><a class="anchor" href="#_terminology_constraint_redefinition"></a>9.6.2. Terminology Constraint Redefinition</h4>
<div class="paragraph">
<p>Redefinition of a terminology constraint follows the golden rule that redefinitions may only narrow constraints, not widen them, to preserve the instance / archetype validity relation up the specialisation lineage. The golden rule holds only for formal constraints, and is modified by the possibility of <a href="#_soft_terminology_constraint">non-binding constraint strengths</a>.</p>
</div>
<div class="sect4">
<h5 id="_constrain_previously_unconstrained_node"><a class="anchor" href="#_constrain_previously_unconstrained_node"></a>9.6.2.1. Constrain Previously Unconstrained Node</h5>
<div class="paragraph">
<p>The simplest form of terminology constraint specialisation is when a term constraint is used as a redefinition of a previously <em>unconstrained node</em>. This might simply be to require that a data item be of the appropriate reference model type, with no further constraint:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0021</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w">  </span><span class="tok-c">-- force a term of some kind</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w">  </span><span class="tok-c">-- force a term of some kind</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, it may impose a value set, as follows:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0021</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac0.1</span><span class="tok-p">]}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id22</span><span class="tok-p">]/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">  </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac0.1</span><span class="tok-p">]}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_terminology_internal_value_set_redefinition"><a class="anchor" href="#_terminology_internal_value_set_redefinition"></a>9.6.2.2. Terminology Internal Value Set Redefinition</h5>
<div class="paragraph">
<p>The more typical redefinition case is when the parent node already states a terminology constraint with a value set, and the specialisation child redefines is, as per the following example.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- System</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0007&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Cardiovascular system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0008&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Respiratory system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Gastro-intestinal system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Reticulo-Endothelial system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Genito-urinary system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Endocrine System</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Central nervous system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0014&quot;</span><span class="tok-w">    </span><span class="tok-c">-- Musculoskeletal system</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id7</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- System</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at8&quot;</span><span class="tok-p">,</span><span class="tok-w">    </span><span class="tok-c">-- Cardiovascular system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at9&quot;</span><span class="tok-p">,</span><span class="tok-w">    </span><span class="tok-c">-- Respiratory system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Gastro-intestinal system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Reticulo-Endothelial system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Genito-urinary system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Endocrine System</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Central nervous system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at15&quot;</span><span class="tok-w">    </span><span class="tok-c">-- Musculoskeletal system</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Specialised archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">name</span><span class="tok-p">[</span><span class="tok-nd">at0013</span><span class="tok-p">]/</span><span class="tok-nc">defining_code</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1.1</span><span class="tok-p">]}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Gastro-intestinal system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Reticulo-Endothelial system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Genito-urinary system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Endocrine System</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Central nervous system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at0014&quot;</span><span class="tok-w">    </span><span class="tok-c">-- Musculoskeletal system</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-p">.../</span><span class="tok-nc">name</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]/</span><span class="tok-nc">defining_code</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1.1</span><span class="tok-p">]}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Gastro-intestinal system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Reticulo-Endothelial system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Genito-urinary system</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- Endocrine System</span>
<span class="tok-w">                </span><span class="tok-s">&quot;at15&quot;</span><span class="tok-w">    </span><span class="tok-c">-- Musculoskeletal system</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_terminology_external_subset_redefinition"><a class="anchor" href="#_terminology_external_subset_redefinition"></a>9.6.2.3. Terminology External Subset Redefinition</h5>
<div class="paragraph">
<p>A terminology external subset constraint is used to set the value set of a coded term to be one defined externally in a terminology, specified in the <code>term_definitions</code> sub-section of the <code>terminology</code> section, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org/id/12000001</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org/id/12000001</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In a specialisation of the archetype, the value set reference can be redefined in two different ways. The first is by redefinition of the constraint to a narrower one. This is a achieved by redefining the constraint code, and adding a new definition in the terminology of the specialised archetype, as follows.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at0078</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1.1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org/id/12000002</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">id79</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- cuff size</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id14</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac1.1</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org/id/12000002</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The second kind of redefinition is by an internal value set, as follows.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0021&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- child cuff</span>
<span class="tok-w">                       </span><span class="tok-s">&quot;at0022&quot;</span><span class="tok-p">&gt;</span><span class="tok-w">   </span><span class="tok-c">-- infant cuff</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-p">...</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-s">&quot;&lt;at22&quot;</span><span class="tok-p">,</span><span class="tok-w">   </span><span class="tok-c">-- child cuff</span>
<span class="tok-w">                      </span><span class="tok-s">&quot;at23&quot;</span><span class="tok-p">&gt;</span><span class="tok-w">    </span><span class="tok-c">-- infant cuff</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These redefinitions are assumed to be valid, although they are not directly validatable unless the terminology subset is available to the tooling.</p>
</div>
</div>
<div class="sect4">
<h5 id="_constraint_strength_redefinition"><a class="anchor" href="#_constraint_strength_redefinition"></a>9.6.2.4. Constraint Strength Redefinition</h5>
<div class="paragraph">
<p>Regardless of any changes to the value constraint, narrowing must also be respected for the constraint strength. Concretely, this means that a redefined terminology constraint may narrow the constraint strength by redefining any strength declared in a parent to any 'higher' strength, where the following order holds, from lowest to highest: <code>example</code> &#8594; <code>preferred</code> &#8594; <code>exensible</code> &#8594; <code>required</code>. Thus, the following redefinition from <code>preferred</code> to <code>required</code> may be made:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- child archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- i.e. required</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- child archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- i.e. required</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A constraint with <code>required</code> strength cannot be redefined to any other strength in a specialised archetype.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Although the standard form <code>defining_code matches {[ac1]}</code> may always be used to represent 'required' strength, it is strongly recommended that the explicit form <code>defining_code matches {required [ac1]}</code> be used in specialised archetypes, <em>where the constraint strength is being redefined</em> (i.e. not for redefinition of a nodes where constraint strength is never mentioned).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It must be kept in mind that a constraint strength other than <code>required</code> is formally equivalent to <em>no constraint</em> - i.e. it is only a guide for tooling and human authors. The following two fragments are therefore completely equivalent.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- non-required constraint strength</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- ... is the same as no constraint, other than RM type</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- non-required constraint strength</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- ... is the same as no constraint, other than RM type</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13</span><span class="tok-p">]</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This means that redefinition of a node containing a non-required constraint strength is formally speaking a redefinition of a node with no constraint on terminology code values. <em>The specialised node may therefore state any value set, regardless of what value set was stated in the parent</em>. This is true regardless of whether the constraint strength itself is redefined. For example, in the following a <code>preferred</code> strength node with value set <code>ac1</code> is redefined by another <code>preferred</code> node using a non-conforming value set <code>ac0.4</code>.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- child archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac0.4</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-c">-- parent archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-w">    </span><span class="tok-c">-- child archetype</span>
<span class="tok-w">    </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id13.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">preferred</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">ac0.4</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tuple_redefinition"><a class="anchor" href="#_tuple_redefinition"></a>9.6.3. Tuple Redefinition</h4>
<div class="paragraph">
<p>Tuple constraints can be redefined by narrowing, as for other primitive constraints. A typical example is as follows.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at9001</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-nc">magnitude</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">units</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">50.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}],</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">68.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;cm[H20]&quot;</span><span class="tok-p">}]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id42</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at29</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-nc">magnitude</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">units</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">50.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}],</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">68.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;cm[H20]&quot;</span><span class="tok-p">}]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at9001</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-nc">magnitude</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">units</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">50.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-p">[</span><span class="tok-nd">id42</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">at29</span><span class="tok-p">]}</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-nc">magnitude</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">units</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-p">[{|&gt;=</span><span class="tok-mf">50.0</span><span class="tok-p">|},</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules"><a class="anchor" href="#_rules"></a>9.7. Rules</h3>
<div class="paragraph">
<p>The <code>rules</code> section in an archetype consists of definitions and assertion statements. Assertions in archetypes have the effect of further reducing the instance space that conforms to an archetype by specifying relationships between values that must hold. For example the main part of an archetype may specify that the existence of a subtree, containing data points related to 'tobacco use' for example, is dependent on the value of another data point representing 'smoker?' being True.</p>
</div>
<div class="paragraph">
<p>In specialised archetypes, further invariants can be added, but existing ones cannot be changed. New invariants cannot logically contradict existing invariants and are considered to be logically related to invariants from the flat parent by the logical semi-strict operator 'and then'.</p>
</div>
</div>
<div class="sect2">
<h3 id="_languages"><a class="anchor" href="#_languages"></a>9.8. Languages</h3>
<div class="paragraph">
<p>A specialised archetype or template is only required to have one language in common with its flat precursor, enabling a flat output containing this language. This supports the common situation in which an international standard archetype with numerous translations is used as a basis for further specialisation in a particular country or project. Clearly, the latter has no need of, and quite probably no capability for including all the original translations in the specialisation.</p>
</div>
<div class="paragraph">
<p>However, if the specialised archetype language is not present at all in the parent flat, it will need to be added to the archetypes in the specialisation lineage first.</p>
</div>
<div class="paragraph">
<p>The languages present in the flat output will therefore be those languages available in both the flat parent (implying all previous archetypes / templates in the specialisation lineage) and the new specialisation. Any new languages introduced in the latter not available in the flat parent will be discarded.</p>
</div>
<div class="paragraph">
<p>Locale-specific overrides can be introduced for any linguistic element in an archetype, including the terminology. Such an override has a language code conforming to a subset of the <a href="https://tools.ietf.org/html/rfc5646" target="_blank" rel="noopener">IETF RFC 5646 language tag standard</a>, namely the common 2-part language-region tag exemplified by 'en-GB' (British English), 'pt-BR' (Brazilian Portuguese), and so on. The tags are case-insensitive, but tools that create tags should follow the recommendation from the standard, which is that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>language tag is lowercase;</p>
</li>
<li>
<p>region tags are uppercase.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_description_section_2"><a class="anchor" href="#_description_section_2"></a>9.9. Description Section</h3>
<div class="paragraph">
<p>The <code>description</code> section of a specialised archetype or template always replaces that of the parent in the flattened result. The obvious alternative would be automatic inclusion of the corresponding <code>description</code> section elements from  precursor archetypes back up the specialisation lineage. The replacement approach is justified by the thinking that the documentary view of a specialised archetype, and particular a template, in their flattened form is likely to be most useful if it consists of the descriptions created by the developers of those specialised artefacts, rather than an accumulation of copies of the documentation elements down the lineage, since tools or special visualisations could provide views of each part of the description back up the specialisation hierarchy if required.</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: A third alternative, used in some programming languages the enable comments to be inherited might be to optionally include the test of a descriptive element of a parent archetype within the corresponding element of the child, for example by including a special string like <code><a href="#precursor">[precursor]</a></code> somewhere in the text. The flattener would search for this, iand if found, include the text from the parent. To have the effect of inclusion of all parent text elements, something like <code><a href="#all_precursors">[all_precursors]</a></code> could be used.</p>
</div>
</div>
<div class="sect2">
<h3 id="_terminology_section_2"><a class="anchor" href="#_terminology_section_2"></a>9.10. Terminology Section</h3>
<div class="paragraph">
<p>Specialisation in the <code>terminology</code> section manifests in terms of specialised and added terms in the <code>term_definitions</code> sub-section.</p>
</div>
<div class="paragraph">
<p>Value sets can be specialised, which has the effect in the flattened form of replacing the original rather than adding to it, as shown in the following example.</p>
</div>
<div class="paragraph">
<p>Parent archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2</span><span class="tok-err">.x.x; generated)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.code_list_parent.v1.0.0</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- General statement of exclusions or states</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Statement</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">       </span><span class="tok-c">-- Statement</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;General statement of exclusions or states&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ... have been excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No significant illness&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The person ... condition&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No significant past history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The person has no ... history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No relevant family history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No family history ... situation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No known allergies&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No allergies known to any ... or substances&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0013&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0007&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0008&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.0</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">generated</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.code_list_parent.v1.0.0</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-p">...</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- General statement of exclusions or states</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ITEM_TREE</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- Statement</span>
<span class="tok-w">                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac1</span><span class="tok-p">]}</span><span class="tok-w">       </span><span class="tok-c">-- Statement</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;General statement of exclusions or states&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ... have been excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at4&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No significant illness&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The person ... condition&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at5&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No significant past history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The person has no ... history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No relevant family history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No family history ... situation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No known allergies&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No allergies known to any ... or substances&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at4&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at5&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at6&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at7&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at14&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at11&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at12&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at8&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at9&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Flattened child archetype:</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2</span><span class="tok-err">.x.x; generated)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.code_list_constrained.v1.0.0</span>

<span class="tok-w">    </span><span class="tok-c">-- ...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;General statement of exclusions or states&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ...have been excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No relevant family history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No family history relevant .. situation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;(added by post-parse processor)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;(added by post-parse processor)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0000.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction exclusions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ... of adverse reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.0</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">generated</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.code_list_constrained.v1.0.0</span>

<span class="tok-w">    </span><span class="tok-c">-- ...</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;General statement of exclusions or states&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ...have been excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No relevant family history&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;No family history relevant .. situation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Statement&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The statement about what is excluded&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;(added by post-parse processor)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;(added by post-parse processor)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction exclusions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A category of ... of adverse reaction&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1.1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at6&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at7&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at13&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The flattened result always includes the sum of term definitions from the parent.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bindings"><a class="anchor" href="#_bindings"></a>9.11. Bindings</h3>
<div class="paragraph">
<p>Bindings in a specialised archetype can include a binding to an at-code or ac-code defined in the current archetype or any parent archetype. A binding may be defined that overrides one from the flat parent, in which case the binding target - a term (at-code binding) or value set (ac-code binding) should be a proper specialised concept or subset respectively of the binding they replace. Since the binding target is an external code or subset, authoring tools need a connection to an appropriate terminology service to validate the relationship.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_templates"><a class="anchor" href="#_templates"></a>10. Templates</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_6"><a class="anchor" href="#_overview_6"></a>10.1. Overview</h3>
<div class="paragraph">
<p>In ADL2, a template is a kind of specialised archetype that uses one feature of ADL in particular to express composition of archetypes: the ability to state 'slot fillers'. This is achieved by redefinition of a slot node, where the latter alters the slot by specifying one or more filler archetypes that match the slot specification.</p>
</div>
<div class="paragraph">
<p>It is worth emphasising this point, since 'slot-filling' is usually thought of as a compositional relationship (joining archetypes), rather than a specialisation relationship. However, ADL considers a filled or partly filled slot as a kind of slot, i.e. a specialisation of an initially empty slot. The consequence of this is that no special relationship or operation is required to achieve slot-filling in ADL - normal node redefinition is sufficient.</p>
</div>
<div class="paragraph">
<p>All of the other constraints used in templates typically occur in normal archetypes, with one exception: multiplicity reduction to <code>{0}</code> of existences, cardinalities and occurrences. This particular constraint can be used in archetypes, but is generally only useful in templates, since one of the main functions of a template is to select specific data items from archetypes composed in a structure.</p>
</div>
<div class="paragraph">
<p>ADL provides one other special feature specific to templates: the ability to define 'overlays'. An overlay is just a specialised archetype that is local to the template, rather than being a self-standing archetype. It is used to enable a template to fill a slot not only with an available normal archetype, but with a locally constrained version of an archetype. This feature enables a template to express constraints on a filler archetype without need to create new independent archetype.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example"><a class="anchor" href="#_example"></a>10.2. Example</h3>
<div class="paragraph">
<p>By way of illustrating ADL&#8217;s template-related ADL features, an example is useful. The following is the openEHR archetype <code>openEHR-EHR-COMPOSITION.discharge.v1</code> for the generic concept 'discharge summary' followed by a template representing a full patient clinical information discharge summary, consisting of <code>COMPOSITION</code>, <code>SECTION</code> and various <code>ENTRY</code> archetypes.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2</span><span class="tok-err">.x.x; rm_release=1.0.3)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1.0.0</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Heather Leslie&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ocean Informatics&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;heather.leslie@oceaninformatics.com&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;14/11/2007&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;For communication at the time of discharge from an episode of care or an institution.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Discharge</span>
<span class="tok-w">        </span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at0009</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">CONTENT_ITEM</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-(SECTION|EVALUATION)/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT_CONTEXT</span><span class="tok-p">[</span><span class="tok-nd">at0029</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">other_context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-p">...</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Discharge&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A summarising communication about at the time of discharge from an institution or an episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Cinical discharge notes&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;*&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1.0.0</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Heather Leslie&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ocean Informatics&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;heather.leslie@oceaninformatics.com&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;14/11/2007&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;For communication at the time of discharge from an episode of care or an institution.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">id1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Discharge</span>
<span class="tok-w">        </span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id29</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at10</span><span class="tok-p">]}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">CONTENT_ITEM</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-(SECTION|EVALUATION)/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT_CONTEXT</span><span class="tok-p">[</span><span class="tok-nd">id30</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">other_context</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-p">...</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Discharge&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A summarising communication about at the time of discharge from an institution or an episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Cinical discharge notes&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;*&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Below is the template definition. The root artefact is a self-standing template <code>openEHR-EHR-COMPOSITION.t_clinical_info_ds_sf.v1.0.0</code> that specialises the archetype . The declaration of being a 'template' is primarily to signal to tools the intended use of the artefact - it doesn&#8217;t have any formal implications. The job of the template is to define the specific clinical information required in a discharge summary (note that not all the usual items are included, in order to reduce the size of the template as shown here - clinical synopsis and medications list are left out).</p>
</div>
<div class="paragraph">
<p>In the root template, the <code>definition</code> section contains a number of <code>use_archetype</code> statements that specify archetypes to be used as fillers for the <code>at0001</code> (<code>id2</code>) slot of the parent archetype. Each of the slot-fillers is a template overlay, rather than being an independent archetype or template. As a result, each overlay includes no descriptive meta-data of its own, and appears within the template artefact, separated by a long comment line. This simple mechanism enables the overlays, which are in all other respects formal archetypes, to be treated as local additions to the template, not visible externally. The template, if saved as a file, contains all its overlays in one file.</p>
</div>
<div class="paragraph">
<p>Each of the filler archetypes can have its occurrences individually constrained in the normal way.</p>
</div>
<div class="paragraph">
<p>Each overlay can be seen to be a specialisation of an archetype (it could also have been a template). The overlays also do not include any <code>languages</code> or <code>description</code> sections, since as parts of the parent template, they inherit these sections from the root template.</p>
</div>
<div class="paragraph">
<p>Additionally, some overlays contain element removal constraints (<code>occurrences matches {0}</code>), used to reduce the data set to the intended final result for the purpose of this template. Clearly other templates could make quite different selections of data items from the same archetypes.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">template</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2</span><span class="tok-err">.x.x; rm_release=1.0.3)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.t_clinical_info_ds_sf.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ian McNicoll&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ian.mcnicoll@openehr.org&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;01/04/2011&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">copyright</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;copyright (c) 2011 openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Templated clinical COMPOSITION for Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Clinical detail</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-1.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-2.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-4.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.6</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-5.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.8</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-7.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.9</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-8.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical detail&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical detail of Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Event data&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Event data&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Allergies &amp; adverse reactions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Allergies &amp; adverse reactions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Alerts&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Alerts&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.5&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Diagnosis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Diagnosis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.6&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Investigations&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Investigations&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.8&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Procedures&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Procedures&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0.9&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Medical certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Medical certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
-------------------------------------------------------------
<span class="tok-gh">template_overlay</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-1.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.adverse.v1</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Adverse reaction details for episode of care</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0019</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0032</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0015</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0020</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction details for episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction details for episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-s">-------------- etc ------------------------------------------</span>

-------------------------------------------------------------
<span class="tok-gh">template_overlay</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-8.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.medical_certificate.v1</span>


<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Simple Discharge Summary Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Simple Discharge Summary Medical Certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Only used for Discharge Summary Document&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">template</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.5</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.t_clinical_info_ds_sf.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ian McNicoll&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ian.mcnicoll@openehr.org&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;01/04/2011&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">copyright</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;copyright (c) 2011 openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Templated clinical COMPOSITION for Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Clinical detail</span>
<span class="tok-w">        </span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-1.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-2.v1</span><span class="tok-p">]</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-4.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.6</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-5.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.8</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-7.v1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">use_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id0.9</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-8.v1</span><span class="tok-p">]</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical detail&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Clinical detail of Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Event data&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Event data&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.2&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Allergies &amp; adverse reactions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Allergies &amp; adverse reactions&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.3&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Alerts&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Alerts&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.5&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Diagnosis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Diagnosis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.6&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Investigations&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Investigations&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.8&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Procedures&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Procedures&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id0.9&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Medical certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Medical certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
-------------------------------------------------------------
<span class="tok-gh">template_overlay</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-1.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.adverse.v1</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Adverse reaction details for episode of care</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id11</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">id20</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id33</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id16</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id21</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction details for episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adverse reaction details for episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-s">-------------- etc ------------------------------------------</span>

-------------------------------------------------------------
<span class="tok-gh">template_overlay</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.t_clinical_info_ds_sf-8.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-EVALUATION.medical_certificate.v1</span>


<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">EVALUATION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- Simple Discharge Summary Medical Certificate</span>
<span class="tok-w">        </span><span class="tok-p">/</span><span class="tok-nc">data</span><span class="tok-p">[</span><span class="tok-nd">id2</span><span class="tok-p">]/</span><span class="tok-nc">items</span><span class="tok-p"> </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">id5</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o"></span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;id1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Simple Discharge Summary Medical Certificate&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Only used for Discharge Summary Document&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When the above is flattened, with all overlays, slot fillers and external references being inlined, a single operational template results, as shown below. Note the <code>component_terminologies</code> section at the end, which contains the terminology of every constituent overlay and archetype.</p>
</div>
<div class="listingblock">
<div class="title">at-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">operational_template</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2</span><span class="tok-err">.x.x; rm_release=1.0.3; generated)</span>
<span class="tok-w">	</span><span class="tok-nd">openEHR-EHR-COMPOSITION.t_clinical_info_ds_sf.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">	</span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1</span>

<span class="tok-gh">language</span>
<span class="tok-w">	</span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">	</span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ian McNicoll&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ocean Informatics&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ian.mcnicoll@oceaninformatics.com&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;01/04/2011&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">copyright</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;copyright (c) 2011 openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">			</span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Templated clinical COMPOSITION for Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">	</span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">at0000.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Clinical detail</span>
<span class="tok-w">		</span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">			</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">at0028</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">				</span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at0009</span><span class="tok-p">]}</span>
<span class="tok-w">			</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">			</span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1.0.0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Event start</span>
<span class="tok-w">				</span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">					</span><span class="tok-nc">ADMIN_ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at0.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ADMIN_ENTRY.t_patient_event_info_ds_sf-1.v1.0.0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">						</span><span class="tok-nc">other_participations</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-c">--- etc ---</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-c">--- etc ---</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">	</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Discharge&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A summarising communication about at the time of discharge from an institution or an episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Report identifier&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Identification information about the report&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;openehr&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://openehr.org/id/433</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0007&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at0008&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>

<span class="tok-gh">component_terminologies</span>
<span class="tok-w">	</span><span class="tok-p">[</span><span class="tok-s">&quot;openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1.0.0&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">					</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adhoc heading&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">					</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A generic section header.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">[</span><span class="tok-s">&quot;openEHR-EHR-ADMIN_ENTRY.t_patient_event_info_ds_sf-1.v1.0.0&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">					</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Admission Short Singapore&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">					</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Administrative information for the admission of a patient to the care of a hospital/institution&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">id-coded ADL2 syntax</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">operational_template</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">2.0.6</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">rm_release</span><span class="tok-o">=</span><span class="tok-l">1.0.2</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">generated</span><span class="tok-p">)</span>
<span class="tok-w">	</span><span class="tok-nd">openEHR-EHR-COMPOSITION.t_clinical_info_ds_sf.v1.0.0</span>

<span class="tok-gh">specialize</span>
<span class="tok-w">	</span><span class="tok-nd">openEHR-EHR-COMPOSITION.discharge.v1</span>

<span class="tok-gh">language</span>
<span class="tok-w">	</span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">description</span>
<span class="tok-w">	</span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;unmanaged&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ian McNicoll&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ocean Informatics&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ian.mcnicoll@oceaninformatics.com&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;01/04/2011&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">copyright</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;copyright (c) 2011 openEHR Foundation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">ISO_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">			</span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Templated clinical COMPOSITION for Simple discharge summary&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">	</span><span class="tok-nc">COMPOSITION</span><span class="tok-p">[</span><span class="tok-nd">id1.1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Clinical detail</span>
<span class="tok-w">		</span><span class="tok-nc">category</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">			</span><span class="tok-nc">DV_CODED_TEXT</span><span class="tok-p">[</span><span class="tok-nd">id29</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">				</span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">at10</span><span class="tok-p">]}</span>
<span class="tok-w">			</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-nc">context</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">		</span><span class="tok-nc">content</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">			</span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1.0.0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">	</span><span class="tok-c">-- Event start</span>
<span class="tok-w">				</span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">					</span><span class="tok-nc">ADMIN_ENTRY</span><span class="tok-p">[</span><span class="tok-nd">id0.1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">openEHR-EHR-ADMIN_ENTRY.t_patient_event_info_ds_sf-1.v1.0.0</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">						</span><span class="tok-nc">other_participations</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0</span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-c">--- etc ---</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-c">--- etc ---</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">terminology</span>
<span class="tok-w">	</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Discharge&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A summarising communication about at the time of discharge from an institution or an episode of care&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;id4&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Report identifier&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Identification information about the report&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;openehr&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;at10&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://openehr.org/id/433</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-nc">value_sets</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-p">[</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-nc">id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ac1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">			</span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;at6&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at7&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at8&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;at9&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>

<span class="tok-gh">component_terminologies</span>
<span class="tok-w">	</span><span class="tok-p">[</span><span class="tok-s">&quot;openEHR-EHR-SECTION.t_patient_event_info_ds_sf.v1.0.0&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">					</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Adhoc heading&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">					</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;A generic section header.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">[</span><span class="tok-s">&quot;openEHR-EHR-ADMIN_ENTRY.t_patient_event_info_ds_sf-1.v1.0.0&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">		</span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">			</span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">				</span><span class="tok-p">[</span><span class="tok-s">&quot;id1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">					</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Admission Short Singapore&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">					</span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Administrative information for the admission of a patient to the care of a hospital/institution&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">				</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-c">------- etc ---------</span>
<span class="tok-w">			</span><span class="tok-p">&gt;</span>
<span class="tok-w">		</span><span class="tok-p">&gt;</span>
<span class="tok-w">	</span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_of_adl_to_other_formalisms"><a class="anchor" href="#_relationship_of_adl_to_other_formalisms"></a>Appendix A: Relationship of ADL to Other Formalisms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_7"><a class="anchor" href="#_overview_7"></a>A.1. Overview</h3>
<div class="paragraph">
<p>Whenever a new formalism is defined, it is reasonable to ask the question: are there not existing formalisms which would do the same job? Research to date has shown that in fact, no other formalism has been designed for the same use, and none easily express ADL&#8217;s semantics. During ADL&#8217;s initial development, it was felt that there was great value in analysing the problem space very carefully, and constructing an abstract syntax exactly matched to the solution, rather than attempting to use some other formalism - undoubtedly designed for a different purpose - to try and express the semantics of archetypes, or worse, to start with an XML-based exchange format, which often leads to the conflation of abstract and concrete representational semantics. Instead, the approach used has paid off, in that the resulting syntax is very simple and powerful, and in fact has allowed mappings to other formalisms to be more correctly defined and understood. The following sections compare ADL to other formalisms and show how it is different.</p>
</div>
</div>
<div class="sect2">
<h3 id="_constraint_syntaxes"><a class="anchor" href="#_constraint_syntaxes"></a>A.2. Constraint Syntaxes</h3>
<div class="sect3">
<h4 id="_omg_ocl_object_constraint_language"><a class="anchor" href="#_omg_ocl_object_constraint_language"></a>A.2.1. OMG OCL (Object Constraint Language)</h4>
<div class="paragraph">
<p>The OMG&#8217;s Object Constraint Language (OCL) appears at first glance to be an obvious contender for writing archetypes. However, its designed use is to write constraints on object models, rather than on data, which is what archetypes are about. As a concrete example, OCL can be used to make statements about the actors attribute of a class Company - e.g. that actors must exist and contain the Actor who is the lead of Company. However, if used in the normal way to write constraints on a class model, it cannot describe the notion that for a particular kind of (acting) company, such as 'itinerant jugglers', there must be at least four actors, each of whom have among their capabilities 'advanced juggling', plus an Actor who has skill 'musician'. This is because doing so would constrain all instances of the class Company to conform to the specific configuration of instances corresponding to actors and jugglers, when what is intended is to allow a myriad of possibilities. ADL provides the ability to create numerous archetypes, each describing in detail a concrete configuration of instances of type Company.  OCL&#8217;s constraint types include function pre- and post-conditions, and class invariants. There is no structural character to the syntax - all statements are essentially first-order predicate logic statements about elements in models expressed in UML, and are related to parts of a model by 'context' statements.  This makes it impossible to use OCL to express an archetype in a structural way which is natural to domain experts. OCL also has some flaws, described by <span class="citation"><a href="#Beale2003">Beale (2003)</a></span>.  However, OCL is in fact relevant to ADL. ADL archetypes include invariants (and one day, might include pre- and post-conditions). Currently these are expressed in a syntax very similar to OCL, with minor differences. The exact definition of the ADL invariant syntax in the future will depend somewhat on the progress of OCL through the OMG standards process.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ontology_formalisms"><a class="anchor" href="#_ontology_formalisms"></a>A.3. Ontology Formalisms</h3>
<div class="sect3">
<h4 id="_owl_web_ontology_language"><a class="anchor" href="#_owl_web_ontology_language"></a>A.3.1. OWL (Web Ontology Language)</h4>
<div class="paragraph">
<p>The <a href="https://www.w3.org/TR/2003/CR-owl-ref-20030818/" target="_blank" rel="noopener">W3C Web Ontology Language (OWL)</a> is a W3C initiative for defining Web-enabled ontologies which aim to allow the building of the "Semantic Web". OWL has an abstract syntax, developed at the University of Manchester, UK, and an exchange syntax, which is an extension of the XML-based syntax known as RDF (Resource Description Framework). We discuss OWL only in terms of its abstract syntax, since this is a semantic representation of the language unencumbered by XML or RDF details (there are tools which convert between abstract OWL and various exchange syntaxes).</p>
</div>
<div class="paragraph">
<p>OWL is a general purpose description logic (DL), and is primarily used to describe 'classes' of things in such a way as to support subsumptive inferencing within the ontology, and by extension, on data which are instances of ontology classes. There is no general assumption that the data itself were built based on any particular class model - they might be audio-visual objects in an archive, technical documentation for an aircraft or the Web pages of a company. OWL&#8217;s class definitions are therefore usually constraint statements on an <em>implied</em> model on which data <em>appear</em> to be based. However, the semantics of an information model can themselves be represented in OWL. Restrictions are the primary way of defining subclasses.</p>
</div>
<div class="paragraph">
<p>In intention, OWL is aimed at representing some 'reality' and then making inferences about it; for example in a medical ontology, it can infer that a particular patient is at risk of ischemic heart disease due to smoking and high cholesterol, if the knowledge that 'ischemic heart disease has-risk-factor smoking' and 'ischemic heart disease has-risk-factor high cholesterol' are in the ontology, along with a representation of the patient details themselves. OWL&#8217;s inferencing works by subsumption, which is to say, asserting either that an 'individual' (OWL&#8217;s equivalent of an object-oriented instance or a type) conforms to a 'class', or that a particular 'class' 'is-a' (subtype of another) 'class'; this approach can also be understood as category-based reasoning or set-containment.</p>
</div>
<div class="paragraph">
<p>ADL can also be thought of as being aimed at describing a 'reality', and allowing inferences to be made. However, the reality it describes is in terms of constraints on information structures (based on an underlying information model), and the inferencing is between data and the constraints. Some of the differences between ADL and OWL are as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ADL syntax is predicated on the existence of existing object-oriented reference models, expressed in UML or some similar formalism, and the constraints in an ADL archetype are in relation to types and attributes from such a model. In contrast, OWL is far more general, and requires the explicit expression of a reference model in OWL, before archetype-like constraints can be expressed.</p>
</li>
<li>
<p>Because information structures are in general hierarchical compositions of nodes and elements, and may be quite deep, ADL enables constraints to be expressed in a structural, nested way, mimicking the tree-like nature of the data it constrains. OWL does not provide a native way to do this, and although it is possible to express approximately the same constraints in OWL, it is fairly inconvenient, and would probably only be made easy by machine conversion from a visual format more or less like ADL.</p>
</li>
<li>
<p>As a natural consequence of dealing with heavily nested structures in a natural way, ADL also provides a path syntax, based on <a href="https://www.w3.org/TR/xpath-31/" target="_blank" rel="noopener">W3C Xpath</a>, enabling any node in an archetype to be referenced by a path or path pattern. OWL does not provide an inbuilt path mechanism; Xpath can presumably be used with the RDF representation, although it is not yet clear how meaningful the paths would be with respect to the named categories within an OWL ontology.</p>
</li>
<li>
<p>ADL also natively takes care of disengaging natural language and terminology issues from constraint statements by having a separate ontology per archetype, which contains 'bindings' and language-specific translations. OWL has no inbuilt syntax for this, requiring such semantics to be represented from first principles.</p>
</li>
<li>
<p>ADL provides a rich set of constraints on primitive types, including dates and times. OWL 1.0 (c 2005) did not provide any equivalents; OWL 1.1 (c 2007) look as though it provides some.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Research to date shows that the semantics of an archetype are likely to be representable inside OWL, assuming expected changes to improve its primitive constraint types occur. To do so would require the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>express the relevant reference models in OWL (this has been shown to be possible);</p>
</li>
<li>
<p>express the relevant terminologies in OWL (research on this is ongoing);</p>
</li>
<li>
<p>be able to represent concepts (i.e. constraints) independently of natural language (status unknown);</p>
</li>
<li>
<p>convert the cADL part of an archetype to OWL; assuming the problem of primitive type constraints is solved, research to date shows that this should in principle be possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the archetype on data, the data themselves would have to be converted to OWL, i.e. be expressed as 'individuals'. In conclusion, we can say that mathematical equivalence between OWL and ADL is probably provable. However, it is clear that OWL is far from a convenient formalism to express archetypes, or to use them for modelling or reasoning against data. The ADL approach makes use of existing UML semantics and existing terminologies, and adds a convenient syntax for expressing the required constraints. It also appears fairly clear that even if all of the above conversions were achieved, using OWL-expressed archetypes to validate data (which would require massive amounts of data to be converted to OWL statements) is unlikely to be anywhere near as efficient as doing it with archetypes expressed in ADL or one of its concrete expressions.</p>
</div>
<div class="paragraph">
<p>Nevertheless, OWL provides a very powerful generic reasoning framework, and offers a great deal of inferencing power of far wider scope than the specific kind of 'reasoning' provided by archetypes. It appears that it could be useful for the following archetype-related purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>providing access to ontological resources while authoring archetypes, including terminologies, pure domain-specific ontologies, etc;</p>
</li>
<li>
<p>providing a semantic 'indexing' mechanism allowing archetype authors to find archetypes relating to specific subjects (which might not be mentioned literally within the archetypes);</p>
</li>
<li>
<p>providing inferencing on archetypes in order to determine if a given archetype is subsumed within another archetype which it does not specialise (in the ADL sense);</p>
</li>
<li>
<p>providing access to archetypes from within a semantic Web environment, such as an ebXML server or similar.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_kif_knowledge_interchange_format"><a class="anchor" href="#_kif_knowledge_interchange_format"></a>A.3.2. KIF (Knowledge Interchange Format)</h4>
<div class="paragraph">
<p>The Knowledge Interchange Format (KIF) is a knowledge representation language whose goal is to be able to describe formal semantics which would be sharable among software entities, such as information systems in an airline and a travel agency. An example of KIF (taken from <span class="citation">(<a href="#Genesereth_Fikes_Gruber1992">Genesereth&#44; Fikes&#44; &amp; Gruber&#44; 1992</a>)</span>) used to describe the simple concept of 'units' in a class is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="lisp"><span></span><span class="tok-p">(</span><span class="tok-nv">defrelation</span><span class="tok-w"> </span><span class="tok-nv">BASIC-UNIT</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">BASIC-UNIT</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-c1">; basic units are distinguished units of measure</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-nv">deffunction</span><span class="tok-w"> </span><span class="tok-nv">UNIT*</span>
<span class="tok-w">        </span><span class="tok-c1">; Unit* maps all pairs of units to units</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">defined</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))))</span>

<span class="tok-w">        </span><span class="tok-c1">; It is commutative</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-p">))</span>

<span class="tok-w">        </span><span class="tok-c1">; It is associative</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?u3</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?u3</span><span class="tok-p">))</span>
<span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nv">deffunction</span><span class="tok-w"> </span><span class="tok-nv">UNIT^</span>
<span class="tok-w">        </span><span class="tok-c1">; Unit^ maps all units and reals to units</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">real-number</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">defined</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))))</span>

<span class="tok-w">        </span><span class="tok-c1">; It has the algebraic properties of exponentiation</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r2</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">+</span><span class="tok-w"> </span><span class="tok-nv">?r1</span><span class="tok-w"> </span><span class="tok-nv">?r2</span><span class="tok-p">)))</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)))</span>
<span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It should be clear from the above that KIF is a definitional language - it defines all the concepts it mentions. However, the most common situation in which we find ourselves is that information models already exist, and may even have been deployed as software. Thus, to use KIF for expressing archetypes, the existing information model and relevant terminologies would have to be converted to KIF statements, before archetypes themselves could be expressed. This is essentially the same process as for expressing archetypes in OWL.</p>
</div>
<div class="paragraph">
<p>It should also be realised that KIF is intended as a knowledge exchange format, rather than a knowledge representation format, which is to say that it can (in theory) represent the semantics of any other knowledge representation language, such as OWL. This distinction today seems fine, since Web-enabled languages like OWL probably don&#8217;t need an exchange format other than their XML equivalents to be shared. The relationship and relative strengths and deficiencies is explored by e.g. <span class="citation"><a href="#Martin2003">Martin (2003)</a></span>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_based_formalisms"><a class="anchor" href="#_xml_based_formalisms"></a>A.4. XML-based Formalisms</h3>
<div class="sect3">
<h4 id="_xml_schema"><a class="anchor" href="#_xml_schema"></a>A.4.1. XML-schema</h4>
<div class="paragraph">
<p>Previously, archetypes have been expressed as XML instance documents conforming to W3C XML schemas, for example in the Good Electronic Health Record project (see <span class="citation"><a href="#GeHR_AUS">Beale &amp; Heard (2000)</a></span>). The schemas used in those projects correspond technically to the XML expressions of information model-dependent object models shown in The Archetypes: Technical Overview specification. XML archetypes are accordingly equivalent to serialised instances of the parse tree, i.e. particular ADL archetypes serialised from objects into XML instance.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax_specification"><a class="anchor" href="#_syntax_specification"></a>Appendix B: Syntax Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The normative specification of the ADL2 syntax is expressed in Antlr4 as a series of component grammars, shown below. This has been tested with the Antlr 4.9 implementation available from <a href="http://www.antlr.org" target="_blank" rel="noopener">Antlr.org</a>. The source files are available in two locations on Github - <a href="https://github.com/openEHR/adl-antlr/tree/master/src/main/antlr/adl" target="_blank" rel="noopener">adl-antlr repository</a>. The ODIN grammar used in parts of an ADL archetype is not shown below, it can be found in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">openEHR ODIN specification</a>.</p>
</div>
<div class="sect2">
<h3 id="_adl_outer_syntax"><a class="anchor" href="#_adl_outer_syntax"></a>B.1. ADL Outer Syntax</h3>
<div class="paragraph">
<p>The following grammar expresses the outer syntax of ADL, i.e. the top-level structure of section keywords and initial identification lines in an ADL text.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">//  description: Antlr4 grammar for Archetype Definition Language (ADL2)</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2015- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//  license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">Adl2</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl2;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ============== Parser rules ==============</span>
<span class="tok-c">//</span>

<span class="tok-err">adl2Archetype</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">authored_archetype</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">template</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">template_overlay</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">operational_template</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-no">EOF</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">authored_archetype</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">archetypeHrid</span>
<span class="tok-w">    </span><span class="tok-nv">specialize_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">language_section</span>
<span class="tok-w">    </span><span class="tok-nv">description_section</span>
<span class="tok-w">    </span><span class="tok-nv">definition_section</span>
<span class="tok-w">    </span><span class="tok-nv">rules_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">terminology_section</span>
<span class="tok-w">    </span><span class="tok-nv">annotations_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">template</span><span class="tok-p">:</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-no">SYM_TEMPLATE</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-nv">archetypeHrid</span>
<span class="tok-w">    </span><span class="tok-nv">specialize_section</span>
<span class="tok-w">    </span><span class="tok-nv">language_section</span>
<span class="tok-w">    </span><span class="tok-nv">description_section</span>
<span class="tok-w">    </span><span class="tok-nv">definition_section</span>
<span class="tok-w">    </span><span class="tok-nv">rules_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">terminology_section</span>
<span class="tok-w">    </span><span class="tok-nv">annotations_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-o">(</span><span class="tok-nv">template_overlay</span><span class="tok-o">)*</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">template_overlay</span><span class="tok-p">:</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-no">SYM_TEMPLATE_OVERLAY</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-nv">archetypeHrid</span>
<span class="tok-w">    </span><span class="tok-nv">specialize_section</span>
<span class="tok-w">    </span><span class="tok-nv">definition_section</span>
<span class="tok-w">    </span><span class="tok-nv">terminology_section</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">operational_template</span><span class="tok-p">:</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-no">SYM_OPERATIONAL_TEMPLATE</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-nv">archetypeHrid</span>
<span class="tok-w">    </span><span class="tok-nv">language_section</span>
<span class="tok-w">    </span><span class="tok-nv">description_section</span>
<span class="tok-w">    </span><span class="tok-nv">definition_section</span>
<span class="tok-w">    </span><span class="tok-nv">rules_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">terminology_section</span>
<span class="tok-w">    </span><span class="tok-nv">annotations_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">component_terminologies_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">archetypeHrid</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_HRID</span><span class="tok-p">;</span>

<span class="tok-nl">specialize_section</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_SPECIALIZE</span><span class="tok-w"> </span><span class="tok-nv">archetype_ref</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">language_section</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_LANGUAGE</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">description_section</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_DESCRIPTION</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">definition_section</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_DEFINITION</span><span class="tok-w"> </span><span class="tok-nv">c_complex_object</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">rules_section</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_RULES</span><span class="tok-w"> </span><span class="tok-nv">statement_block</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">terminology_section</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_TERMINOLOGY</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">annotations_section</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_ANNOTATIONS</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">component_terminologies_section</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_COMPONENT_TERMINOLOGIES</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_item</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">meta_data_tag_adl_version</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_uid</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_build_uid</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_rm_release</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_is_controlled</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_is_generated</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">odin_object_key</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_value</span><span class="tok-w"> </span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_value</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">primitive_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_tag_adl_version</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;adl_version&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_uid</span><span class="tok-w">           </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;uid&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_build_uid</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;build_uid&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_rm_release</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;rm_release&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_is_controlled</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;controlled&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_is_generated</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;generated&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cadl_syntax"><a class="anchor" href="#_cadl_syntax"></a>B.2. cADL Syntax</h3>
<div class="paragraph">
<p>The following grammar expresses the syntax of cADL composite types, i.e. the language of the <code>definition</code> section of an archetype.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// description: Antlr4 grammar for cADL non-primitves sub-syntax of Archetype Definition Language (ADL2)</span>
<span class="tok-c">// author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">// contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">// support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">// copyright:   Copyright (c) 2015 openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">// license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">cadl2</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl2_primitives</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">base_expressions</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Top-level Objects ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">c_complex_object</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">ROOT_ID_CODE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_attribute_def</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-nv">default_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ======================== Components =======================</span>

<span class="tok-nl">c_objects</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">c_regular_object_ordered</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_inline_primitive_object</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">sibling_order</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_AFTER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_BEFORE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_regular_object_ordered</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">sibling_order</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">c_regular_object</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_regular_object</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_archetype_root</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_complex_object_proxy</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">archetype_slot</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_regular_primitive_object</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_root</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_USE_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">archetype_ref</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">archetype_ref</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_HRID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_REF</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object_proxy</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_USE_NODE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">archetype_slot</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_ALLOW_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-o">((</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_includes</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">c_excludes</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_CLOSED</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_attribute_def</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_attribute</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_attribute_tuple</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">default_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_DEFAULT</span><span class="tok-w"> </span><span class="tok-no">SYM_EQ</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-p">;</span>

<span class="tok-nl">c_regular_primitive_object</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_inline_primitive_object</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// We match regexes here, even though technically they are C_STRING instances. This is because the only</span>
<span class="tok-c">// workable solution to match a regex unambiguously appears to be to match with enclosing {}, which means</span>
<span class="tok-c">// as a C_OBJECT alternative, not as a C_STRING.</span>
<span class="tok-nl">c_attribute</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">rm_attribute_id</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">c_existence</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">c_cardinality</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_objects</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CONTAINED_REGEXP</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_attribute_tuple</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">rm_attribute_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">rm_attribute_id</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_tuple</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_tuple</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_primitive_tuple</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_tuple_item</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_tuple_item</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_primitive_tuple_item</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_inline_primitive_object</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CONTAINED_REGEXP</span><span class="tok-p">;</span>

<span class="tok-nl">c_includes</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_INCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">c_excludes</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_EXCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_existence</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTENCE</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">existence</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">existence</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_cardinality</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_CARDINALITY</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">cardinality</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">cardinality</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">multiplicity</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">multiplicity_mod</span><span class="tok-w"> </span><span class="tok-nv">multiplicity_mod</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c">// max of two</span>
<span class="tok-nl">ordering_mod</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_ORDERED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_UNORDERED</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">unique_mod</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">multiplicity_mod</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">ordering_mod</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">unique_mod</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_occurrences</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_OCCURRENCES</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">multiplicity</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">multiplicity</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// ---------- Lexer patterns -----------------</span>
<span class="tok-c">//</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cadl_primitives_syntax"><a class="anchor" href="#_cadl_primitives_syntax"></a>B.3. cADL Primitives Syntax</h3>
<div class="paragraph">
<p>The following grammar defines the syntax of cADL primitives, which are used by cADL composites and also by ADL rules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// description: Antlr4 grammar for cADL primitives sub-syntax of Archetype Definition Language (ADL2)</span>
<span class="tok-c">// author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">// contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">// support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">// copyright:   Copyright (c) 2015 openEHR Foundation</span>
<span class="tok-c">// license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">cadl2_primitives</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">adl_keywords</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin_values</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Parser rules ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">c_inline_primitive_object</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_integer</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_real</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_duration</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_string</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_terminology_code</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_boolean</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_integer</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_integer_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_integer_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_real</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_real_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_real_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_date_time</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">DATE_TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_date_time_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_date_time_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_date</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">DATE_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_date_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_date_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_time</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_time_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_time_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_duration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">DURATION_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">))?</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_duration_value</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_duration_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_string</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">string_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_string_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_string_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ADL2 term types: [ac3], [ac3; at5], [at5]</span>
<span class="tok-c">// NOTE: an assumed at-code (the &#39;;&#39; AT_CODE pattern) can only occur after an ac-code not after the single at-code</span>
<span class="tok-nl">c_terminology_code</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">AC_CODE</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_boolean</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_boolean_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_boolean_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules_syntax"><a class="anchor" href="#_rules_syntax"></a>B.4. Rules Syntax</h3>
<div class="paragraph">
<p>The following expression grammar defines the syntax that may appear in the <code>rules</code> section of an archetype and also the assertions in Archetype slots.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">//  description: Antlr4 grammar for openEHR Rules core syntax.</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2016- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//  license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">base_expressions</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl2_primitives</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin_values</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Top-level _objects ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">statement_block</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">statement</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ------------------------- statements ---------------------------</span>
<span class="tok-nl">statement</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">declaration</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">assignment</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-p">;</span>

<span class="tok-nl">declaration</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">variable_declaration</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constant_declaration</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">variable_declaration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">constant_declaration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">constant_name</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_EQ</span><span class="tok-w"> </span><span class="tok-nv">primitive_object</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">assignment</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">binding</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">local_assignment</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// The following is the means of binding a data context path to a local variable</span>
<span class="tok-c">// TODO: remove this rule when proper external bindings are supported</span>
<span class="tok-nl">binding</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">local_assignment</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">assertion</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// -------------------------- _expressions --------------------------</span>
<span class="tok-c">//</span>
<span class="tok-nl">expression</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// _expressions evaluating to boolean values, using standard precedence</span>
<span class="tok-c">// The equality_binop ones are not strictly necessary, but allow the use</span>
<span class="tok-c">// of boolean_leaf = true, which some people like</span>
<span class="tok-c">//</span>
<span class="tok-nl">boolean_expr</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_NOT</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_AND</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_XOR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_OR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_IMPLIES</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"> </span><span class="tok-nv">equality_binop</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Atomic Boolean-valued expression elements</span>
<span class="tok-c">// TODO: SYM_EXISTS alternative to be replaced by defined() predicate</span>
<span class="tok-nl">boolean_leaf</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">boolean_literal</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">for_all_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">there_exists_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTS</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">sub_path_local_variable</span><span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relational_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">equality_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constraint_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_literal</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  Universal and existential quantifier</span>
<span class="tok-c">// TODO: &#39;in&#39; probably isn&#39;t needed in the long term</span>
<span class="tok-nl">for_all_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_FOR_ALL</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;in&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">there_exists_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_THERE_EXISTS</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;in&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// Constraint expressions</span>
<span class="tok-c">// This provides a way of using one operator (matches) to compare a</span>
<span class="tok-c">// value (LHS) with a value range (RHS). As per ADL, the value range</span>
<span class="tok-c">// for ordered types like Integer, Date etc may be a single value,</span>
<span class="tok-c">// a list of values, or a list of intervals, and in future, potentially</span>
<span class="tok-c">// other comparators, including functions (e.g. divisible_by_N).</span>
<span class="tok-c">//</span>
<span class="tok-c">// For non-ordered types like String and Terminology_code, the RHS</span>
<span class="tok-c">// is in other forms, e.g. regex for Strings.</span>
<span class="tok-c">//</span>
<span class="tok-c">// The matches operator can be used to generate a Boolean value that</span>
<span class="tok-c">// may be used within an expression like any other Boolean (hence it</span>
<span class="tok-c">// is a booleanLeaf).</span>
<span class="tok-c">// TODO: non-primitive objects might be supported on the RHS in future.</span>
<span class="tok-nl">constraint_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_inline_primitive_object</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CONTAINED_REGEXP</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// _expressions evaluating to arithmetic values, using standard precedence</span>
<span class="tok-c">//</span>
<span class="tok-nl">arithmetic_expr</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-err">&lt;</span><span class="tok-nv">assoc</span><span class="tok-o">=</span><span class="tok-nv">right</span><span class="tok-err">&gt;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;%&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arithmetic_leaf</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Equality expression between any arithmetic value; precedence is</span>
<span class="tok-c">// lowest, so only needed between leaves, since () will be needed for</span>
<span class="tok-c">// larger expressions anyway</span>
<span class="tok-c">//</span>
<span class="tok-nl">equality_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">equality_binop</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">equality_binop</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_EQ</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_NE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Relational expressions of arithmetic operands generating Boolean values</span>
<span class="tok-c">//</span>
<span class="tok-nl">relational_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">relational_binop</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">relational_binop</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_GT</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// instances references: data references, variables, and function calls.</span>
<span class="tok-c">// TODO: Remove bound_path from this rule when external binding supported</span>
<span class="tok-c">//</span>
<span class="tok-nl">value_ref</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">function_call</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">sub_path_local_variable</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constant_name</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">local_variable</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// TODO: change to [] form, e.g.     book_list [{title.contains(&quot;Quixote&quot;)}]</span>
<span class="tok-nl">sub_path_local_variable</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_WITH_PATH</span><span class="tok-p">;</span>

<span class="tok-c">// TODO: Remove this rule when external binding supported</span>
<span class="tok-nl">bound_path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">constant_name</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">function_call</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">function_args</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">function_args</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">type_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_value_types"><a class="anchor" href="#_value_types"></a>B.5. Value types</h3>
<div class="paragraph">
<p>The following grammar defines the syntax for the terminal types in ADL, which are derived from ODIN.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// grammar defining ODIN terminal value types, including atoms, lists and intervals</span>
<span class="tok-c">// author:      Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">// support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">// copyright:   Copyright (c) 2018- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">odin_values</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">base_lexer;</span>

<span class="tok-c">//</span>
<span class="tok-c">// ========================= Parser ============================</span>
<span class="tok-c">//</span>

<span class="tok-err">primitive_object</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">primitive_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">primitive_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">primitive_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">string_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">string_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">integer_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">string_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">STRING</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">string_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">integer_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">integer_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">integer_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">integer_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">real_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-no">REAL</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">real_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">real_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">real_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_TRUE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">boolean_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">character_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">CHARACTER</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">character_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">date_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DATE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">date_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">time_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_TIME</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">time_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">time_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">time_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">date_time_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DATE_TIME</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">duration_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DURATION</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">duration_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">duration_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">duration_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">term_code_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">TERM_CODE_REF</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">term_code_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">relop</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_base_lexer"><a class="anchor" href="#_base_lexer"></a>B.6. Base Lexer</h3>
<div class="paragraph">
<p>The following grammar defines lexer patterns of generic lexical tokens.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">//  General purpose patterns used in all openEHR parser and lexer tools</span>
<span class="tok-c">//  author:      Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2018- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">lexer</span><span class="tok-w"> </span><span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">base_lexer</span><span class="tok-p">;</span>

<span class="tok-c">// ---------- whitespace &amp; comments ----------</span>

<span class="tok-nl">WS</span><span class="tok-w">         </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-w"> </span><span class="tok-err">\</span><span class="tok-n">t</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-p">]</span><span class="tok-o">+</span><span class="tok-w">    </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">channel</span><span class="tok-o">(</span><span class="tok-no">HIDDEN</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">LINE</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\r&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-no">EOL</span><span class="tok-w">  </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">channel</span><span class="tok-o">(</span><span class="tok-no">HIDDEN</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">  </span><span class="tok-c">// increment line count</span>
<span class="tok-nl">CMT_LINE</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;--&#39;</span><span class="tok-w"> </span><span class="tok-o">.*?</span><span class="tok-w"> </span><span class="tok-s1">&#39;\r&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-no">EOL</span><span class="tok-w">  </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-nv">skip</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">   </span><span class="tok-c">// (increment line count)</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">EOL</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>


<span class="tok-c">// -------------- template overlay cannot be handled in a more simple way because it includes the comment line</span>
<span class="tok-nl">SYM_TEMPLATE_OVERLAY</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">H_CMT_LINE</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-no">WS</span><span class="tok-o">|</span><span class="tok-no">LINE</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-no">SYM_TEMPLATE_OVERLAY_ONLY</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">H_CMT_LINE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;--------&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-o">*?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-o">|</span><span class="tok-s1">&#39;\r&#39;&#39;\n&#39;</span><span class="tok-o">|</span><span class="tok-s1">&#39;\r&#39;</span><span class="tok-o">)</span><span class="tok-w">  </span><span class="tok-p">;</span><span class="tok-w">  </span><span class="tok-c">// special type of comment for splitting template overlays</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SYM_TEMPLATE_OVERLAY_ONLY</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Mm</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-s1">&#39;_&#39;</span><span class="tok-p">[</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Vv</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ---------- path patterns -----------</span>

<span class="tok-nl">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ADL_ABSOLUTE_PATH</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ADL_RELATIVE_PATH</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">ADL_ABSOLUTE_PATH</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH_SEGMENT</span><span class="tok-o">)+</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">ADL_RELATIVE_PATH</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH_SEGMENT</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH_SEGMENT</span><span class="tok-o">)+</span><span class="tok-p">;</span>

<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">ADL_PATH_SEGMENT</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH_ATTRIBUTE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-o">)?</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">ADL_PATH_ATTRIBUTE</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ID_CODE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">STRING</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_REF</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_HRID</span><span class="tok-p">;</span>


<span class="tok-c">// ---------- ISO8601-based date/time/duration constraint patterns</span>

<span class="tok-nl">DATE_CONSTRAINT_PATTERN</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">YEAR_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">MONTH_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">DAY_PATTERN</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">TIME_CONSTRAINT_PATTERN</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">HOUR_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-no">MINUTE_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-no">SECOND_PATTERN</span><span class="tok-w"> </span><span class="tok-no">TZ_PATTERN</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">DATE_TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">DATE_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-no">TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">YEAR_PATTERN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;yyyy&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;YYYY&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;yyy&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;YYY&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">MONTH_PATTERN</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;mm&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;MM&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">DAY_PATTERN</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;dd&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;DD&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">HOUR_PATTERN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;hh&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;HH&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">MINUTE_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;mm&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;MM&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SECOND_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;ss&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;SS&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">TZ_PATTERN</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;hh&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;HH&#39;</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;:&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;mm&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;MM&#39;</span><span class="tok-o">))?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;Z&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">DURATION_CONSTRAINT_PATTERN</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;P&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">yY</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">mM</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">Ww</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">dD</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">hH</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">mM</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">sS</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ---------- Delimited Regex matcher ------------</span>
<span class="tok-c">// In ADL, a regexp can only exist between {}.</span>
<span class="tok-c">// allows for &#39;/&#39; or &#39;^&#39; delimiters</span>
<span class="tok-c">// logical form - REGEX: &#39;/&#39; ( &#39;\\/&#39; | ~&#39;/&#39; )+ &#39;/&#39; | &#39;^&#39; ( &#39;\\^&#39; | ~&#39;^&#39; )+ &#39;^&#39;;</span>
<span class="tok-c">// The following is used to ensure REGEXes don&#39;t get mixed up with paths, which use &#39;/&#39; chars</span>

<span class="tok-c">//a</span>
<span class="tok-c">// regexp can only exist between {}. It can optionally have an assumed value, by adding ;&quot;value&quot;</span>
<span class="tok-nl">CONTAINED_REGEXP</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-no">WS</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-no">SLASH_REGEXP</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CARET_REGEXP</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-no">WS</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">WS</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-no">STRING</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-no">WS</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SLASH_REGEXP</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-no">SLASH_REGEXP_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SLASH_REGEXP_CHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-p">[</span><span class="tok-o">/</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">ESCAPE_SEQ</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;\\</span><span class="tok-o">/</span><span class="tok-err">&#39;</span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">CARET_REGEXP</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-n">CARET_REGEXP_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">CARET_REGEXP_CHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">~[^</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">ESCAPE_SEQ</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;\\</span><span class="tok-o">^</span><span class="tok-err">&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">// ---------- various ADL2 codes -------</span>

<span class="tok-n">ROOT_ID_CODE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-n">id1</span><span class="tok-sc">&#39; &#39;</span><span class="tok-mf">.1</span><span class="tok-err">&#39;</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">ID_CODE</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-n">id</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">CODE_STR</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">AT_CODE</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-n">at</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">CODE_STR</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">AC_CODE</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-n">ac</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">CODE_STR</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">CODE_STR</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;0&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]*</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;0&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]*</span><span class="tok-w"> </span><span class="tok-p">))</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// ---------- ISO8601 Date/Time values ----------</span>

<span class="tok-n">ISO8601_DATE</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">DAY</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">ISO8601_TIME</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">MINUTE</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">SECOND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">SECOND_DEC_SEP</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">MINUTE</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-n">TIMEZONE</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">ISO8601_DATE_TIME</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">DAY</span><span class="tok-w"> </span><span class="tok-sc">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">MINUTE</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">SECOND</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">SECOND_DEC_SEP</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">DAY</span><span class="tok-w"> </span><span class="tok-sc">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">MINUTE</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">DAY</span><span class="tok-w"> </span><span class="tok-sc">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-n">TIMEZONE</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">TIMEZONE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;Z&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;+&#39;</span><span class="tok-o">|</span><span class="tok-sc">&#39;-&#39;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-n">HOUR_MIN</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">   </span><span class="tok-c1">// hour offset, e.g. `+0930`, or else literal `Z` indicating +0000.</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">YEAR</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">		   </span><span class="tok-c1">// Year in ISO8601:2004 is 4 digits with 0-filling as needed</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">MONTH</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">][</span><span class="tok-mi">1</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">1</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">2</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">    </span><span class="tok-c1">// month in year</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">DAY</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">][</span><span class="tok-mi">1</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">12</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">3</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">  </span><span class="tok-c1">// day in month</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">HOUR</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mo">01</span><span class="tok-o">]?[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">3</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">  </span><span class="tok-c1">// hour in 24 hour clock</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">MINUTE</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">5</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">                 </span><span class="tok-c1">// minutes</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">HOUR_MIN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mo">01</span><span class="tok-o">]?[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">2</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">3</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">5</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">  </span><span class="tok-c1">// hour / minutes quad digit pattern</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">SECOND</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">5</span><span class="tok-o">][</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">                 </span><span class="tok-c1">// seconds</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">SECOND_DEC_SEP</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">UNKNOWN_DT</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">??</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">                    </span><span class="tok-c1">// any unknown date/time value, except years.</span>

<span class="tok-c1">// ISO8601 DURATION PnYnMnWnDTnnHnnMnn.nnnS </span>
<span class="tok-c1">// here we allow a deviation from the standard to allow weeks to be // mixed in with the rest since this commonly occurs in medicine</span>
<span class="tok-c1">// TODO: the following will incorrectly match just &#39;P&#39;</span>
<span class="tok-n">ISO8601_DURATION</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-o">?</span><span class="tok-sc">&#39;P&#39;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-n">yY</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-n">mM</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-n">wW</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+[</span><span class="tok-n">dD</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+[</span><span class="tok-n">hH</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+[</span><span class="tok-n">mM</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">SECOND_DEC_SEP</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-p">)</span><span class="tok-o">?[</span><span class="tok-n">sS</span><span class="tok-o">]</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// ------------------- special word symbols --------------</span>
<span class="tok-n">SYM_TRUE</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-n">Tt</span><span class="tok-o">][</span><span class="tok-n">Rr</span><span class="tok-o">][</span><span class="tok-n">Uu</span><span class="tok-o">][</span><span class="tok-n">Ee</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_FALSE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">[</span><span class="tok-n">Ff</span><span class="tok-o">][</span><span class="tok-n">Aa</span><span class="tok-o">][</span><span class="tok-n">Ll</span><span class="tok-o">][</span><span class="tok-n">Ss</span><span class="tok-o">][</span><span class="tok-n">Ee</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// ---------------------- Identifiers ---------------------</span>

<span class="tok-n">ARCHETYPE_HRID</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ARCHETYPE_HRID_ROOT</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">.</span><span class="tok-na">v</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">ARCHETYPE_VERSION_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">ARCHETYPE_REF</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ARCHETYPE_HRID_ROOT</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">.</span><span class="tok-na">v</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">INTEGER</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ARCHETYPE_HRID_ROOT</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">NAMESPACE</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">::</span><span class="tok-err">&#39;</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-n">IDENTIFIER</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">IDENTIFIER</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">IDENTIFIER</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">LABEL</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ARCHETYPE_VERSION_ID</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">-</span><span class="tok-n">rc</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">-</span><span class="tok-n">alpha</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">VERSION_ID</span><span class="tok-w">          </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">-</span><span class="tok-n">rc</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">-</span><span class="tok-n">alpha</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">IDENTIFIER</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// --------------------- composed primitive types -------------------</span>

<span class="tok-c1">// e.g. [ICD10AM(1998)::F23]; [ISO_639-1::en]</span>
<span class="tok-n">TERM_CODE_REF</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">[</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">TERM_CODE_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-n">TERM_CODE_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">::</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">TERM_CODE_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">]</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">TERM_CODE_CHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">NAME_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">// --------------------- URIs --------------------</span>

<span class="tok-c1">// URI recogniser based on https://tools.ietf.org/html/rfc3986 and</span>
<span class="tok-c1">// http://www.w3.org/Addressing/URL/5_URI_BNF.html</span>
<span class="tok-nl">EMBEDDED_URI</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-o">[</span><span class="tok-w"> </span><span class="tok-err">\</span><span class="tok-n">t</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-o">]|</span><span class="tok-n">CMT_LINE</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-n">URI</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-o">[</span><span class="tok-w"> </span><span class="tok-err">\</span><span class="tok-n">t</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-o">]|</span><span class="tok-n">CMT_LINE</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-sc">&#39;&gt;&#39;</span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_SCHEME</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_HIER_PART</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;?&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_QUERY</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;#&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_FRAGMENT</span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_HIER_PART</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-c1">//&#39; URI_AUTHORITY ) URI_PATH_ABEMPTY</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_ABSOLUTE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_ROOTLESS</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_EMPTY</span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_SCHEME</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_AUTHORITY</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">URI_USERINFO</span><span class="tok-w"> </span><span class="tok-sc">&#39;@&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-n">URI_HOST</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_PORT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_USERINFO</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">URI_UNRESERVED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_HOST</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_IP_LITERAL</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_IPV4_ADDRESS</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_REG_NAME</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c1">//TODO: ipv6</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PORT</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">*</span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_IP_LITERAL</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_IPV6_LITERAL</span><span class="tok-w"> </span><span class="tok-sc">&#39;]&#39;</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c1">//TODO, if needed: IPvFuture</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_IPV4_ADDRESS</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_DEC_OCTET</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_DEC_OCTET</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_DEC_OCTET</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_DEC_OCTET</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_IPV6_LITERAL</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">HEX_QUAD</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_QUAD</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_QUAD</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_QUAD</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_DEC_OCTET</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;1&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;2&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">4</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-mi">25</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">5</span><span class="tok-p">];</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_REG_NAME</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">URI_UNRESERVED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">HEX_QUAD</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_ABEMPTY</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_ABSOLUTE</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT_NZ</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">?</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_NOSCHEME</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT_NZ_NC</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_ROOTLESS</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT_NZ</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PATH_EMPTY</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_PCHAR</span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT_NZ</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_PCHAR</span><span class="tok-o">+</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_SEGMENT_NZ_NC</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-w"> </span><span class="tok-n">URI_UNRESERVED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;@&#39;</span><span class="tok-w"> </span><span class="tok-p">)</span><span class="tok-o">+</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c1">//non-zero-length segment without any colon &quot;:&quot;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PCHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_UNRESERVED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;@&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">//fragment URI_PATH   : &#39;/&#39; | ( &#39;/&#39; URI_XPALPHA+ )+ (&#39;/&#39;)?;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_QUERY</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">URI_PCHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;?&#39;</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_FRAGMENT</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">URI_PCHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;?&#39;</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;%&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_UNRESERVED</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;_&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;~&#39;</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_RESERVED</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">URI_GEN_DELIMS</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_GEN_DELIMS</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;?&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;#&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;@&#39;</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c1">//TODO: migrate to [/?#...] notation</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">URI_SUB_DELIMS</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;!&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;$&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;&amp;&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;\&#39;&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;)&#39;</span>
<span class="tok-w">                         </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;=&#39;</span><span class="tok-p">;</span>

<span class="tok-c1">// According to IETF http://tools.ietf.org/html/rfc1034[RFC 1034] and http://tools.ietf.org/html/rfc1035[RFC 1035],</span>
<span class="tok-c1">// as clarified by http://tools.ietf.org/html/rfc2181[RFC 2181] (section 11)</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">NAMESPACE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">LABEL</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">LABEL</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">LABEL</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-n">NAME_CHAR</span><span class="tok-o">|</span><span class="tok-n">URI_PCT_ENCODED</span><span class="tok-p">)</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span>


<span class="tok-n">GUID</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w">   </span><span class="tok-n">ALPHA_UCHAR</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">   </span><span class="tok-c1">// used for type ids</span>
<span class="tok-n">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w">   </span><span class="tok-n">ALPHA_LCHAR</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">   </span><span class="tok-c1">// used for attribute / method ids</span>
<span class="tok-n">ALPHA_UNDERSCORE_ID</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;_&#39;</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w">     </span><span class="tok-c1">// usually used for meta-model ids</span>

<span class="tok-c1">// --------------------- atomic primitive types -------------------</span>

<span class="tok-n">INTEGER</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-n">E_SUFFIX</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">REAL</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w">    </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;.&#39;</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-n">E_SUFFIX</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">E_SUFFIX</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">eE</span><span class="tok-p">][</span><span class="tok-o">+-</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">STRING</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;&quot;&#39;</span><span class="tok-w"> </span><span class="tok-n">STRING_CHAR</span><span class="tok-o">*?</span><span class="tok-w"> </span><span class="tok-sc">&#39;&quot;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">STRING_CHAR</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-p">[</span><span class="tok-s">&quot;\\] | ESCAPE_SEQ | UTF8CHAR ; // strings can be multi-line</span>

<span class="tok-s">CHARACTER : &#39;\&#39;&#39; CHAR &#39;\&#39;&#39; ;</span>
<span class="tok-s">fragment CHAR : ~[&#39;\\\r\n] | ESCAPE_SEQ | UTF8CHAR  ;</span>

<span class="tok-s">fragment ESCAPE_SEQ: &#39;\\&#39; [&#39;&quot;</span><span class="tok-o">?</span><span class="tok-n">abfnrtv</span><span class="tok-err">\\</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// ------------------- character fragments ------------------</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">NAME_CHAR</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">WORD_CHAR</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHANUM_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;_&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ALPHANUM_CHAR</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ALPHA_CHAR</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">a</span><span class="tok-o">-</span><span class="tok-n">zA</span><span class="tok-o">-</span><span class="tok-n">Z</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ALPHA_UCHAR</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">A</span><span class="tok-o">-</span><span class="tok-n">Z</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">ALPHA_LCHAR</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">a</span><span class="tok-o">-</span><span class="tok-n">z</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">UTF8CHAR</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;\\</span><span class="tok-n">u</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">DIGIT</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">HEX_DIGIT</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-mi">0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-n">a</span><span class="tok-o">-</span><span class="tok-n">fA</span><span class="tok-o">-</span><span class="tok-n">F</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// -------------------- common symbols ---------------------</span>

<span class="tok-nl">SYM_COMMA</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_SEMI_COLON</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">SYM_LPAREN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;(&#39;</span><span class="tok-p">;</span>
<span class="tok-n">SYM_RPAREN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;)&#39;</span><span class="tok-p">;</span>
<span class="tok-n">SYM_LBRACKET</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;[&#39;</span><span class="tok-p">;</span>
<span class="tok-n">SYM_RBRACKET</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;]&#39;</span><span class="tok-p">;</span>
<span class="tok-n">SYM_LCURLY</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_RCURLY</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// --------- symbols ----------</span>
<span class="tok-nl">SYM_ASSIGNMENT</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">:</span><span class="tok-o">=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">::</span><span class="tok-o">=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-n">SYM_NE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">/=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">!=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_EQ</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_GT</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_LT</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_LE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">&lt;=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_GE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">&gt;=</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// TODO: remove when [] path predicates supported</span>
<span class="tok-nl">VARIABLE_WITH_PATH</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-n">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-n">ADL_ABSOLUTE_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">VARIABLE_ID</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;$&#39;</span><span class="tok-w"> </span><span class="tok-n">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>


<span class="tok-c1">//</span>
<span class="tok-c1">// ========================= Lexer ============================</span>
<span class="tok-c1">//</span>

<span class="tok-c1">// -------------------- symbols for lists ------------------------</span>
<span class="tok-nl">SYM_LIST_CONTINUE</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">...</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c1">// ------------------ symbols for intervals ----------------------</span>

<span class="tok-n">SYM_PLUS</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_MINUS</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-o">+/-</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-sc">&#39;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_PERCENT</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;%&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_CARAT</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">SYM_IVL_DELIM</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-n">SYM_IVL_SEP</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-err">&#39;</span><span class="tok-p">..</span><span class="tok-err">&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="Beale2003"></a>Beale, T. (2003). Review of OCL 2.0. Retrieved from <a href="https://wolandscat.net/review-of-ocl-2-0" class="bare">https://wolandscat.net/review-of-ocl-2-0</a></p>
</div>
<div class="paragraph">
<p><a id="GeHR_AUS"></a>Beale, T., &amp; Heard, S. (2000). <em>The Good Electronic Health Record (GeHR) (Australia)</em>. Australia: GEHR Foundation. Retrieved from <a href="https://www.openehr.org/resources/related_projects" class="bare">https://www.openehr.org/resources/related_projects</a></p>
</div>
<div class="paragraph">
<p><a id="Genesereth_Fikes_Gruber1992"></a>Genesereth, M. R., Fikes, R. E., &amp; Gruber, T. R. (1992). Knowledge Interchange Format Version 3.0 Reference Manual.</p>
</div>
<div class="paragraph">
<p><a id="Martin2003"></a>Martin, P. (2003). <em>Translations between UML, OWL, KIF and the WebKB-2 languages (For-Taxonomy, Frame-CG, Formalized English)</em>. Retrieved from <a href="http://www.webkb.org/doc/model/comparisons.html" class="bare">http://www.webkb.org/doc/model/comparisons.html</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-02-19 14:36:30 UTC
</div>
</div>
</body>
</html>